
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Computing Fundamental Transition of CO under different levels of approximation &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/computational_sets/CO_Perturbation_Theory';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DEMO: H wavefunctions" href="hydrogen_wavefunctions.html" />
    <link rel="prev" title="Zeeman Effect" href="../advanced_topics/Zeeman_Effect_Hydrogen_Atom.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    5. Hydrogen Atom
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture Notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/qm_postulates_two_level.html">Chapter 1: Introduction to Quantum Phenomena</a></li>




<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/qm_postulates.html">Chapter 2: The Postulates Revisited</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/translation.html">Chapter 3: Translational Motion</a></li>


<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/vibration.html">Chapter 4: Vibrational Motion</a></li>

<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/rotation.html">Chapter 5: Angular Momentum, and Rotational Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/hydrogen.html">Chapter 6: The Hydrogen Atom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/variation.html">Chapter 7: The Variation Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/perturbation.html">Chapter 8: Perturbation Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/SphHarm_visualize.html">Visualizing Spherical harmonics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Problem Sets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../problem_sets/ps_1.html">Problem Set 1</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/HF_Coupled_to_Cavity_Tensor_To_Complete.html">Introduction to Molecular CQED</a></li>






<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/Linear_Variational_Method_Quartic_Oscillator_and_Zeeman_Effect.html">Linear Variational Method - Anharmonic Oscillator</a></li>


<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/Zeeman_Effect_Hydrogen_Atom.html">Zeeman Effect</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Sets</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Computing Fundamental Transition of CO under different levels of approximation</a></li>



<li class="toctree-l1"><a class="reference internal" href="hydrogen_wavefunctions.html">DEMO: H wavefunctions</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_variational_method.html">Linear Variational Method</a></li>

<li class="toctree-l1"><a class="reference internal" href="note05.html">Additional Notes on Spin</a></li>
<li class="toctree-l1"><a class="reference internal" href="pib_delta_potential_dynamics.html">Dynamics of particle in a box with a delta potential</a></li>



<li class="toctree-l1"><a class="reference internal" href="Spin_one_half.html">Computational Set 1: Introduction to Spin 1/2</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../resources/formula_sheet.html">Useful Formulae</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note01.html">Hydrogenlike atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note03.html">Atomic orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note05.html">Additional Notes on Spin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/spin_background.html">Spin</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/FoleyLab/chem3141-book/blob/main/content/computational_sets/CO_Perturbation_Theory.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FoleyLab/chem3141-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FoleyLab/chem3141-book/issues/new?title=Issue%20on%20page%20%2Fcontent/computational_sets/CO_Perturbation_Theory.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/computational_sets/CO_Perturbation_Theory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Computing Fundamental Transition of CO under different levels of approximation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Computing Fundamental Transition of CO under different levels of approximation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perturbation-theory">Perturbation Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-morse-oscillator-parameters">Setting up Morse Oscillator Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-conversion">Unit conversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-morse-potential-in-atomic-units">Evaluating the Morse potential in atomic units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-the-morse-potential-as-a-taylor-series">Expanding the Morse potential as a Taylor series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-e-1-and-e-2-using-perturbation-theory">Compute <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span> using Perturbation Theory</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-out-the-eigenfunctions">Test out the eigenfunctions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-fundamental-transition-energies">Compute the fundamental transition energies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment">Assignment</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="computing-fundamental-transition-of-co-under-different-levels-of-approximation">
<h1>Computing Fundamental Transition of CO under different levels of approximation<a class="headerlink" href="#computing-fundamental-transition-of-co-under-different-levels-of-approximation" title="Link to this heading">#</a></h1>
<p>We will illustrate approximations to the vibrational transition energies, specifically the fundamental (<span class="math notranslate nohighlight">\(n=0 \rightarrow n=1\)</span>) transition, using the diatomic molecule CO.</p>
<p>We will use the Morse potential as a model for the “exact” interatomic potential, and we will approximate this potential by different orders of a Taylor expansion: including up to quadratic (which is the harmonic oscillator approximation), cubic, and quartic terms.  The harmonic and Morse potentials are exactly solvable, and the eigenfunctions and eigenvalues of the vibrational Hamiltonian with cubic and quartic potentials can be approximated using perturbation theory.  Therefore, we will
compare the fundamental  transition computed exactly for harmonic and Morse potentials, and approximately at 2nd order of perturbation theory for cubic and quartic potentials to see the impact of various levels of potential truncation and approximation.</p>
<p>Within the Morse model, the vibrational Hamiltonian can be written as
\begin{equation}
\hat{H}<em>{vib} = -\frac{\hbar^2}{2\mu} \frac{d^2}{dr^2} + V</em>{Morse}(r), \tag{1}
\end{equation}
where
\begin{equation}
V_{Morse}(r) = D_e \left(1 - e^{-\beta(r-r_{eq})} \right)^2. \tag{2}
\end{equation}</p>
<p>The Morse parameters for <span class="math notranslate nohighlight">\({\rm CO}\)</span> are as follows: <span class="math notranslate nohighlight">\(D_e = 11.225 \: {\rm eV}\)</span>, <span class="math notranslate nohighlight">\(r_{eq} = 1.1283 \: {\rm Ang.}\)</span>, <span class="math notranslate nohighlight">\(\beta = 2.5944 \: {\rm Ang.}^{-1}\)</span>,
and <span class="math notranslate nohighlight">\(\mu = 6.8606 \: {\rm amu}\)</span>.</p>
<p>The exact energy eigenvalues for Equation (1) can be written as
\begin{equation}
E_n = \hbar \omega \left( \left(n+ \frac{1}{2} \right) - \chi_e \left(n+ \frac{1}{2} \right)^2 \right) \tag{3}
\end{equation}
where
\begin{equation}
\omega = \sqrt{\frac{2D_e \beta^2}{\mu}} \tag{4}
\end{equation}
and
\begin{equation}
\chi_e = \frac{\hbar \omega}{4 D_e}. \tag{5}
\end{equation}</p>
<p>The Morse potential can be approximated by a Taylor expansion as follows:
\begin{equation}
V_T(r) = \sum_{n=0}^{\infty} \frac{ f^{(n)}(r_{eq})}{n!} \left(r-r_{eq} \right)^n, \tag{6}
\end{equation}
where <span class="math notranslate nohighlight">\(f^{(n)}(r_{eq})\)</span> is the <span class="math notranslate nohighlight">\(n^{th}\)</span>-order derivative of the Morse potential evaluated at the equilibrium bondlength, e.g. <span class="math notranslate nohighlight">\(f^{(1)}(r_{eq}) = \frac{d}{dr}V_{Morse}(r_{eq}).\)</span></p>
<p>We will define the Harmonic approximation to the potential as
\begin{equation}
V_H(r) =  \frac{ f^{‘’}(r_{eq})}{2} \left(r-r_{eq} \right)^2 = \frac{1}{2} k \left(r-r_{eq} \right)^2 \tag{7}
\end{equation}
the cubic approximation to the potential as
\begin{equation}
V_C(r) =  V_H(r) + \frac{ f^{‘’’}(r_{eq})}{6} \left(r-r_{eq} \right)^3 = V_H(r) + \frac{1}{6} g \left(r-r_{eq} \right)^3,   \tag{8}
\end{equation}
and the quartic approximation as
\begin{equation}
V_Q(r) =  V_C(r) + \frac{ f^{‘’’’}(r_{eq})}{24} \left(r-r_{eq} \right)^4 =  V_C(r) + \frac{1}{24}h(r-r_{eq})^4.  \tag{9}
\end{equation}</p>
<p>Because we are using the Morse model as the “exact” interatomic potential in this notebook, we can compute these derivatives at <span class="math notranslate nohighlight">\(r_{eq}\)</span> analytically:
\begin{align}
k = 2 D_e \beta^2 \
g = -6 D_e \beta^3 \tag{10} \
h = 14 D_e \beta^4.
\end{align}
However, in general we do not have an analytical form for the interatomic potential, so we must rely on numerical derivatives of the potential evaluated at the <span class="math notranslate nohighlight">\(r_{eq}\)</span>.  In the context of interatomic potentials computed by quantum chemistry methods (e.g. CCSD(T)), one must first identify the equilibrium geometry, and then compute derivatives by taking a number of single point calculations along all displacement coordinates to compute differences among.  We will write the explicit expression for the second derivative using centered finite differences along the one displacement coordinate relevant for our <span class="math notranslate nohighlight">\({\rm CO}\)</span> molecule:
\begin{equation}
k=\frac{V_{Morse}(r_{eq}+\Delta r)-2V_{Morse}(r_{eq})+V_{Morse}(r_{eq}-\Delta r)}{\Delta r^2}+\mathcal O (\Delta r^2) \tag{11}
\end{equation}
where <span class="math notranslate nohighlight">\(\Delta r\)</span> represents a small displacement along the coordinate <span class="math notranslate nohighlight">\(r\)</span>.  Higher-order derivatives can also be computed, but will require larger numbers of displacements and therefore more energy evaluations by your quantum chemistry method.  Expressions for higher-order derivatives along a single coordinate can be found by using this calculator <a class="reference external" href="https://web.media.mit.edu/~crtaylor/calculator.html">here</a>. Note that the number of displacement coordinates <span class="math notranslate nohighlight">\(N\)</span> grows linearly with the number of atoms, and that the number of displacements required to form the <span class="math notranslate nohighlight">\(n^{{\rm th}}\)</span>-order approximation to the potential grows as <span class="math notranslate nohighlight">\(N^n\)</span>.</p>
<section id="perturbation-theory">
<h2>Perturbation Theory<a class="headerlink" href="#perturbation-theory" title="Link to this heading">#</a></h2>
<p>We can compute the exact vibrational transition energies for the Morse oscillator and the Harmonic oscillator using Equation (3), where the Harmonic oscillator transition energies come from Equation (3) with <span class="math notranslate nohighlight">\(\chi_e = 0\)</span>.  However, the transition energies when the potential is approximated as <span class="math notranslate nohighlight">\(V_C(r)\)</span> or <span class="math notranslate nohighlight">\(V_Q(r)\)</span> must be approximated.  We will illustrate the use of Perturbation Theory approximate these transition energies.</p>
<p>Here we will consider the Hamiltonian
\begin{equation}
\hat{H}<em>{vib} = -\frac{\hbar^2}{2\mu} \frac{d^2}{dr^2} + V</em>{H}(r) + V’(r) = \hat{H}_0 + V’(r) \tag{12},
\end{equation}
where <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> is exactly solved by the Harmonic oscillator energy eigenfunctions and eigenvalues (<span class="math notranslate nohighlight">\(\psi^{(0)}_n(r)\)</span>, <span class="math notranslate nohighlight">\(E^{(0)}_n\)</span>), and <span class="math notranslate nohighlight">\(V'(r)\)</span> is the perturbation which will take the form of either
<span class="math notranslate nohighlight">\(V'(r) = \frac{1}{6}g(r-r_{eq})^3\)</span> or <span class="math notranslate nohighlight">\(V'(r) = \frac{1}{6}g(r-r_{eq})^3 + \frac{1}{24}h(r-r_{eq})^4\)</span> in the cubic and quartic approximations, respectively.</p>
<p>We can calculate the energy of state <span class="math notranslate nohighlight">\(n\)</span> at 2nd order of perturbation theory as follows:
\begin{equation}
E_n = E_n^{(0)} +  \langle \psi_n^{(0)} | V’(r) | \psi_n^{(0)} \rangle + \sum_{k \neq n} \frac{|\langle \psi_k^{(0)} | V’(r) | \psi_n^{(0)}|^2}{E_n^{(0)}-E_k^{(0)}}. \tag{13}
\end{equation}</p>
<p>Recall that for the zeroth-order functions have the form
\begin{align}
\psi_n^{(0)}(r) &amp;= \sqrt{\frac{1}{2^n n!}} \cdot \left(\frac{\alpha}{\pi} \right)^{1/4} \cdot H_n \left(\sqrt{\alpha} r \right) \cdot {\rm exp}\left(\frac{-\alpha }{2} r^2 \right) \
\alpha &amp;= \frac{\mu \omega}{\hbar} \
\omega &amp;= \sqrt{\frac{k}{\mu}}
\end{align}</p>
</section>
<section id="approach">
<h2>Approach<a class="headerlink" href="#approach" title="Link to this heading">#</a></h2>
<p>We will compute the fundamental transition (<span class="math notranslate nohighlight">\(E_1 - E_0\)</span>) using the following approaches:</p>
<ol class="arabic simple">
<li><p>Harmonic approximation: <span class="math notranslate nohighlight">\(E_1 - E_0 = \hbar \omega\)</span></p></li>
<li><p>Exact solution for Morse Hamiltonian: <span class="math notranslate nohighlight">\(E_1 - E_0 = \hbar \omega (1 - 2\chi_e)\)</span></p></li>
<li><p>Evaluation of Eq. (13) for <span class="math notranslate nohighlight">\(n=0\)</span> and <span class="math notranslate nohighlight">\(n=1\)</span> utilizing the cubic contribution for <span class="math notranslate nohighlight">\(V'(r)\)</span></p></li>
<li><p>Evaluation of Eq. (13) for <span class="math notranslate nohighlight">\(n=0\)</span> and <span class="math notranslate nohighlight">\(n=1\)</span> utilizing the cubic and quartic contribution for <span class="math notranslate nohighlight">\(V'(r)\)</span></p></li>
</ol>
</section>
<section id="setting-up-morse-oscillator-parameters">
<h2>Setting up Morse Oscillator Parameters<a class="headerlink" href="#setting-up-morse-oscillator-parameters" title="Link to this heading">#</a></h2>
<p>The following block will establish the parameters for <span class="math notranslate nohighlight">\(\hat{H}_{vib}\)</span> with the Morse potential for the CO molecule.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># library imports for the entire notebook</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">trapz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">hermite</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">factorial</span>

<span class="c1"># dissociation energy in eV</span>
<span class="n">De_eV</span> <span class="o">=</span> <span class="mf">11.225</span>

<span class="c1"># equilibrium bondlength in Angstroms</span>
<span class="n">r_eq_ang</span> <span class="o">=</span> <span class="mf">1.1283</span>

<span class="c1"># reduced mass in amu</span>
<span class="n">mu_amu</span> <span class="o">=</span> <span class="mf">6.8606</span>

<span class="c1"># potential curvature in inverse angstromgs</span>
<span class="n">beta_inv_ang</span> <span class="o">=</span> <span class="mf">2.5994</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unit-conversion">
<h2>Unit conversion<a class="headerlink" href="#unit-conversion" title="Link to this heading">#</a></h2>
<p>We will use atomic units for our calculations and convert to spectroscopic units later.  In the following block, we will store different conversion factors as variables for later use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># atomic mass units to kg</span>
<span class="n">amu_to_kg</span> <span class="o">=</span> <span class="mf">1.66054e-27</span>

<span class="c1"># angstroms to meters</span>
<span class="n">ang_to_m</span> <span class="o">=</span> <span class="mf">1e-10</span>

<span class="c1"># electron volts to Jouls</span>
<span class="n">eV_to_J</span> <span class="o">=</span> <span class="mf">1.60218e-19</span>

<span class="c1"># electron volts to atomic units of energy (Hartrees)</span>
<span class="n">eV_to_au</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">27.211</span> <span class="c1">#0.0367493</span>

<span class="c1"># angstroms to atomic units of length (Bohr radii)</span>
<span class="n">au_to_ang</span> <span class="o">=</span> <span class="mf">0.52917721067121</span>

<span class="c1"># atomic mass units to atomic units of mass</span>
<span class="n">amu_to_au</span> <span class="o">=</span> <span class="mf">1822.89</span>
</pre></div>
</div>
</div>
</div>
<p>The fllowing block will use the conversion factors above to store the Morse oscillator parameters in atomic units.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dissociation energy in au</span>
<span class="n">De_au</span> <span class="o">=</span> <span class="n">De_eV</span> <span class="o">*</span> <span class="n">eV_to_au</span>

<span class="c1"># reduced mass in SI</span>
<span class="n">mu_au</span> <span class="o">=</span> <span class="n">mu_amu</span> <span class="o">*</span> <span class="n">amu_to_au</span>

<span class="c1"># equilibrium bondlength in SI</span>
<span class="n">r_eq_au</span> <span class="o">=</span> <span class="n">r_eq_ang</span> <span class="o">/</span> <span class="n">au_to_ang</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_eq_au</span><span class="p">)</span>
<span class="c1"># beta in SI</span>
<span class="n">beta_au</span> <span class="o">=</span> <span class="n">beta_inv_ang</span> <span class="o">*</span> <span class="n">au_to_ang</span>

<span class="c1"># hbar in SI</span>
<span class="n">hbar_au</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># h in SI</span>
<span class="n">h_SI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;De_eV </span><span class="si">{</span><span class="n">De_eV</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;mu_amu </span><span class="si">{</span><span class="n">mu_amu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;beta_inv_ang </span><span class="si">{</span><span class="n">beta_inv_ang</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;r_eq_ang </span><span class="si">{</span><span class="n">r_eq_ang</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;De_au </span><span class="si">{</span><span class="n">De_au</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;mu_au </span><span class="si">{</span><span class="n">mu_au</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;beta_au </span><span class="si">{</span><span class="n">beta_au</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s2">&quot;r_eq_au </span><span class="si">{</span><span class="n">r_eq_au</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.132177987349192
De_eV 11.225
mu_amu 6.8606
beta_inv_ang 2.5994
r_eq_ang 1.1283
De_au 0.4125169968027636
mu_au 12506.119134
beta_au 1.3755432414187434
r_eq_au 2.132177987349192
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluating-the-morse-potential-in-atomic-units">
<h2>Evaluating the Morse potential in atomic units<a class="headerlink" href="#evaluating-the-morse-potential-in-atomic-units" title="Link to this heading">#</a></h2>
<p>Here we will create an numpy array of bondlength values between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2.5 r_{eq}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_Morse</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">De</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">r_eq</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to evaluate the Morse potential at a given value of r</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    r : float</span>
<span class="sd">        value(s) of r to evaluate potential at</span>

<span class="sd">    De : float</span>
<span class="sd">        dissociation energy of the Morse oscillator</span>

<span class="sd">    beta : float</span>
<span class="sd">        related to the curvature of the Morse oscillator</span>

<span class="sd">    r_eq : float</span>
<span class="sd">        equilibrium bondlength of the Morse oscillator</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    V_m : float</span>
<span class="sd">        value of the Morse potential at value(s) of r</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">V_Morse</span> <span class="o">=</span> <span class="n">De</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">r_eq</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">V_Morse</span>


<span class="c1"># array of bondlength values</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># array of Morse potential values</span>
<span class="n">V_Morse</span> <span class="o">=</span> <span class="n">evaluate_Morse</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">beta_au</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_Morse</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">r_eq_au</span><span class="p">,</span><span class="mf">2.5</span><span class="o">*</span><span class="n">r_eq_au</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 1.0)
</pre></div>
</div>
<img alt="../../_images/1812bbdf839bad49c0478b501a3a8e23435ea737c38b705a94ebad4cc41da44a.png" src="../../_images/1812bbdf839bad49c0478b501a3a8e23435ea737c38b705a94ebad4cc41da44a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">r_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">V_values</span> <span class="o">=</span> <span class="n">evaluate_Morse</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">beta_au</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_values</span><span class="p">,</span> <span class="n">V_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Morse Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.4127</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$D_e$ (Dissociation Energy)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">2.132</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$r_</span><span class="si">{eq}</span><span class="s2">$ (Equilibrium Bond Length)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bond Length (au)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Potential Energy (au)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Morse Potential for CO Molecule&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/61315a74402a5e9f2884bf9d6c8c19381071a3ccfa3106cbddf59f4ed81181eb.png" src="../../_images/61315a74402a5e9f2884bf9d6c8c19381071a3ccfa3106cbddf59f4ed81181eb.png" />
</div>
</div>
</section>
<section id="expanding-the-morse-potential-as-a-taylor-series">
<h2>Expanding the Morse potential as a Taylor series<a class="headerlink" href="#expanding-the-morse-potential-as-a-taylor-series" title="Link to this heading">#</a></h2>
<p>In the following block, we will compute the analytical <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, and <span class="math notranslate nohighlight">\(h\)</span> terms defined in Equation 10.  We will compare the value of <span class="math notranslate nohighlight">\(k\)</span> computed analytically to the value computed numerically by Eq. (11), as well.</p>
<p>Recall Equation (10) was:
\begin{align}
k = 2 D_e \beta^2 \
g = -6 D_e \beta^3  \
h = 14 D_e \beta^4.
\end{align}</p>
<p>and (11) was:</p>
<p>\begin{equation}
k=\frac{V_{Morse}(r_{eq}+\Delta r)-2V_{Morse}(r_{eq})+V_{Morse}(r_{eq}-\Delta r)}{\Delta r^2}+O (\Delta r^2)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Insert analytical evaluation of k</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">De_au</span> <span class="o">*</span> <span class="n">beta_au</span> <span class="o">**</span><span class="mi">2</span>

<span class="c1"># Insert analytical evaluation of g</span>
<span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span> <span class="o">*</span> <span class="n">De_au</span> <span class="o">*</span> <span class="n">beta_au</span> <span class="o">**</span><span class="mi">3</span>

<span class="c1"># analytical evalution of h</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">14</span> <span class="o">*</span> <span class="n">De_au</span> <span class="o">*</span> <span class="n">beta_au</span> <span class="o">**</span><span class="mi">4</span>

<span class="c1"># numerical evaluation of k</span>
<span class="c1"># small displacement along r</span>
<span class="n">delta_r</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">r_eq_au</span>

<span class="c1"># value of Morse potential at forward displacement</span>
<span class="n">V_f</span> <span class="o">=</span> <span class="n">evaluate_Morse</span><span class="p">(</span><span class="n">r_eq_au</span> <span class="o">+</span> <span class="n">delta_r</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">beta_au</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">)</span>

<span class="c1"># value of Morse potential at equilibrium</span>
<span class="n">V_eq</span> <span class="o">=</span> <span class="n">evaluate_Morse</span><span class="p">(</span><span class="n">r_eq_au</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">beta_au</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">)</span>

<span class="c1"># value of Morse potential at backward displacement</span>
<span class="n">V_b</span> <span class="o">=</span> <span class="n">evaluate_Morse</span><span class="p">(</span><span class="n">r_eq_au</span> <span class="o">-</span> <span class="n">delta_r</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">beta_au</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">)</span>

<span class="c1"># CFD scheme 2nd order approximation to k</span>
<span class="n">k_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">V_f</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">V_eq</span> <span class="o">+</span> <span class="n">V_b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">delta_r</span> <span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># compare the numerical and analytic evaluation of k</span>
<span class="nb">print</span><span class="p">(</span><span class="n">k_num</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k_num</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; The numerical and analytical values for k agree to within +/- 0.0001 atomic units.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5610705004791825 1.561062667389548
 The numerical and analytical values for k agree to within +/- 0.0001 atomic units.
</pre></div>
</div>
</div>
</div>
<p>Next we will evaluate the Harmonic, cubic, and quartic models for the interatomic potential and plot all against the Morse potential.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Harmonic potential</span>
<span class="n">V_H</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span><span class="n">r_eq_au</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># cubic</span>
<span class="n">V_C</span> <span class="o">=</span> <span class="n">V_H</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_eq_au</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span>

<span class="c1"># quartic</span>
<span class="n">V_Q</span> <span class="o">=</span> <span class="n">V_C</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_eq_au</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_Morse</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Morse Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_H</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Harmonic Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_C</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cubic Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_Q</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Quartic Potential&quot;</span><span class="p">)</span>

<span class="c1"># Mark equilibrium bond length (r_eq)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">r_eq_au</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r_</span><span class="si">{eq}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="c1"># Mark dissociation energy (D_e)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">De_au</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$D_e$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bond Length (Bohr radii)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (Hartrees)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison of Morse Potential and Taylor Expansions&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e6b9492bc9af84a90269d37aba58cd0fd9fb600bdcd54d99f8652aee4c0c5222.png" src="../../_images/e6b9492bc9af84a90269d37aba58cd0fd9fb600bdcd54d99f8652aee4c0c5222.png" />
</div>
</div>
</section>
<section id="compute-e-1-and-e-2-using-perturbation-theory">
<h2>Compute <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span> using Perturbation Theory<a class="headerlink" href="#compute-e-1-and-e-2-using-perturbation-theory" title="Link to this heading">#</a></h2>
<p>We will need access to the zeroth-order states <span class="math notranslate nohighlight">\(\psi_n^{(0)}(r)\)</span> to compute the 1st and 2nd order energy corrections.
The following helper functions will give us access to these states and will also perform the operations necessary to compute the perturbative corrections.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conversion factor from Hartree to cm^-1</span>
<span class="n">hartree_to_cm</span> <span class="o">=</span> <span class="mf">219474.63</span>

<span class="c1"># Compute omega and chi_e using the Morse parameters</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">De_au</span> <span class="o">*</span> <span class="n">beta_au</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">mu_au</span><span class="p">)</span>
<span class="n">chi_e</span> <span class="o">=</span> <span class="p">(</span><span class="n">omega</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">De_au</span><span class="p">)</span>

<span class="c1"># Define functions to compute energy levels</span>

<span class="k">def</span><span class="w"> </span><span class="nf">E_morse</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute Morse oscillator energy level E_n (in atomic units)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">chi_e</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">E_harmonic</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute Harmonic oscillator energy level E_n (in atomic units)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Compute energy levels for n=0,1,2</span>
<span class="n">E0_morse</span> <span class="o">=</span> <span class="n">E_morse</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">E1_morse</span> <span class="o">=</span> <span class="n">E_morse</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">E2_morse</span> <span class="o">=</span> <span class="n">E_morse</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">E0_harm</span> <span class="o">=</span> <span class="n">E_harmonic</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">E1_harm</span> <span class="o">=</span> <span class="n">E_harmonic</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">E2_harm</span> <span class="o">=</span> <span class="n">E_harmonic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Calculate transition energies (in atomic units)</span>

<span class="c1"># Fundamental transition: n=0 -&gt; n=1</span>
<span class="n">fund_morse</span> <span class="o">=</span> <span class="n">E1_morse</span> <span class="o">-</span> <span class="n">E0_morse</span>
<span class="n">fund_harm</span> <span class="o">=</span> <span class="n">E1_harm</span> <span class="o">-</span> <span class="n">E0_harm</span>

<span class="c1"># First overtone: n=0 -&gt; n=2</span>
<span class="n">overtone_morse</span> <span class="o">=</span> <span class="n">E2_morse</span> <span class="o">-</span> <span class="n">E0_morse</span>
<span class="n">overtone_harm</span> <span class="o">=</span> <span class="n">E2_harm</span> <span class="o">-</span> <span class="n">E0_harm</span>

<span class="c1"># First hot band: n=1 -&gt; n=2</span>
<span class="n">hotband_morse</span> <span class="o">=</span> <span class="n">E2_morse</span> <span class="o">-</span> <span class="n">E1_morse</span>
<span class="n">hotband_harm</span> <span class="o">=</span> <span class="n">E2_harm</span> <span class="o">-</span> <span class="n">E1_harm</span>

<span class="c1"># Convert transition energies to cm^-1</span>
<span class="n">fund_morse_cm</span> <span class="o">=</span> <span class="n">fund_morse</span> <span class="o">*</span> <span class="n">hartree_to_cm</span>
<span class="n">fund_harm_cm</span> <span class="o">=</span> <span class="n">fund_harm</span> <span class="o">*</span> <span class="n">hartree_to_cm</span>

<span class="n">overtone_morse_cm</span> <span class="o">=</span> <span class="n">overtone_morse</span> <span class="o">*</span> <span class="n">hartree_to_cm</span>
<span class="n">overtone_harm_cm</span> <span class="o">=</span> <span class="n">overtone_harm</span> <span class="o">*</span> <span class="n">hartree_to_cm</span>

<span class="n">hotband_morse_cm</span> <span class="o">=</span> <span class="n">hotband_morse</span> <span class="o">*</span> <span class="n">hartree_to_cm</span>
<span class="n">hotband_harm_cm</span> <span class="o">=</span> <span class="n">hotband_harm</span> <span class="o">*</span> <span class="n">hartree_to_cm</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transition Energies (cm^-1):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Transition&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}{</span><span class="s1">&#39;Morse&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}{</span><span class="s1">&#39;Harmonic&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fundamental (0-&gt;1): </span><span class="si">{</span><span class="n">fund_morse_cm</span><span class="si">:</span><span class="s2">12.2f</span><span class="si">}{</span><span class="n">fund_harm_cm</span><span class="si">:</span><span class="s2">12.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First overtone (0-&gt;2): </span><span class="si">{</span><span class="n">overtone_morse_cm</span><span class="si">:</span><span class="s2">12.2f</span><span class="si">}{</span><span class="n">overtone_harm_cm</span><span class="si">:</span><span class="s2">12.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First hot band (1-&gt;2): </span><span class="si">{</span><span class="n">hotband_morse_cm</span><span class="si">:</span><span class="s2">12.2f</span><span class="si">}{</span><span class="n">hotband_harm_cm</span><span class="si">:</span><span class="s2">12.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Transition Energies (cm^-1):
Transition                 Morse    Harmonic
Fundamental (0-&gt;1):      2418.87     2452.07
First overtone (0-&gt;2):      4804.53     4904.14
First hot band (1-&gt;2):      2385.66     2452.07
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_alpha</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">hbar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to compute \alpha = \sqrt{mu * \omega / \hbar}</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    k : float</span>
<span class="sd">        the Harmonic force constant</span>

<span class="sd">    mu : float</span>
<span class="sd">        the reduced mass</span>

<span class="sd">    hbar : float</span>
<span class="sd">        reduced planck&#39;s constant</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    alpha : float</span>
<span class="sd">        \alpha = \sqrt{k * \omega / \hbar}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># compute omega</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span>

    <span class="c1"># compute alpha</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">/</span> <span class="n">hbar</span>

    <span class="c1"># return alpha</span>
    <span class="k">return</span> <span class="n">alpha</span>

<span class="k">def</span><span class="w"> </span><span class="nf">N</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to take the quantum number n of the Harmonic Oscillator and return the normalization constant</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the quantum state of the harmonic oscillator</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    N_n : float</span>
<span class="sd">        the normalization constant</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span>  <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">psi</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to evaluate the Harmonic Oscillator energy eigenfunction for state n</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        the quantum state of the harmonic oscillator</span>

<span class="sd">    alpha : float</span>
<span class="sd">        alpha value</span>


<span class="sd">    r : float</span>
<span class="sd">        position at which psi_n will be evaluated</span>

<span class="sd">    r_eq : float</span>
<span class="sd">        equilibrium bondlength</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psi_n : float</span>
<span class="sd">        value of the harmonic oscillator energy eigenfunction</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Hr</span> <span class="o">=</span> <span class="n">hermite</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="n">psi_n</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">Hr</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">r</span> <span class="o">-</span> <span class="n">r_eq</span> <span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">alpha</span>  <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_eq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">psi_n</span>

<span class="k">def</span><span class="w"> </span><span class="nf">harmonic_eigenvalue</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">hbar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to evaluate the energy eigenvalue of the harmonic oscillator for state n&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">morse_eigenvalue</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">De</span><span class="p">,</span> <span class="n">hbar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to evaluate the energy eigenvalue of the Morse oscillator for state n&quot;&quot;&quot;</span>

    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">k</span> <span class="o">/</span> <span class="n">mu</span> <span class="p">)</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">De</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">xi</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">potential_matrix_element</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq</span><span class="p">,</span> <span class="n">V_p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to compute &lt;n|V_p|m&gt; where V_p is the perturbing potential</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    n : int</span>
<span class="sd">        quantum number of the bra state</span>

<span class="sd">    m : int</span>
<span class="sd">        quantum number of the ket state</span>

<span class="sd">    alpha : float</span>
<span class="sd">        alpha constant for bra/ket states</span>

<span class="sd">    r : float</span>
<span class="sd">        position grid for bra/ket states</span>

<span class="sd">    r_eq : float</span>
<span class="sd">        equilibrium bondlength for bra/ket states</span>

<span class="sd">    V_p : float</span>
<span class="sd">        potential array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    V_nm : float</span>
<span class="sd">        &lt;n | V_p | m &gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># bra</span>
    <span class="n">psi_n</span> <span class="o">=</span> <span class="n">psi</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq</span><span class="p">)</span>

    <span class="c1"># ket</span>
    <span class="n">psi_m</span> <span class="o">=</span> <span class="n">psi</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq</span><span class="p">)</span>

    <span class="c1"># integrand</span>
    <span class="n">integrand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">psi_n</span><span class="p">)</span> <span class="o">*</span> <span class="n">V_p</span> <span class="o">*</span> <span class="n">psi_m</span>

    <span class="c1"># integrate</span>
    <span class="n">V_nm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">V_nm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:2: SyntaxWarning: invalid escape sequence &#39;\s&#39;
&lt;&gt;:2: SyntaxWarning: invalid escape sequence &#39;\s&#39;
/var/folders/x2/ggtknn9s49s3dcq96ckcgfgh0000gn/T/ipykernel_16876/281799414.py:2: SyntaxWarning: invalid escape sequence &#39;\s&#39;
  &quot;&quot;&quot; Helper function to compute \alpha = \sqrt{mu * \omega / \hbar}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="test-out-the-eigenfunctions">
<h1>Test out the eigenfunctions<a class="headerlink" href="#test-out-the-eigenfunctions" title="Link to this heading">#</a></h1>
<p>Here we will plot <span class="math notranslate nohighlight">\(\psi_0^{(0)}\)</span> against the Harmonic potential and will also test to make sure it is properly normalized.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute alpha</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">compute_alpha</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span>

<span class="c1"># compute psi_0 along the r grid</span>
<span class="n">psi_0</span> <span class="o">=</span><span class="n">psi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">)</span>

<span class="c1"># is it normalized?</span>
<span class="n">Integral</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">psi_0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Integral</span><span class="p">)</span>

<span class="c1"># Harmonic potential</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">psi_0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\psi_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_H</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Harmonic Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\p&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\p&#39;
/var/folders/x2/ggtknn9s49s3dcq96ckcgfgh0000gn/T/ipykernel_16876/2633302150.py:14: SyntaxWarning: invalid escape sequence &#39;\p&#39;
  plt.plot(r, psi_0, label=&#39;$\psi_0$&#39;)
/var/folders/x2/ggtknn9s49s3dcq96ckcgfgh0000gn/T/ipykernel_16876/2633302150.py:8: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  Integral = trapz(psi_0 ** 2, r)
</pre></div>
</div>
<img alt="../../_images/85260a90e7b8b2463dc10869a4c38a54372df5d3e2333e01abde09324938ed2c.png" src="../../_images/85260a90e7b8b2463dc10869a4c38a54372df5d3e2333e01abde09324938ed2c.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="compute-the-fundamental-transition-energies">
<h1>Compute the fundamental transition energies<a class="headerlink" href="#compute-the-fundamental-transition-energies" title="Link to this heading">#</a></h1>
<p>Now we will compute the fundamental transition energies at all levels of theory and plot the results in both atomic units and in wavenumbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fundamental transition energy at HO level</span>
<span class="n">fundamental_HO</span> <span class="o">=</span> <span class="n">harmonic_eigenvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span> <span class="o">-</span> <span class="n">harmonic_eigenvalue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span>

<span class="c1"># fundamental transition energy at Morse level</span>
<span class="n">fundamental_Morse</span> <span class="o">=</span> <span class="n">morse_eigenvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span> <span class="o">-</span> <span class="n">morse_eigenvalue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span>

<span class="c1"># 1st order correction using the cubic potential</span>
<span class="n">pt1_cubic</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="p">(</span><span class="n">V_C</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>

<span class="c1"># 1st order correction using the quartic potential</span>
<span class="n">pt1_quartic</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="p">(</span><span class="n">V_Q</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>

<span class="c1"># 2nd order corrections using cubic and quartic potentials</span>
<span class="n">pt2_cubic</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pt2_quartic</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># sum over |&lt;j|V&#39;|n&gt;|^2/(Ej-En)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">E_j</span> <span class="o">=</span> <span class="n">harmonic_eigenvalue</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span>
    <span class="n">Vc_j0</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="p">(</span><span class="n">V_C</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>
    <span class="n">pt2_cubic</span> <span class="o">+=</span> <span class="n">Vc_j0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">fundamental_HO</span> <span class="o">-</span> <span class="n">E_j</span><span class="p">)</span>
    <span class="n">Vq_j0</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="p">(</span><span class="n">V_Q</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>
    <span class="n">pt2_quartic</span> <span class="o">+=</span> <span class="n">Vq_j0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">fundamental_HO</span> <span class="o">-</span> <span class="n">E_j</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/x2/ggtknn9s49s3dcq96ckcgfgh0000gn/T/ipykernel_16876/281799414.py:129: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  V_nm = np.trapz(integrand, r)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">cubic_fo</span> <span class="o">=</span> <span class="n">fundamental_HO</span> <span class="o">+</span> <span class="n">pt1_cubic</span>
<span class="n">quartic_fo</span> <span class="o">=</span> <span class="n">fundamental_HO</span> <span class="o">+</span> <span class="n">pt1_quartic</span>

<span class="n">cubic_so</span> <span class="o">=</span> <span class="n">cubic_fo</span> <span class="o">+</span> <span class="n">pt2_cubic</span>
<span class="n">quartic_so</span> <span class="o">=</span> <span class="n">quartic_fo</span> <span class="o">+</span> <span class="n">pt2_quartic</span>

<span class="n">au_to_wn</span> <span class="o">=</span> <span class="mf">219474.63068</span>

<span class="n">morse_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fundamental_Morse</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">HO_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fundamental_HO</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">cubic_so_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cubic_so</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">quartic_so_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">quartic_so</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>






<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">morse_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">morse_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Morse&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">HO_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">HO_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Harmonic&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">cubic_so_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cubic_so_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cubic - PT2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">quartic_so_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">quartic_so_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Quartic - PT2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">2400</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Transition Energy (cm$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1977ea782ce809e9fc485fa792f338148bba4fdd8ed23fac4154fd6c05849aa5.png" src="../../_images/1977ea782ce809e9fc485fa792f338148bba4fdd8ed23fac4154fd6c05849aa5.png" />
</div>
</div>
<p>Create and fit Morse potential in atomic units</p>
<p>Now plot the potential and compute some eigenvalues</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">psi4</span>
<span class="n">mol_tmpl</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C</span>
<span class="s2">O 1 **R**</span>
<span class="s2">symmetry c2v</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">r_angstrom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">])</span>
<span class="n">options_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;basis&quot;</span><span class="p">:</span> <span class="s2">&quot;cc-pVTZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e_convergence&quot;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
    <span class="s2">&quot;d_convergence&quot;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">options_dict</span><span class="p">)</span>
<span class="c1">#mol = psi4.geometry(mol_tmpl)</span>

<span class="c1">#ccsdt_e = psi4.energy(&#39;ccsd&#39;)</span>

<span class="n">ccsdt_energy</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">r_val</span> <span class="ow">in</span> <span class="n">r_angstrom</span><span class="p">:</span>
    <span class="n">mol_str</span> <span class="o">=</span> <span class="n">mol_tmpl</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;**R**&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">))</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="n">mol_str</span><span class="p">)</span>
    <span class="n">ccsdt_e</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;ccsd&#39;</span><span class="p">)</span>
    <span class="n">ccsdt_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccsdt_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">psi4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">mol_tmpl</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span><span class="s2"> C</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span><span class="s2"> O 1 **R**</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span><span class="s2"> symmetry c2v</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span><span class="s2"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">r_angstrom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">])</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Code</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="n">objdir</span><span class="o">-</span><span class="n">Release</span><span class="o">/</span><span class="n">stage</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">71</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span> <span class="n">data_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="c1"># Init core</span>
<span class="ne">---&gt; </span><span class="mi">71</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">core</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="kn">from</span><span class="w"> </span><span class="nn">psi4.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_num_threads</span><span class="p">,</span> <span class="n">set_num_threads</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="n">core</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<span class="ne">ImportError</span>: cannot import name &#39;core&#39; from partially initialized module &#39;psi4&#39; (most likely due to a circular import) (/Users/jfoley19/Code/psi4/objdir-Release/stage/lib/psi4/__init__.py)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_min_ccsdt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">V_min_ccsdt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_Morse</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Morse Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_angstrom</span> <span class="o">/</span> <span class="n">au_to_ang</span><span class="p">,</span> <span class="n">ccsdt_energy</span><span class="o">-</span><span class="n">V_min_ccsdt</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CCSD(T)/cc-pVTZ&quot;</span><span class="p">)</span>
<span class="c1">#plt.plot(r, V_H, &#39;r--&#39;, label=&quot;Harmonic Potential&quot;)</span>
<span class="c1">#plt.plot(r, V_C, &#39;b--&#39;, label=&quot;Cubic Potential&quot;)</span>
<span class="c1">#plt.plot(r, V_Q, &#39;g--&#39;, label=&quot;Quartic Potential&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">r_eq_au</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bondlength (Bohr radii)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (Hartrees)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="assignment">
<h1>Assignment<a class="headerlink" href="#assignment" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Locate the equilibrium bondlength at the CCSD/cc-pVTZ level and report it in Angstroms and Bohr units.  Report the error and percentage error compared to the <span class="math notranslate nohighlight">\(R_{eq}\)</span> used in the Morse potential.</p></li>
<li><p>Utilize second-order schemes for <a class="reference external" href="https://www.mech.kth.se/~ardeshir/courses/literature/fd.pdf">finite differences</a> to approximate <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, and <span class="math notranslate nohighlight">\(h\)</span> at the CCSD/cc-pVTZ level and report these in atomic units.  <strong>Hint</strong> Make sure your displacements are in atomic units!  Report the error and percentage error compared to these values that were derived from the Morse potential.</p></li>
<li><p>Build a quartic potential model for CO using coefficients <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, and <span class="math notranslate nohighlight">\(h\)</span> derived from the previous step.  Plot the Harmonic, Cubic, Quartic components along with the raw CCSD/cc-pVTZ data and the original Morse potential.</p></li>
<li><p>Compute the fundamental transition energy from CO using the quartic potential and 2nd-order perturbation theory.  Make a table that includes the fundamental computed using this approximation, the fundamental from the Morse model, and the experimental value for the CO fundamental.  Include a column for the percentage error of both approximations relative to the experimental value.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1 To find the equilibrium bondlength, we could use a np.linspace function to isolate terms and find more points closer to min</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">r_1</span> <span class="o">=</span> <span class="mf">1.7</span>
<span class="n">r_3</span> <span class="o">=</span> <span class="mf">2.45</span>
<span class="n">r_fine_ang</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">r_1</span><span class="p">,</span><span class="n">r_3</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="o">*</span> <span class="n">au_to_ang</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_fine_ang</span><span class="p">)</span>

<span class="n">mol_tmpl</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C</span>
<span class="s2">O 1 **R**</span>
<span class="s2">symmetry c2v</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1">#r_angstrom = np.array([0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1])</span>
<span class="n">options_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;basis&quot;</span><span class="p">:</span> <span class="s2">&quot;cc-pVTZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e_convergence&quot;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
    <span class="s2">&quot;d_convergence&quot;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">options_dict</span><span class="p">)</span>
<span class="n">ccsdt_energy</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">r_val</span> <span class="ow">in</span> <span class="n">r_fine_ang</span><span class="p">:</span>
    <span class="n">mol_str</span> <span class="o">=</span> <span class="n">mol_tmpl</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;**R**&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">))</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="n">mol_str</span><span class="p">)</span>
    <span class="n">ccsdt_e</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;ccsd&#39;</span><span class="p">)</span>
    <span class="n">ccsdt_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccsdt_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_min_ccsdt_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">V_min_ccsdt_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">ccsdt_energy</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">r_fine_ang</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">r_eq_ang_1</span> <span class="o">=</span> <span class="n">r_fine_ang</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r_fine_au</span> <span class="o">=</span> <span class="n">r_fine_ang</span> <span class="o">/</span> <span class="n">au_to_ang</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_fine_au</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_eq_ang_1</span><span class="p">)</span>
<span class="n">r_eq_au_1</span><span class="o">=</span> <span class="n">r_eq_ang_1</span> <span class="o">/</span> <span class="n">au_to_ang</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r_eq_au_1</span><span class="p">)</span>
<span class="n">Error_r_eq_au</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_eq_au</span> <span class="o">-</span> <span class="n">r_eq_au_1</span><span class="p">)</span> <span class="o">/</span> <span class="n">r_eq_au</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Error_r_eq_au</span><span class="p">)</span>
<span class="n">Percent_Error</span> <span class="o">=</span> <span class="n">Error_r_eq_au</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Percent_Error</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Utilize second-order schemes for finite differences to approximate k,g,h at the CCSD/cc-pVTZ level and report these in atomic units.</span>
<span class="c1">#Hint Make sure your displacements are in atomic units! Report the error and percentage error compared to these values that were derived from the Morse potential.</span>

<span class="c1">#Insert analytical evaluation of k</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">De_au</span> <span class="o">*</span> <span class="n">beta_au</span> <span class="o">**</span><span class="mi">2</span>

<span class="c1"># Insert analytical evaluation of g</span>
<span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span> <span class="o">*</span> <span class="n">De_au</span> <span class="o">*</span> <span class="n">beta_au</span> <span class="o">**</span><span class="mi">3</span>

<span class="c1"># analytical evalution of h</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">14</span> <span class="o">*</span> <span class="n">De_au</span> <span class="o">*</span> <span class="n">beta_au</span> <span class="o">**</span><span class="mi">4</span>

<span class="c1"># numerical evaluation of k</span>
<span class="c1"># small displacement along r</span>
<span class="n">delta_r_1</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">r_eq_ang_1</span>

<span class="c1"># value of First forward Displacement</span>
<span class="n">V_f1</span> <span class="o">=</span> <span class="n">r_eq_ang_1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">delta_r_1</span>

<span class="c1"># value of forward displacement</span>
<span class="n">V_f</span> <span class="o">=</span> <span class="n">r_eq_ang_1</span> <span class="o">+</span> <span class="n">delta_r_1</span>

<span class="c1"># value at equilibrium</span>
<span class="n">V_eq</span> <span class="o">=</span> <span class="n">r_eq_ang_1</span>

<span class="c1"># value of backward displacement</span>
<span class="n">V_b</span> <span class="o">=</span> <span class="n">r_eq_ang_1</span> <span class="o">-</span> <span class="n">delta_r_1</span>

<span class="c1"># value of last backward displacement</span>
<span class="n">V_b1</span> <span class="o">=</span> <span class="n">r_eq_ang_1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">delta_r_1</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="c1">#new_r_eq_ang_array</span>
<span class="n">R</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">V_f1</span><span class="p">,</span> <span class="n">V_f</span><span class="p">,</span> <span class="n">V_eq</span><span class="p">,</span> <span class="n">V_b</span><span class="p">,</span> <span class="n">V_b1</span><span class="p">])</span>
<span class="n">mol_tmpl</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C</span>
<span class="s2">O 1 **R**</span>
<span class="s2">symmetry c2v</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1">#r_angstrom = np.array([0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1])</span>
<span class="n">options_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;basis&quot;</span><span class="p">:</span> <span class="s2">&quot;cc-pVTZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e_convergence&quot;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
    <span class="s2">&quot;d_convergence&quot;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">options_dict</span><span class="p">)</span>
<span class="n">ccsdt_energy</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">r_val</span> <span class="ow">in</span> <span class="n">R</span><span class="p">:</span>
    <span class="n">mol_str</span> <span class="o">=</span> <span class="n">mol_tmpl</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;**R**&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">))</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="n">mol_str</span><span class="p">)</span>
    <span class="n">ccsdt_e</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;ccsd&#39;</span><span class="p">)</span>
    <span class="n">ccsdt_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccsdt_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">)</span>
<span class="n">delta_r_1_au</span> <span class="o">=</span> <span class="n">delta_r_1</span> <span class="o">/</span> <span class="n">au_to_ang</span>
<span class="c1">#Building the k,g,h functions from finite differences</span>
<span class="n">k_num_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">delta_r_1_au</span> <span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k_num_1</span><span class="p">)</span>
<span class="n">prob_k</span> <span class="o">=</span> <span class="p">(</span><span class="n">k_num_1</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">k</span>
<span class="n">percent_prob_k</span> <span class="o">=</span> <span class="n">prob_k</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob_k</span><span class="p">,</span> <span class="n">percent_prob_k</span><span class="p">)</span>

<span class="n">g_num_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_r_1_au</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">prob_g</span> <span class="o">=</span> <span class="p">(</span><span class="n">g_num_1</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">/</span> <span class="n">g</span>
<span class="n">percent_prob_g</span> <span class="o">=</span> <span class="n">prob_g</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob_g</span><span class="p">,</span> <span class="n">percent_prob_g</span><span class="p">)</span>

<span class="n">h_num_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">ccsdt_energy</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">delta_r_1_au</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<span class="n">prob_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">h_num_1</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span>
<span class="n">percent_prob_h</span> <span class="o">=</span> <span class="n">prob_h</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob_h</span><span class="p">,</span> <span class="n">percent_prob_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Build a quartic potential model for CO using coefficients k,g,h derived from the previous step.</span>
<span class="c1">#Plot the Harmonic, Cubic, Quartic components along with the raw CCSD/cc-pVTZ data and the original Morse potential.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1"># Harmonic potential</span>
<span class="n">V_H</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_num_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span><span class="n">r_eq_au_1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># cubic</span>
<span class="n">V_C</span> <span class="o">=</span> <span class="n">V_H</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">g_num_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_eq_au_1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span>

<span class="c1"># quartic</span>
<span class="n">V_Q</span> <span class="o">=</span> <span class="n">V_C</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">24</span> <span class="o">*</span> <span class="n">h_num_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_eq_au_1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_Morse</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Morse Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_H</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Harmonic Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_C</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cubic Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">V_Q</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Quartic Potential&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">r_eq_au_1</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">r_eq_au_1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bondlength (Bohr radii)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (Hartrees)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Compute the fundamental transition energy from CO using the quartic potential and 2nd-order perturbation theory.</span>
<span class="c1">#Make a table that includes the fundamental computed using this approximation, the fundamental from the Morse model, and the experimental value for the CO fundamental.</span>
<span class="c1">#Include a column for the percentage error of both approximations relative to the experimental value.</span>
<span class="n">au_to_wn</span> <span class="o">=</span> <span class="mf">219474.63068</span>

<span class="c1"># fundamental transition energy at HO level</span>
<span class="n">fundamental_HO</span> <span class="o">=</span> <span class="n">harmonic_eigenvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_num_1</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span> <span class="o">-</span> <span class="n">harmonic_eigenvalue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k_num_1</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span>
<span class="n">V_approx_H</span> <span class="o">=</span> <span class="nb">print</span><span class="p">(</span><span class="n">fundamental_HO</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>

<span class="c1"># fundamental transition energy at Morse level</span>
<span class="n">fundamental_Morse</span> <span class="o">=</span> <span class="n">morse_eigenvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_num_1</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span> <span class="o">-</span> <span class="n">morse_eigenvalue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k_num_1</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">De_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span>
<span class="n">V_approx_M</span> <span class="o">=</span> <span class="nb">print</span><span class="p">(</span><span class="n">fundamental_Morse</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>

<span class="c1"># 1st order correction using the cubic potential</span>
<span class="n">pt1_cubic</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au_1</span><span class="p">,</span> <span class="p">(</span><span class="n">V_C</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pt1_cubic</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>

<span class="c1"># 1st order correction using the quartic potential</span>
<span class="n">pt1_quartic</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au_1</span><span class="p">,</span> <span class="p">(</span><span class="n">V_Q</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pt1_quartic</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>

<span class="c1"># 2nd order corrections using cubic and quartic potentials</span>
<span class="n">pt2_cubic</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pt2_quartic</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># sum over |&lt;j|V&#39;|n&gt;|^2/(Ej-En)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">E_j</span> <span class="o">=</span> <span class="n">harmonic_eigenvalue</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mu_au</span><span class="p">,</span> <span class="n">hbar_au</span><span class="p">)</span>
    <span class="n">Vc_j0</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au_1</span><span class="p">,</span> <span class="p">(</span><span class="n">V_C</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>
    <span class="n">pt2_cubic</span> <span class="o">+=</span> <span class="n">Vc_j0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">fundamental_HO</span> <span class="o">-</span> <span class="n">E_j</span><span class="p">)</span>
    <span class="n">Vq_j0</span> <span class="o">=</span> <span class="n">potential_matrix_element</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r_eq_au_1</span><span class="p">,</span> <span class="p">(</span><span class="n">V_Q</span> <span class="o">-</span> <span class="n">V_H</span><span class="p">))</span>
    <span class="n">pt2_quartic</span> <span class="o">+=</span> <span class="n">Vq_j0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">fundamental_HO</span> <span class="o">-</span> <span class="n">E_j</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">cubic_fo</span> <span class="o">=</span> <span class="n">fundamental_HO</span> <span class="o">+</span> <span class="n">pt1_cubic</span>
<span class="n">quartic_fo</span> <span class="o">=</span> <span class="n">fundamental_HO</span> <span class="o">+</span> <span class="n">pt1_quartic</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cubic_fo</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quartic_fo</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>


<span class="n">cubic_so</span> <span class="o">=</span> <span class="n">cubic_fo</span> <span class="o">+</span> <span class="n">pt2_cubic</span>
<span class="n">quartic_so</span> <span class="o">=</span> <span class="n">quartic_fo</span> <span class="o">+</span> <span class="n">pt2_quartic</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cubic_so</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quartic_so</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span>

<span class="n">au_to_wn</span> <span class="o">=</span> <span class="mf">219474.63068</span>

<span class="n">morse_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fundamental_Morse</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">HO_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fundamental_HO</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">cubic_so_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cubic_so</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">quartic_so_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">quartic_so</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>






<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">morse_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">morse_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Morse&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">HO_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">HO_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Harmonic&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">cubic_so_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cubic_so_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cubic - PT2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">quartic_so_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">quartic_so_plot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Quartic - PT2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">2200</span><span class="p">,</span> <span class="mi">2300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Transition Energy (cm$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#experimental value and error</span>
<span class="n">V_ex</span> <span class="o">=</span> <span class="mf">2143.23</span>
<span class="n">Error_Vex_Vquart</span> <span class="o">=</span> <span class="p">((</span><span class="n">quartic_so</span> <span class="o">*</span> <span class="n">au_to_wn</span><span class="p">)</span> <span class="o">-</span> <span class="n">V_ex</span><span class="p">)</span> <span class="o">/</span> <span class="n">V_ex</span>
<span class="n">Percent_Error_Vex_Vquart</span> <span class="o">=</span> <span class="n">Error_Vex_Vquart</span> <span class="o">*</span><span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Error_Vex_Vquart</span><span class="p">,</span> <span class="n">Percent_Error_Vex_Vquart</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/computational_sets"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../advanced_topics/Zeeman_Effect_Hydrogen_Atom.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Zeeman Effect</p>
      </div>
    </a>
    <a class="right-next"
       href="hydrogen_wavefunctions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">DEMO: H wavefunctions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Computing Fundamental Transition of CO under different levels of approximation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perturbation-theory">Perturbation Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-morse-oscillator-parameters">Setting up Morse Oscillator Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-conversion">Unit conversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-morse-potential-in-atomic-units">Evaluating the Morse potential in atomic units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-the-morse-potential-as-a-taylor-series">Expanding the Morse potential as a Taylor series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-e-1-and-e-2-using-perturbation-theory">Compute <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span> using Perturbation Theory</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test-out-the-eigenfunctions">Test out the eigenfunctions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-fundamental-transition-energies">Compute the fundamental transition energies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment">Assignment</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jay Foley
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>