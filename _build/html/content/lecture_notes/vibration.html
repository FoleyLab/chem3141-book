
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 4: Vibrational Motion &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/lecture_notes/vibration';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chapter 5: Angular Momentum, and Rotational Motion" href="rotation.html" />
    <link rel="prev" title="Chapter 3: Translational Motion" href="translation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    5. Hydrogen Atom
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture Notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="qm_postulates_two_level.html">Chapter 1: Introduction to Quantum Phenomena</a></li>



<li class="toctree-l1"><a class="reference internal" href="qm_postulates.html">Chapter 2: The Postulates Revisited</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation.html">Chapter 3: Translational Motion</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 4: Vibrational Motion</a></li>

<li class="toctree-l1"><a class="reference internal" href="rotation.html">Chapter 5: Angular Momentum, and Rotational Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="hydrogen.html">Chapter 6: The Hydrogen Atom</a></li>
<li class="toctree-l1"><a class="reference internal" href="variation.html">Chapter 7: The Variation Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="perturbation.html">Chapter 8: Perturbation Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="SphHarm_visualize.html">Visualizing Spherical harmonics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Problem Sets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../problem_sets/ps_1.html">Problem Set 1</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/HF_Coupled_to_Cavity_Tensor_To_Complete.html">Introduction to Molecular CQED</a></li>






<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/Linear_Variational_Method_Quartic_Oscillator_and_Zeeman_Effect.html">Linear Variational Method - Anharmonic Oscillator</a></li>


<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/Zeeman_Effect_Hydrogen_Atom.html">Zeeman Effect</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Sets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../computational_sets/CO_Perturbation_Theory.html">Computing Fundamental Transition of CO under different levels of approximation</a></li>



<li class="toctree-l1"><a class="reference internal" href="../computational_sets/hydrogen_wavefunctions.html">DEMO: H wavefunctions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computational_sets/linear_variational_method.html">Linear Variational Method</a></li>

<li class="toctree-l1"><a class="reference internal" href="../computational_sets/note05.html">Additional Notes on Spin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computational_sets/pib_delta_potential_dynamics.html">Dynamics of particle in a box with a delta potential</a></li>



<li class="toctree-l1"><a class="reference internal" href="../computational_sets/Spin_one_half.html">Chapter 2: Introduction to Spin 1/2</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../resources/formula_sheet.html">Useful Formulae</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note01.html">Hydrogenlike atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note03.html">Atomic orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note05.html">Additional Notes on Spin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/spin_background.html">Spin</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/FoleyLab/chem3141-book/blob/main/content/lecture_notes/vibration.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FoleyLab/chem3141-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FoleyLab/chem3141-book/issues/new?title=Issue%20on%20page%20%2Fcontent/lecture_notes/vibration.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/lecture_notes/vibration.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 4: Vibrational Motion</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Chapter 4: Vibrational Motion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-harmonic-potential">The Harmonic Potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-classical-harmonic-oscillator">One-Dimensional Classical Harmonic Oscillator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-quantum-harmonic-oscillator">One-Dimensional Quantum Harmonic Oscillator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#power-series-solution-to-the-schrodinger-equation">Power Series Solution to the Schrödinger Equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-boundary-conditions">Applying Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-energy-eigenvalue-expression">Final Energy Eigenvalue Expression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qho-wave-functions">QHO Wave Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tunneling-and-the-correspondence-principle">Tunneling and the Correspondence Principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selection-rules">Selection Rules</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fermi-s-golden-rule">Fermi’s Golden Rule</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fermi-s-golden-rule-for-molecular-vibrations">Fermi’s Golden Rule for Molecular Vibrations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connections-to-computational-chemistry">Connections to Computational Chemistry</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic-frequency-analysis">Harmonic Frequency Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#important-points-about-units">Important Points about Units</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-conversion-question-1">Unit Conversion Question 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectroscopic-units">Spectroscopic units</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question">❓ Question</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-state-optimization">Transition State Optimization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-considerations">Additional Considerations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boltzmann-distribution">Boltzmann Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#real-molecular-vibrations">“Real” Molecular Vibrations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#morse-oscillator-model">Morse Oscillator model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perturbation-theory">Perturbation Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-4-vibrational-motion">
<h1>Chapter 4: Vibrational Motion<a class="headerlink" href="#chapter-4-vibrational-motion" title="Link to this heading">#</a></h1>
<p>Prof. Eugene DePrince, Florida State University, and Prof. Jay Foley, UNC Charlotte</p>
<p>In the previous notebook, we discussed quantum mechanical problems involving translational motion: the free-particle, the particle-in-a-box model, the finite square well potential model, and tunneling through a one-dimensional potential energy barrier. In this notebook, we continue exploring model problems, with a focus, this time, on vibrational motion. In particular, we will find analytic solutions the Schrödinger equation for the (one-dimensional) quantum harmonic oscillator model, which captures the main qualitative features of vibrational motion in molecular systems.</p>
<section id="the-harmonic-potential">
<h2>The Harmonic Potential<a class="headerlink" href="#the-harmonic-potential" title="Link to this heading">#</a></h2>
<p>A harmonic oscillator is a system that, when displaced from its equilibrium position, experiences a harmonic restoring force, which is proportional to the displacement. In one dimension, this force would be</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
F_x = -k (x - x_e)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(x - x_e\)</span> is the displacement from the equilibrium position, <span class="math notranslate nohighlight">\(x_e\)</span>, and <span class="math notranslate nohighlight">\(k\)</span> is the proportionality constant, which is called the force constant. Recall that force and potential are related by</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
F_x = -\frac{d }{dx}V(x) = -k ( x - x_e)
\end{align}\]</div>
<p>Integrating this expression yields the potential</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
V(x) = \frac{1}{2} k (x - x_e)^2 + c
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is an arbitrary additive constant. This constant will not affect the solutions to the classical or quantum harmonic oscillator problems, but it will provide an arbitrary shift to the associated energies. For convenience, we choose <span class="math notranslate nohighlight">\(c = 0\)</span>, and we proceed with the potential</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
V(x) = \frac{1}{2} k (x - x_e)^2
\end{align}\]</div>
<p>Because the harmonic oscillator problem is a model for molecular vibrations, it will be illustrative to consider how this potential relates to one for an actual molecular system. We will consider the diatomic carbon monoxide, CO. Below, we will calculate the potential energy curve along the bond stretch coordinate for CO using a procedures for finding approximate solutions to the electronic part of the Schrödinger equation, called Hartree-Fock theory. You can read more about Hartree-Fock theory in <a class="reference external" href="https://deprincelab.github.io/tutorials/jupyter_notebooks/hartree_fock/hartree_fock.html">this notebook</a>. We will use this approach in the <a class="reference external" href="https://pyscf.org/">PySCF</a> electronic structure package, with the cc-pVDZ basis set.</p>
<p>The first code block will install the relevant packages for all of the PySCF calculations performed in this notebook if needed.</p>
<ul class="simple">
<li><p>If you are running on Google Colab, you should run these every time you run this notebook</p></li>
<li><p>If you are running locally, you can run these commands locally only once and then you will have them for all future sessions.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">pyscf</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">geometric</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">pyberny</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pyscf
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>geometric
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pyberny
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pyscf in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (2.9.0)
Requirement already satisfied: numpy!=1.16,!=1.17,&gt;=1.13 in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from pyscf) (1.26.4)
Requirement already satisfied: scipy&gt;=1.6.0 in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from pyscf) (1.15.3)
Requirement already satisfied: h5py&gt;=2.7 in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from pyscf) (3.13.0)
Requirement already satisfied: setuptools in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from pyscf) (78.1.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: geometric in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (1.1)
Requirement already satisfied: numpy&gt;=1.11 in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from geometric) (1.26.4)
Requirement already satisfied: networkx in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from geometric) (3.4.2)
Requirement already satisfied: six in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from geometric) (1.17.0)
Requirement already satisfied: scipy in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from geometric) (1.15.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pyberny in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (0.6.3)
Requirement already satisfied: numpy&lt;2.0,&gt;=1.15 in /Users/jfoley19/miniconda3/envs/jbook/lib/python3.11/site-packages (from pyberny) (1.26.4)
</pre></div>
</div>
</div>
</div>
<p>The next block imports the relevant libraries from PySCF</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span> <span class="c1"># Import necessary modules</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># conversion from Angstroms to atomic units</span>
<span class="n">ang_to_au</span> <span class="o">=</span> <span class="mf">1.88973</span>

<span class="c1"># set molecule</span>
<span class="n">mol_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C 0 0 0</span>
<span class="s2">O </span><span class="si">{}</span><span class="s2"> 0 0</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">hf_potential</span> <span class="o">=</span> <span class="p">[]</span>


<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">dx_au</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">ang_to_au</span>

<span class="c1"># array of bond lengths in angstroms, which will be what PySCF understands</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>

<span class="c1"># array of bond lengths in atomic units (Bohr), which is what we will use for calculating k in atomic units</span>
<span class="n">x_au</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">ang_to_au</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">current_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Redefine the molecule for each geometry</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
        <span class="n">atom</span><span class="o">=</span><span class="n">mol_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">current_x</span><span class="p">),</span>
        <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;cc-pvdz&#39;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Keep output quiet for each step</span>

    <span class="c1"># Perform RHF calculation</span>
    <span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

    <span class="c1"># Extract the RHF energy</span>
    <span class="n">hf_en</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">e_tot</span>
    <span class="n">hf_potential</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hf_en</span><span class="p">)</span>



<span class="c1"># Now, all three lists will contain the respective energies for each geometry.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RHF Potential Energy Curve (first 5 points):&quot;</span><span class="p">,</span> <span class="n">hf_potential</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RHF Potential Energy Curve (first 5 points): [-106.91320008883994, -107.29223070755722, -107.64878577139375, -107.9841187949562, -108.29941954437882]
</pre></div>
</div>
</div>
</div>
<p>Now, let us visualize this potential (shifted so that the minimum value is zero)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># minimum energy</span>
<span class="n">V_e</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">hf_potential</span><span class="p">)</span>


<span class="c1"># shift potential so the minimum value is zero</span>
<span class="n">hf_potential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hf_potential</span><span class="p">)</span> <span class="o">-</span> <span class="n">V_e</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="p">,</span> <span class="n">hf_potential</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hartree-Fock&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;potential&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;C-O distance (Angstroms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/02121325f39c913efa2a6c0c7ce174d336444dc8c0b2b7e3cf4ccf446a649535.png" src="../../_images/02121325f39c913efa2a6c0c7ce174d336444dc8c0b2b7e3cf4ccf446a649535.png" />
</div>
</div>
<p>Near the equilibrium C-O distance, the potential in which the nuclei live looks harmonic, i.e., it could be approximated by a quadratic function. How can we extract an appropriate force constant, <span class="math notranslate nohighlight">\(k\)</span>, from this potential? Well, if</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
V(x) = \frac{1}{2} k(x-x_e)^2
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> is the C-O distance, and <span class="math notranslate nohighlight">\(x_e\)</span> is the equilibrium C-O distance, then</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
k = \frac{d^2}{dx^2} V(x) 
\end{align}\]</div>
<p>So, we take <span class="math notranslate nohighlight">\(k\)</span> to be the second derivative of the potential with respect to the C-O distance, evaluated at the equilibrium geometry. The second derivative of the potential can be calculated numerically, via finite differences.  You can find expressions for finite differences for different derivatives using this calculator <a class="reference external" href="https://web.media.mit.edu/~crtaylor/calculator.html">here</a>.  Using a 5-point formula for the second derivative, we can express <span class="math notranslate nohighlight">\(k\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
k \approx \frac{-V(x_e + 2 h) + 16 V(x_e + h) - 30 V(x_e) + 16 V(x_e - h) - V(x_e - 2h)}{12h^2} 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is a displacement from the equilbrium C-O distance, <span class="math notranslate nohighlight">\(x_e\)</span>. Here, we calculate <span class="math notranslate nohighlight">\(k\)</span> in this way and visualize the harmonic and Hartree-Fock potentials together.</p>
<p><strong>IMPORTANT</strong> Your energies in the numerator are in atomic units, so it is important to express your <span class="math notranslate nohighlight">\(h\)</span> in the denominator also in atomic units!  We will use <code class="docutils literal notranslate"><span class="pre">dx_au</span></code> to get <span class="math notranslate nohighlight">\(h\)</span> in atomic units.</p>
<p>This plot will have the bond length in Bohr units (or atomic units), so we will see that the features of this curve (the equilibrium bond length, etc) appear to be shifted by a factor <span class="math notranslate nohighlight">\(\approx 1.88973\)</span>, which is the conversion from Angstroms to Bohr units of length.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># equilbirum bond length - defined by CCSD potential</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">hf_potential</span><span class="p">)</span>

<span class="c1"># equilibrium bond length in atomic units</span>
<span class="n">x_e_au</span> <span class="o">=</span> <span class="n">x_au</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="c1"># equilibrium bond length in Angstroms</span>
<span class="n">x_e</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="c1"># k = d^2 V(x) / dx^2</span>
<span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">dx_au</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># harmonic potential</span>
<span class="n">harmonic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_au</span><span class="o">-</span><span class="n">x_e_au</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_au</span><span class="p">,</span> <span class="n">hf_potential</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hartree-Fock Potential&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_au</span><span class="p">,</span> <span class="n">harmonic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;harmonic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">x_au</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_au</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;potential&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;C-O distance (Bohr Units)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/58d4cdd4da2af1f9ae67ace725291cba18dff263858ea04e5c55fe2b56199c52.png" src="../../_images/58d4cdd4da2af1f9ae67ace725291cba18dff263858ea04e5c55fe2b56199c52.png" />
</div>
</div>
<p>Clearly these potentials have some major qualitative differences, the most obvious of which is that the CCSD potential tends to some constant value in the limit of dissociation, whereas the harmonic potential does not. Indeed, for the harmonic potential, <span class="math notranslate nohighlight">\(V(x)\)</span>,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\lim_{x\to\infty} V(x) = \infty 
\end{align}\]</div>
<p>Nonetheless, the harmonic potential does a reasonable job of approximating the Hartree-Fock one near equilibrium. Hence, we consider the quantum harmonic oscillator model to be useful for describing low-energy vibrational states only. Higher-energy states will be poorly described by this model.</p>
</section>
<section id="one-dimensional-classical-harmonic-oscillator">
<h2>One-Dimensional Classical Harmonic Oscillator<a class="headerlink" href="#one-dimensional-classical-harmonic-oscillator" title="Link to this heading">#</a></h2>
<p>Now, we seek solultions to the classical harmonic oscillator problem. In this case, let us assume that the equilibrium position, <span class="math notranslate nohighlight">\(x_e = 0\)</span>, and note that we would like to solve for the position as a function of time, <span class="math notranslate nohighlight">\(x(t)\)</span>. Recall that the harmonic restoring force is linear in the displacement,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
F_x = -k x(t)
\end{align}\]</div>
<p>Classically, we can find an analytic form for how the displacement evolves over time with the help of Newton’s second law,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
F_x = m a_x(t)
\end{align}\]</div>
<p>where the acceleration of the oscillator, <span class="math notranslate nohighlight">\(a_x(t)\)</span>, is the second time derivative of the position, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_x(t) = \frac{d^2}{dt^2} x(t)
\end{align}\]</div>
<p>So, we seek a solution to the differential equation</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
m \frac{d^2}{dt^2} x(t) = -k x(t)
\end{align}\]</div>
<p>which has a general solution</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
x(t) = C\text{sin}\left ( \left [ k/m \right ]^{1/2} t \right ) + D \text{cos}\left( \left [ k/m \right ]^{1/2} t \right )
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{align}
x(t) = A\text{sin}\left ( \left [ k/m \right ]^{1/2} t + B \right ) 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(B\)</span> represents a phase shift. This solution tells us that harmonic motion is sinusoidal, which we can visualize using the following code. In this case, let us take some arbitrary values for <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(B\)</span>, which are all specified below. In addition to visualizing the position, <span class="math notranslate nohighlight">\(x(t)\)</span>, we will also plot the kinetic energy, <span class="math notranslate nohighlight">\(T\)</span>, and potential energy, <span class="math notranslate nohighlight">\(V\)</span> as functions of time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.01</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="c1"># position, x(t)</span>
<span class="n">x_t</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

<span class="c1"># calculate velocicty from the position using np.gradient</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="c1"># kinetic energy</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">velocity</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># potential energy</span>
<span class="n">V</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">x_t</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># plot position</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_t</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">)</span>

<span class="c1"># plot kinetic and potential energy</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;kinetic energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;potential energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="n">V</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;total energy&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ef41005d1b15ad03195d6ac215289ced7e7a35ddffa1ccf3447487852310c394.png" src="../../_images/ef41005d1b15ad03195d6ac215289ced7e7a35ddffa1ccf3447487852310c394.png" />
</div>
</div>
<p>The displacement, <span class="math notranslate nohighlight">\(x(t)\)</span>, oscillates between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(-A\)</span> with a frequency, <span class="math notranslate nohighlight">\(\nu\)</span>,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\nu = \frac{1}{2\pi}  \left ( \frac{k}{m} \right )^{1/2}
\end{align}\]</div>
<p>It will be useful at times to also consider the <em>angular frequency</em>, <span class="math notranslate nohighlight">\(\omega\)</span>, which is related to <span class="math notranslate nohighlight">\(\nu\)</span> by a factor of <span class="math notranslate nohighlight">\(2 \pi\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\omega = 2 \pi \nu = \left ( \frac{k}{m} \right )^{1/2}
\end{align}\]</div>
<p>The kinetic and potential energy also oscillate in time, but their sum, the total energy, is constant in time. This result makes sense because the oscillator is not being driven, nor is it interacting with any sort of bath, so the total energy should be conserved. Note also that the frequency with which the the kinetic and potential energy oscillate is twice the frequency with which the position oscillates. This behavior reflects the symmetry of the potential, <span class="math notranslate nohighlight">\(V(x)\)</span>. For example, the potential energy should go to zero twice per single oscillation of the position, once as the oscillator moves past its equilibrium position in the <span class="math notranslate nohighlight">\(+x\)</span> direction and again when it passes through equilibrium in the <span class="math notranslate nohighlight">\(-x\)</span> direction. Similarly, the kinetic energy should go to zero twice per oscillation in the position, at the two <strong>classical turning points</strong>.</p>
<p>The classical turning point is the point at which the potential energy is equal to the total energy and the kinetic energy is equal to zero. The term, turning point, refers to the fact that this is the point at which the oscillator stops moving and reverses direction. For the classical harmonic oscillator with</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
x(t) = A\text{sin}\left ( \left [ k/m \right ]^{1/2} t + B \right ) 
\end{align}\]</div>
<p>the turning points are simply <span class="math notranslate nohighlight">\(-A\)</span> and <span class="math notranslate nohighlight">\(A\)</span>. Let’s visualize the classical turning points, total energy, and  harmonic potential together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># total energy at time zero</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># turning points</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="n">A</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span>
    
<span class="c1"># harmonic potential. </span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">4.05</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
<span class="n">harmonic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">harmonic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;V(x)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">],</span> <span class="p">[</span><span class="n">energy</span><span class="p">,</span> <span class="n">energy</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;total energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_min</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">energy</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">energy</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;displacement&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f34cd09793bffe3c15d190a31026f1942ece495257ccf6fe07f14343cfaf11ce.png" src="../../_images/f34cd09793bffe3c15d190a31026f1942ece495257ccf6fe07f14343cfaf11ce.png" />
</div>
</div>
<p>Note that the classical harmonic oscillator will never be found with a displacement beyond the turning points. As we will find below, the situation will be different for the quantum harmonic oscillator.</p>
</section>
<section id="one-dimensional-quantum-harmonic-oscillator">
<h2>One-Dimensional Quantum Harmonic Oscillator<a class="headerlink" href="#one-dimensional-quantum-harmonic-oscillator" title="Link to this heading">#</a></h2>
<p>Now, we would like to consider the quantum mechanical treatment of the one-dimensional harmonic oscillator problem. Given the potential explored in the previous section,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
V(x) = \frac{1}{2} k x^2
\end{align}\]</div>
<p>the Hamiltonian has the form</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\hat{H} = -\frac{\hbar^2}{2m} \frac{d^2}{dx^2} + V(x)
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(m\)</span> represents the mass of the oscillator, and we have assumed that <span class="math notranslate nohighlight">\(x_e = 0\)</span>. Recall from the classical harmonic oscillator problem that the force constant is related to the frequency of oscillation as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\omega = \left ( \frac{k}{m} \right )^{1/2}
\end{align}\]</div>
<p>so the potential can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
V(x) = \frac{1}{2} m \omega^2  x^2
\end{align}\]</div>
<p>Now, it will be convenient to introduce a constant, <span class="math notranslate nohighlight">\(\alpha\)</span>, which is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\alpha = \frac{\omega m}{\hbar}
\end{align}\]</div>
<p>so that the Hamiltonian can be expressed in several equivalent ways:
$<span class="math notranslate nohighlight">\( \begin{align}
\hat{H} &amp;= -\frac{\hbar^2}{2m}\left ( \frac{d^2}{dx^2} - \alpha^2 x^2 \right ) \\
        &amp;= -\frac{\hbar^2}{2m} \frac{d^2}{dx^2} + \frac{1}{2} m \omega^2 x^2 \\
        &amp;= -\frac{\hbar^2}{2m} \frac{d^2}{dx^2} + \frac{1}{2} k x^2 \\
        &amp;= \frac{\hat{p}^2}{2m} + \frac{1}{2} k x^2 \\
\end{align}\)</span>$</p>
<p>As was the case for the translational problems explored in the previous notebook, this Hamiltonian is time-independent, so our goal is to find the eigenfunctions that satisfy the time-independent Schrödinger equation,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{H} \psi(x) = E \psi(x)
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{align}
-\frac{\hbar^2}{2m}\left ( \frac{d^2}{dx^2} - \alpha^2 x^2 \right) \psi(x) = E \psi(x)
\end{align}\]</div>
<p>Rerranging this equation slightly gives us</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{d^2}{dx^2} \psi(x) + \left (\frac{2 m E}{\hbar^2} - \alpha^2 x^2 \right )\psi(x) = 0 
\end{align}\]</div>
<p>Unfortunately, we can see that this differential equation is much more complicated than any that we have encountered so far, which is attributable to the fact that the potential depends the displacement, <span class="math notranslate nohighlight">\(x\)</span>. In order to solve this equation, we find a power series solution.</p>
<p><strong>This is fairly lengthy, so we leave this derivation as optional material for the interested reader.  The solution to the energy eigenvalues is provided below this optional derivation.</strong></p>
<details>
  <summary>Click to Show The Power Series Solution to the Harmonic Oscillator Schrödinger Equation</summary>
<section id="power-series-solution-to-the-schrodinger-equation">
<h3>Power Series Solution to the Schrödinger Equation<a class="headerlink" href="#power-series-solution-to-the-schrodinger-equation" title="Link to this heading">#</a></h3>
<p>The basic idea of a power series solution to a differential equation is to assume that the function, in this case, the wave function, <span class="math notranslate nohighlight">\(\psi(x)\)</span>, can be expanded as a power series</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi(x) = \sum_{n=0}^{\infty} a_n x^n = a_0 + a_1 x + a_2 x^2 + ...
\end{align}\]</div>
<p>This form can then be substituted back into the differential equation so that we can solve for the unknown expansion coefficients, <span class="math notranslate nohighlight">\(a_n\)</span>. Doing so, in this case, would lead to a three-term recursion relation amongst the coefficients. It turns out that a simpler, two-term recursion relation can be obtained by instead making a clever choice for the functional form of <span class="math notranslate nohighlight">\(\psi(x)\)</span> before invoking the concept of the power series. Armed with the <b><font color='red'>i</font><font color='orange'>n</font><font color='yellow'>f</font><font color='green'>i</font><font color='blue'>n</font><font color='indigo'>i</font><font color='violet'>t</font><font color='red'>e</font> <font color='orange'>w</font><font color='yellow'>i</font><font color='green'>s</font><font color='blue'>d</font><font color='indigo'>o</font><font color='violet'>m</font></b> of already knowing the right answer, we will try</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi(x) = e^{-\alpha x^2/2} f(x)
\end{align}\]</div>
<p>and expand <span class="math notranslate nohighlight">\(f(x)\)</span> as a power series, rather than <span class="math notranslate nohighlight">\(\psi(x)\)</span>. So, we have</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
f(x) = \sum_{n=0}^\infty c_n x^n
\end{align}\]</div>
<p>and our task is to determine the coefficients, <span class="math notranslate nohighlight">\(c_n\)</span>. Let us begin by recognizing that the time-independent Schrödinger equation is a second-order differential equation, so we need to evaluate the second derivative of the wave function. The first derivative is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi^\prime(x) = -\alpha x e^{-\alpha x^2/2} f(x) + e^{-\alpha x^2/2} f^\prime(x)
\end{align}\]</div>
<p>and the second derivative is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi^{\prime\prime}(x) = e^{-\alpha x^2/2}\left [ -\alpha f(x) + \alpha^2 x^2 f(x) - 2\alpha x f^{\prime}(x) + f^{\prime\prime}(x) \right ]
\end{align}\]</div>
<p>Inserting <span class="math notranslate nohighlight">\(\psi(x)\)</span> and <span class="math notranslate nohighlight">\(\psi^{\prime\prime}(x)\)</span> into the Schrödinger equation yields</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
e^{-\alpha x^2/2}\left [ -\alpha f(x) + \alpha^2 x^2 f(x) - 2\alpha x f^{\prime}(x) + f^{\prime\prime}(x) \right ] + \left (\frac{2 m E}{\hbar^2} - \alpha^2 x^2 \right ) e^{-\alpha x^2/2} f(x) = 0 
\end{align}\]</div>
<p>which simplifies to</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f^{\prime\prime}(x) - 2\alpha x f^{\prime}(x) + \left (\frac{2 m E}{\hbar^2} - \alpha\right )  f(x) = 0 
\end{align}\]</div>
<p>Now, we must evaluate the first and scond derivative of <span class="math notranslate nohighlight">\(f(x)\)</span>. Recall</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
f(x) = \sum_{n=0}^{\infty} c_n x^n
\end{align}\]</div>
<p>so <span class="math notranslate nohighlight">\(f^{\prime}(x)\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
f^{\prime}(x) &amp;= \sum_{n = 1}^{\infty}n c_n x^{n-1} \\
&amp;= \sum_{n = 0}^\infty n c_n x^{n-1}
\end{align}\end{split}\]</div>
<p>where, in the second line, we note that the lower limit of the sum can be changed to zero without impacting the sum. The second derivative is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f^{\prime\prime}(x) &amp;= \sum_{n = 2} n(n-1) c_n x^{n-2}
\end{align}\]</div>
<p>By choosing a dummy index, <span class="math notranslate nohighlight">\(k = n-2\)</span>, we can adjust the summation limits so that they match those used in the first derivative expression</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f^{\prime\prime}(x) &amp;= \sum_{k = 0} (k+2)(k+1) c_{k+2} x^k
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f^{\prime\prime}(x) &amp;= \sum_{n = 0} (n+2)(n+1) c_{n+2} x^n
\end{align}\]</div>
<p>Plugging these results back into</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
f^{\prime\prime}(x) - 2\alpha x f^{\prime}(x) + \left (\frac{2 m E}{\hbar^2} - \alpha\right )  f(x) = 0 
\end{align}\]</div>
<p>yields</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\sum_{n=0}^{\infty}  \left [ (n+2)(n+1) c_{n+2} - 2 \alpha n c_n + \left ( \frac{2mE}{\hbar^2} - \alpha \right ) c_n \right ] x^n = 0
\end{align}\]</div>
<p>Now, we note that the monomials, <span class="math notranslate nohighlight">\(x^n\)</span>, are linearly independent functions, which means that the polynomial in the above equation can only be satisfied for all values of <span class="math notranslate nohighlight">\(x\)</span> if the coefficient in front of <span class="math notranslate nohighlight">\(x^n\)</span> is zero, for all <span class="math notranslate nohighlight">\(n\)</span>. So we have</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
(n+2)(n+1) c_{n+2} + \left (  - 2 \alpha n + \frac{2mE}{\hbar^2} - \alpha \right ) c_n  = 0\text{, }\forall n
\end{align}\]</div>
<p>which leads to a two-term recursion relation</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
c_{n+2} = \frac{\alpha(2n+1) - 2mE/\hbar^2}{(n+1)(n+2)} c_n
\end{align}\]</div>
</details><details>
  <summary>Click to Show the application of boundary conditions to the solution</summary>
</section>
<section id="applying-boundary-conditions">
<h3>Applying Boundary Conditions<a class="headerlink" href="#applying-boundary-conditions" title="Link to this heading">#</a></h3>
<p>Having established the form of the wave function and the recursion relation for the coefficients in the power series expansion, we must now ask ourselves whether any restrictions need to be placed on the coefficients in order for the wave function to be well behaved. This exercise will be easiest if we regroup the terms in the power series slightly. First, let us assume that the coefficient <span class="math notranslate nohighlight">\(c_1\)</span> is equal to zero. If this is the case, then all coefficients, <span class="math notranslate nohighlight">\(c_n\)</span>, with odd <span class="math notranslate nohighlight">\(n\)</span> will also be zero, and the wave function will have the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\psi(x) &amp;= e^{-\alpha x^2/2} \sum_{n = 0, 2, 4...}^{\infty} c_n x^n \\ 
&amp;= e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l} x^{2l}
\end{align}\end{split}\]</div>
<p>similarly, if <span class="math notranslate nohighlight">\(c_0 = 0\)</span>, then all coefficients, <span class="math notranslate nohighlight">\(c_n\)</span>, with even <span class="math notranslate nohighlight">\(n\)</span> will also be zero, leading to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\psi(x) &amp;= e^{-\alpha x^2/2} \sum_{n = 1, 3, 5...}^{\infty} c_n x^n \\ 
&amp;= e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l+1} x^{2l+1}
\end{align}\end{split}\]</div>
<p>Now, a general form for the wave function could be expressed as a linear combination of these even and odd terms</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi(x) = A e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l+1} x^{2l+1} + B e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l} x^{2l} 
\end{align}\]</div>
<p>Our task is not to determine the coefficients <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(c_0\)</span>, and <span class="math notranslate nohighlight">\(c_1\)</span>. To do so, we should ask ourselves how do these functions behave in the limit that <span class="math notranslate nohighlight">\(l\)</span> becomes very large? Let us consider the ratio of two successive coefficients in the in the even series, <span class="math notranslate nohighlight">\(c_{2l+2}\)</span> and <span class="math notranslate nohighlight">\(c_{2l}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\frac{c_{2l+2}}{c_{2l}} = \frac{\alpha + 4 \alpha l - 2mE/\hbar^2}{(2l+1))(2l+2)}
\end{align}\]</div>
<p>In the limit of large <span class="math notranslate nohighlight">\(l\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lim_{l\to\text{large}} \frac{c_{2l+2}}{c_{2l}} = \frac{\alpha}{l}
\end{align}\]</div>
<p>Performing this exercise on the odd series leads to the same result. Again, armed with the <b><font color='red'>i</font><font color='orange'>n</font><font color='yellow'>f</font><font color='green'>i</font><font color='blue'>n</font><font color='indigo'>i</font><font color='violet'>t</font><font color='red'>e</font> <font color='orange'>w</font><font color='yellow'>i</font><font color='green'>s</font><font color='blue'>d</font><font color='indigo'>o</font><font color='violet'>m</font></b> of already knowing the right answer, let us attempt to find a Taylor series expansion that looks similar in the limit of large <span class="math notranslate nohighlight">\(l\)</span>. Consider the Taylor series expansion for the Gaussian function</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
e^{\alpha x^2} &amp;= \sum_{n=0} \frac{(\alpha x^2)^n}{n!} \\
&amp;= 1 + \alpha x^2 + ... + \frac{\alpha^lx^{2l}}{l!} + \frac{\alpha^{l+1}x^{2l+1}}{(l+1)!}
\end{align}\end{split}\]</div>
<p>Taking the ratio of the coefficients in the last two terms yields</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\frac{\alpha^{l+1}l(l-1)(l-2)...}{\alpha^l(l+1) l (l-1)(l-2)...} = \frac{\alpha}{l+1}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lim_{l\to\text{large}} \frac{\alpha}{l+1} = \frac{\alpha}{l}
\end{align}\]</div>
<p>The conclusion we can draw is that, for large <span class="math notranslate nohighlight">\(l\)</span>, the power series expansion of <span class="math notranslate nohighlight">\(f(x)\)</span> begins to look like the Gaussian function, <span class="math notranslate nohighlight">\(e^{\alpha x^2}\)</span>!</p>
<p>What consequences does this observation have for the wave function? Recall, we have</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi(x) =  A e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l+1} x^{2l+1} + B e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l} x^{2l} 
\end{align}\]</div>
<p>Consider the limit as <span class="math notranslate nohighlight">\(x\)</span> tends to infinity. In this case, <span class="math notranslate nohighlight">\(\psi(x)\)</span> will be dominated by the large-<span class="math notranslate nohighlight">\(l\)</span> terms, and, as <span class="math notranslate nohighlight">\(l\)</span> gets large, each series begins to look like <span class="math notranslate nohighlight">\(e^{\alpha x^2}\)</span>. To a gross approximation, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\lim_{x \to \infty} \psi(x) &amp;\approx e^{-\alpha x^2/2} \left [A e^{\alpha x^2}  + B e^{\alpha x^2} \right ] \\
&amp;\approx e^{\alpha x^2/2} \left [A  + B \right ]
\end{align}\end{split}\]</div>
<p>Recall that <span class="math notranslate nohighlight">\(\alpha = 2\pi\nu m / \hbar &gt; 0\)</span> is a positive number, so</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lim_{x \to \infty} \psi(x) = 0 
\end{align}\]</div>
<p>which clearly is not acceptable because this result implies that</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\psi(x)\)</span> would not be square integrable.</p></li>
<li><p>the probability of finding the oscillator infinitely far from equilibrium would be infinite.</p></li>
</ol>
<p>Hence, we have discovered the boundary condition for this problem.</p>
<p>Under what circumstances can we guarantee that <span class="math notranslate nohighlight">\(\psi(x)\)</span> will not go to infinity as <span class="math notranslate nohighlight">\(x \to \infty\)</span>? The choice <span class="math notranslate nohighlight">\(A = B = 0\)</span> would suffice, except that <span class="math notranslate nohighlight">\(|\psi(x)|^2=0\)</span> for all <span class="math notranslate nohighlight">\(x\)</span>, which implies that there is zero probability of finding the oscillator at any displacement. This result does not make sense physically and is rejected. If either <span class="math notranslate nohighlight">\(A\)</span> or <span class="math notranslate nohighlight">\(B\)</span> are nonzero, then the power series expansion for <span class="math notranslate nohighlight">\(f(x)\)</span> must truncate to avoid the wave function tending to infinity at large displacements. The way to accomplish this goal is to require that, for some coefficient <span class="math notranslate nohighlight">\(c_v\)</span>, the next coefficient in the series, <span class="math notranslate nohighlight">\(c_{v+2}\)</span>, must vanish. In this case, we would have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
c_{v+2} = 0 = \frac{\alpha ( 2 v + 1) - 2mE/\hbar^2}{(v+1)(v+2)} c_v
\end{align}\]</div>
</details>
</section>
<section id="final-energy-eigenvalue-expression">
<h3>Final Energy Eigenvalue Expression<a class="headerlink" href="#final-energy-eigenvalue-expression" title="Link to this heading">#</a></h3>
<p>Solving for <span class="math notranslate nohighlight">\(E\)</span> and using <span class="math notranslate nohighlight">\(\alpha = \omega m / \hbar\)</span> yields</p>
<div class="math notranslate nohighlight">
\[\begin{align}
E_n = \hbar\omega\left ( v + \frac{1}{2} \right) = h\nu \left( v + \frac{1}{2} \right)
\end{align}\]</div>
<p>where we have added a subscript “<span class="math notranslate nohighlight">\(v\)</span>” to the energy to indicate that the energy of the state is determined by the vibrational quantum number, <span class="math notranslate nohighlight">\(v\)</span>. So, what have we learned?</p>
<ol class="arabic simple">
<li><p>The energy of the QHO is quantized, and <span class="math notranslate nohighlight">\(v\)</span> is the quantum number. <span class="math notranslate nohighlight">\(v = 0, 1, 2, ...\)</span> are allowed values for the quantum number.</p></li>
<li><p>Once again, the application of boundary conditions has led to the quantization of the energy.</p></li>
<li><p>The energy leves for a QHO are evenly spaced (by <span class="math notranslate nohighlight">\(\hbar \omega\)</span> or <span class="math notranslate nohighlight">\(h\nu\)</span>).</p></li>
<li><p>If <span class="math notranslate nohighlight">\(v=0\)</span> is allowed (it is), then they lowest energy is
$<span class="math notranslate nohighlight">\(\begin{align}
E_0 = \frac{1}{2} \hbar \omega = \frac{1}{2} h \nu
\end{align}\)</span>$
which is called the “zero-point” energy. Since there is no lower energy leven, the interpretation is that the energy of the QHO is non-zero, even at zero kelvin.</p></li>
</ol>
</section>
<section id="qho-wave-functions">
<h3>QHO Wave Functions<a class="headerlink" href="#qho-wave-functions" title="Link to this heading">#</a></h3>
<p>In the previous section, the solutions to the Schrödinger equation were given as a linear combination of polynomials involving either even and odd powers of <span class="math notranslate nohighlight">\(x\)</span>, i.e.,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi_v(x) = A e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l+1} x^{2l+1} + B e^{-\alpha x^2/2} \sum_{l=0}^{\infty} c_{2l} x^{2l} 
\end{align}\]</div>
<p>where we have added a subscript, <span class="math notranslate nohighlight">\(v\)</span>, to denote the quantum number for the state. Now, it becomes clear that, in order for these functions to be well behaved, we should include only one of these sums, based on whether <span class="math notranslate nohighlight">\(v\)</span> is even or odd. The reason is that, if, for example, <span class="math notranslate nohighlight">\(v\)</span> is even, then the even series will truncate, but the odd series will not. Hence, for even <span class="math notranslate nohighlight">\(v,\)</span> the coefficient <span class="math notranslate nohighlight">\(A\)</span> must vanish. Similarly, if <span class="math notranslate nohighlight">\(v\)</span> is odd, then the odd series will truncate, but the even one will not. Hence, for odd <span class="math notranslate nohighlight">\(v,\)</span> the coefficient <span class="math notranslate nohighlight">\(B\)</span> must vanish. In other words, an eigenfunction of the QHO Hamiltonian, <span class="math notranslate nohighlight">\(\psi_v(x)\)</span> will consist of one of these sums, but not both.</p>
<p>As an example, consider the state with <span class="math notranslate nohighlight">\(v = 2,\)</span> where <span class="math notranslate nohighlight">\(A\)</span> must be equal to zero.</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\psi_2(x) = B \sum_{l=0}^\infty c_{2l} x^{2l} e^{-\alpha x^2/2}
\end{align}\]</div>
<p>What are the coefficients, <span class="math notranslate nohighlight">\(c_{2l}\)</span>?  Recall,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
c_{n+2} = \frac{\alpha (2n+1) - 2mE/\hbar^2}{(n+1)(n+2)} c_n 
\end{align}\]</div>
<p>Given that</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\alpha = 2\pi \nu m / \hbar
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
E = h \nu ( v + 1/2)
\end{align}\]</div>
<p>we can show that</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{m E}{\hbar^2} = \alpha ( v + 1/2)
\end{align}\]</div>
<p>so the recursion relationship becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
c_{n+2} = \frac{2\alpha ( n + 1/2) - 2\alpha ( v + 1/2)}{(n+1)(n+2)} c_n
\end{align}\]</div>
<p>Now, it is clear that the numerator will vanish and the series will truncate when <span class="math notranslate nohighlight">\(n = v.\)</span> So, for <span class="math notranslate nohighlight">\(v = 2\)</span>, we can assume that <span class="math notranslate nohighlight">\(c_0\)</span> can be determined via normalization, and then we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
c_2 &amp;= \frac{2\alpha(0 - 2)}{(0+1)(0+2)}c_0 = -2\alpha c_0 \\
c_4 &amp;= \frac{2\alpha(2 - 2)}{(2+1)(2+2)}c_2 = 0 \\
c_6 &amp;= 0 \\
\text{etc.}
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi_2(x) = B c_0 \left ( 1 - 2\alpha x^2 \right )e^{-\alpha x^2/2} 
\end{align}\]</div>
<p>We can absorb <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(c_0\)</span> into a single normalization constant, <span class="math notranslate nohighlight">\(N_2\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{align}
\psi_2(x) = N_2 \left ( 1 - 2\alpha x^2 \right )e^{-\alpha x^2/2}
\end{align}\]</div>
<p>or, after normalization</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\psi_2(x) = \left ( \frac{\alpha}{4\pi} \right)^{1/4} \left ( 1 - 2\alpha x^2 \right )e^{-\alpha x^2/2}
\end{align}\]</div>
<p>In general, the wave function for state <span class="math notranslate nohighlight">\(v\)</span> has the form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\psi_v(x) = \left ( 2^v v! \right )^{-1/2} \left ( \frac{\alpha}{\pi} \right)^{1/4} e^{-\alpha x^2/2} H_v(\alpha^{1/2} x)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(H_v\)</span> represents a special polynomial function called a Hermite polynomial, the first few of which are tabulated here:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(H_v(z)\)</span></p></th>
<th class="head"><p>symmetry</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H_0 = 1\)</span></p></td>
<td><p>even</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H_1 = 2z\)</span></p></td>
<td><p>odd</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H_2 = 4z^2-2\)</span></p></td>
<td><p>even</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H_3 = 8z^3 - 12z\)</span></p></td>
<td><p>odd</p></td>
</tr>
</tbody>
</table>
</div>
<p>Because the Gaussian part of the wave function, <span class="math notranslate nohighlight">\(e^{-\alpha x^2/2}\)</span>, is even in the displacement coordinate, the symmetry of the Hermite polynomials determines the overall symmetry of the wave function. Let us visualize the first few QHO wave functions using the built-in Hermite polynomial functionality in scipy library. For this excercise, we will use arbitrary values for the parameters, <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(m\)</span>, that are chosen for ease of visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for hermite polynomials</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># for the factorial function</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># displacements</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># arbitrary parameters</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">hbar</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># frequency and angular frequency</span>
<span class="n">nu</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">m</span> <span class="o">/</span> <span class="n">hbar</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># potential</span>
<span class="n">potential</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># energy, eigenfunctions, and turning points</span>
<span class="n">wfn</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">energy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x_tp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="c1"># hermite polynomial</span>
    <span class="n">H_v</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">hermite</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># normalization constant</span>
    <span class="n">N_v</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">2</span><span class="o">**</span><span class="n">v</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>

    <span class="c1"># wave function</span>
    <span class="n">psi_v</span> <span class="o">=</span> <span class="n">N_v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">H_v</span><span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
    
    <span class="n">wfn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">psi_v</span><span class="p">)</span>

    <span class="c1"># energy</span>
    <span class="n">my_energy</span> <span class="o">=</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_energy</span><span class="p">)</span>

    <span class="c1"># turning point E = V(x) = 1/2 k x^2 = 2 m nu^2 pi^2 x^2</span>
    <span class="n">my_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">my_energy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="p">))</span>
    <span class="n">x_tp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_x</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\psi(x)$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=0&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=1&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=2&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=3&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=4&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">x_tp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">[</span><span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">energy</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$|\psi(x)|^2$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=0&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=1&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=2&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=3&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfn</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">energy</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;v=4&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">x_tp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">[</span><span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">energy</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/471062a77d7d137fc36280db78614233c6ec9e88a650b14536e4fb3438a35d5e.png" src="../../_images/471062a77d7d137fc36280db78614233c6ec9e88a650b14536e4fb3438a35d5e.png" />
</div>
</div>
<p>In this figure, the horizontal lines represent the classically “allowed” regions, where <span class="math notranslate nohighlight">\(V(x) \le E_v\)</span>. The QHO wave functions oscillate within this region and decay in the classically forbidden regions, where <span class="math notranslate nohighlight">\(V(x) &gt; E_v\)</span>. Recall that, classically, the total energy is the sum of potential energy, <span class="math notranslate nohighlight">\(V(x)\)</span>, and kinetic energy, <span class="math notranslate nohighlight">\(T_x\)</span>,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
E = T_x + V(x)
\end{align}\]</div>
<p>Having a potential energy that exceeds the total energy requires a negative kinetic energy, which implies that the momentum is imaginary - a nonsensical result. If the QHO has a non-zero probability of existing in the classically forbidden region, do we have a similar nonsensical result? Not quite. Recall that, quantum mechanically, one cannot state that the energy is <em>exactly</em> equal to a given value unless the state is an eigenfunction of the energy operator (the Hamiltonian). Similarly, one cannot state that the potential or kinetic energy are known, exactly, unless the state is an eigenfunction of the potential or kinetic energy operators. We deal, instead, with expectation values, i.e.,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\langle E \rangle = \langle T_x \rangle + \langle V(x) \rangle
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
E = \langle T_x \rangle + \langle V(x) \rangle
\end{align}\]</div>
<p>if the state is an eigenfunction of the Hamiltonian. For the QHO problem, <span class="math notranslate nohighlight">\(\hat{T}\)</span> does not commute with the Hamiltonian, nor does <span class="math notranslate nohighlight">\(V(x)\)</span>, so, it is impossible to define simultaneous eigenfunctions of these three operators, so we can only predict the expecation values, <span class="math notranslate nohighlight">\(\langle T\rangle \)</span> and <span class="math notranslate nohighlight">\(\langle V(x)\rangle \)</span>. In one of the previous notebooks, we proved that</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\langle T_x \rangle  \ge 0
\end{align}\]</div>
<p>which implies that</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\langle V(x) \rangle  \le E
\end{align}\]</div>
<p>However, because we cannot know the exact value of <span class="math notranslate nohighlight">\(V(x)\)</span> without taking a measurement, we cannot say with certainty that <span class="math notranslate nohighlight">\(V(x) &lt; E\)</span>.</p>
</section>
<section id="tunneling-and-the-correspondence-principle">
<h3>Tunneling and the Correspondence Principle<a class="headerlink" href="#tunneling-and-the-correspondence-principle" title="Link to this heading">#</a></h3>
<p>The penetration of the QHO wave functions into the classically forbidden regions is called tunneling. What is the probability of a QHO in the ground state <span class="math notranslate nohighlight">\((v=0)\)</span> being found beyond one of the classical turning points? If the wave function is normalized, then the tunneling probability for any QHO state, <span class="math notranslate nohighlight">\(\psi_v(x)\)</span>, is given by</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P = \int_{-\infty}^{-x_\text{tp}} |\psi_v(x)|^2 dx + \int_{x_\text{tp}}^\infty |\psi_v(x)|^2 dx
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\pm x_\text{tp}\)</span> represent the classical turning points, which can be determined via</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
x_\text{tp} &amp;= \pm \left [ 2 E_v / k \right ]^{1/2} \\
&amp;= \pm \left [ E_v / (2 m \nu^2 \pi^2) \right ]^{1/2}
\end{align}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(E_v = h\nu ( v + 1/2)\)</span>. It turns out that this probability is slightly easier to evaluate as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
P &amp;= 1 - \int_{-x_\text{tp}}^{x_\text{tp}} |\psi_v(x)|^2 dx \\
 &amp;= 1 - 2 \int_{0}^{x_\text{tp}} |\psi_v(x)|^2 dx \\
\end{align}\end{split}\]</div>
<p>where, in the second line, we have recognized that the probability density is symmetric about <span class="math notranslate nohighlight">\(x=0\)</span>. For the ground state, we have</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\psi_0(x) = \left ( \frac{\alpha}{\pi} \right ) ^{1/4} e^{-\alpha x^2/2}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
x_\text{tp} &amp;= \pm \left [ h \nu / k \right ]^{1/2}
\end{align}\]</div>
<p>so the probability is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P = 1 - 2\int_{0}^{x_\text{tp}} \left ( \frac{\alpha}{\pi} \right ) ^{1/2} e^{-\alpha x^2} dx
\end{align}\]</div>
<p>Now, using</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\nu = \frac{1}{2\pi}\left ( \frac{k}{m} \right ) ^{1/2}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
k = \nu^2(2 \pi)^2 m
\end{align}\]</div>
<p>we can show that</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
x_\text{tp} = \alpha^{-1/2}
\end{align}\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P = 1 - 2\int_{0}^{\alpha^{-1/2}} \left ( \frac{\alpha}{\pi} \right ) ^{1/2} e^{-\alpha x^2} dx 
\end{align}\]</div>
<p>We perform a change of variables so that</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
\xi &amp;= \alpha^{1/2} x \\
d\xi &amp;= \alpha^{1/2} dx \\
\xi_\text{tp} &amp;=  \alpha^{1/2} x_\text{tp} = 1
\end{align}\end{split}\]</div>
<p>which leads to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
P &amp;= 1 - \frac{2}{\pi^{1/2}} \int_{0}^1 e^{-\xi^2} d\xi \\
&amp;= 1 - \text{erf}(1) \\
&amp;= 0.1573
\end{align}
\end{split}\]</div>
<p>where erf(1) is <a class="reference external" href="https://mathworld.wolfram.com/Erf.html">the error function</a>. According to this analysis, there is a <span class="math notranslate nohighlight">\(\approx 16\%\)</span> probability that an oscillator in the <span class="math notranslate nohighlight">\(v=0\)</span> will be found past the classical turning point.</p>
<p>How does the tunneling probability change with the quantum number, <span class="math notranslate nohighlight">\(v\)</span>? The <strong>Bohr Correspondence Principle</strong> states that quantum mechanics should recover classical results in the limit of large quantum numbers. Since the tunneling probability is zero for a classical harmonic oscillator, we should expect the tunneling probability to decrease with increasing <span class="math notranslate nohighlight">\(v\)</span>. The following Python code calculates the tunneling probability numerically so that we can visualize this trend, for up to <span class="math notranslate nohighlight">\(v=100.\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># energy, eigenfunctions, and turning points</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>

    <span class="c1"># energy</span>
    <span class="n">my_energy</span> <span class="o">=</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># turning point E = V(x) = 1/2 k x^2 = 2 m nu^2 pi^2 x^2</span>
    <span class="n">my_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">my_energy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="p">))</span>

    <span class="c1"># grid for integral [-x_tp:x_tp]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">my_x</span><span class="p">,</span> <span class="n">my_x</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>

    <span class="c1"># hermite polynomial</span>
    <span class="n">H_v</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">hermite</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># normalization constant</span>
    <span class="n">N_v</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">2</span><span class="o">**</span><span class="n">v</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>

    <span class="c1"># wave function</span>
    <span class="n">psi_v</span> <span class="o">=</span> <span class="n">N_v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">H_v</span><span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># P = 1 - 2 int...</span>
    <span class="n">my_P</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">psi_v</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span> <span class="o">*</span> <span class="n">psi_v</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_P</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;tunneling probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/196831440b217a21f4a17d054bf06280cd246f3ee5e9e86cc4c0ddb48f1b4544.png" src="../../_images/196831440b217a21f4a17d054bf06280cd246f3ee5e9e86cc4c0ddb48f1b4544.png" />
</div>
</div>
<p>Indeed, this numerical study demonstrates that the tunneling probability decreases monotonically with increasing <span class="math notranslate nohighlight">\(v\)</span>, as expected.</p>
<p>A second manifiestation of the Bohr Correspondence Principle is the evolution of the overall shape of the probability density toward the classical limit, which is <a class="reference external" href="https://en.wikipedia.org/wiki/Classical_probability_density">given by</a></p>
<div class="math notranslate nohighlight">
\[\begin{align}
P = \frac{1}{\pi (x_\text{tp}^2 - x^2)^{1/2}}
\end{align}\]</div>
<p>The following Python code calculates the probability distribution for states with <span class="math notranslate nohighlight">\(v \le 30\)</span> so that we can compare the quantum distribution to the classical one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># lists of 2d line objects ... each frame will be an element in the list</span>
<span class="n">line2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;quantum&#39;</span><span class="p">)</span>
<span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;classical&#39;</span><span class="p">)</span>

<span class="c1"># figure details</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;displacement&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1"># animation function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">probability_density</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>

    <span class="c1"># energy</span>
    <span class="n">my_energy</span> <span class="o">=</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="p">(</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># turning point E = V(x) = 1/2 k x^2 = 2 m nu^2 pi^2 x^2</span>
    <span class="n">my_x_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">my_energy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">nu</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="p">))</span>

    <span class="c1"># grid [-x_tp:x_tp]</span>
    <span class="n">x_classical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">my_x_tp</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">my_x_tp</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># grid [-7:7]</span>
    <span class="n">x_quantum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># hermite polynomial</span>
    <span class="n">H_v</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">hermite</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># normalization constant</span>
    <span class="n">N_v</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">2</span><span class="o">**</span><span class="n">v</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>

    <span class="c1"># wave function</span>
    <span class="n">psi_v</span> <span class="o">=</span> <span class="n">N_v</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x_quantum</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">H_v</span><span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x_quantum</span><span class="p">)</span>
    <span class="n">P_quantum</span> <span class="o">=</span> <span class="n">psi_v</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span> <span class="o">*</span> <span class="n">psi_v</span>

    <span class="c1"># P = 1/(pi * sqrt(xtp^2 - x^2))</span>
    <span class="n">P_classical</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">my_x_tp</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x_classical</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_P</span><span class="p">)</span>

    <span class="n">line1</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">x_classical</span><span class="p">,</span> <span class="n">P_classical</span><span class="p">)</span>
    <span class="n">line2</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">x_quantum</span><span class="p">,</span> <span class="n">P_quantum</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">animation</span>

<span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">probability_density</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">54</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span> <span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">probability_density</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="ne">---&gt; </span><span class="mi">54</span> <span class="n">HTML</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.11/site-packages/matplotlib/animation.py:1302,</span> in <span class="ni">Animation.to_html5_video</span><span class="nt">(self, embed_limit)</span>
<span class="g g-Whitespace">   </span><span class="mi">1299</span> <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s2">&quot;temp.m4v&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1300</span> <span class="c1"># We create a writer manually so that we can get the</span>
<span class="g g-Whitespace">   </span><span class="mi">1301</span> <span class="c1"># appropriate size for the tag</span>
<span class="ne">-&gt; </span><span class="mi">1302</span> <span class="n">Writer</span> <span class="o">=</span> <span class="n">writers</span><span class="p">[</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;animation.writer&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">   </span><span class="mi">1303</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">Writer</span><span class="p">(</span><span class="n">codec</span><span class="o">=</span><span class="s1">&#39;h264&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1304</span>                 <span class="n">bitrate</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;animation.bitrate&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">   </span><span class="mi">1305</span>                 <span class="n">fps</span><span class="o">=</span><span class="mf">1000.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1306</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/jbook/lib/python3.11/site-packages/matplotlib/animation.py:121,</span> in <span class="ni">MovieWriterRegistry.__getitem__</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_available</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_registered</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">121</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested MovieWriter (</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">) not available&quot;</span><span class="p">)</span>

<span class="ne">RuntimeError</span>: Requested MovieWriter (ffmpeg) not available
</pre></div>
</div>
<img alt="../../_images/6ba72994d1d56084b75ad033e22eb81f162b50ca56dfcef504ce7250fd2c784f.png" src="../../_images/6ba72994d1d56084b75ad033e22eb81f162b50ca56dfcef504ce7250fd2c784f.png" />
</div>
</div>
</section>
<section id="selection-rules">
<h3>Selection Rules<a class="headerlink" href="#selection-rules" title="Link to this heading">#</a></h3>
<p>The QHO model is a model for molecular vibrations. As such, we can use it to predict not only vibrational energy levels, but also spectra. Specifically, we can predict which transitions are “allowed” or “forbidden” based on selection rules that can be derived mathematically.</p>
<section id="fermi-s-golden-rule">
<h4>Fermi’s Golden Rule<a class="headerlink" href="#fermi-s-golden-rule" title="Link to this heading">#</a></h4>
<p>Fermi’s Golden Rule is a result derived from time-dependent perturbation theory that allows us to predict the probability that a system will transition between energy states <span class="math notranslate nohighlight">\(\psi_i\)</span> and <span class="math notranslate nohighlight">\(\psi_f\)</span> when interacting with a time-dependent external perturbation, which is represented by the operator, <span class="math notranslate nohighlight">\(\hat{H}^\prime.\)</span> If the perturbation has some angular frequency component, <span class="math notranslate nohighlight">\(\omega\)</span>, that is consistent with the energy difference between states <span class="math notranslate nohighlight">\(\psi_i\)</span> and <span class="math notranslate nohighlight">\(\psi_f\)</span>, <span class="math notranslate nohighlight">\(\hbar \omega\)</span>, then the probability of observing a transition between these states is proportional to the square modulus of an integral involving these states and the perturbation operator:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P_{i\to f} \propto |\langle \psi_i | \hat{H}^\prime | \psi_f \rangle |^2
\end{align}\]</div>
<p>For light-mediated transitions, the perturbing operator is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{H}^\prime = \vec{\epsilon}(t) \cdot \hat{\mu}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{\epsilon}(t)\)</span> is the complex amplitude of a time-dependent electric field, and <span class="math notranslate nohighlight">\(\hat{\mu}\)</span> represents the dipole operator for the system.  These quantities are both vector quantities:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\vec{\epsilon}(t) &amp;= \epsilon_x \vec{i} + \epsilon_y \vec{j} + \epsilon_z\vec{k} \\
\hat{\mu} &amp;= \hat{\mu}_x \vec{i} + \hat{\mu}_y \vec{j} + \hat{\mu}_z\vec{k}\\
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{i},\)</span> <span class="math notranslate nohighlight">\(\vec{j},\)</span> and <span class="math notranslate nohighlight">\(\vec{k}\)</span> are the unit vectors in the <span class="math notranslate nohighlight">\(x,\)</span> <span class="math notranslate nohighlight">\(y,\)</span> and <span class="math notranslate nohighlight">\(z\)</span> directions, respectively.</p>
<p>For this perturbation, the transition probability is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P_{i\to f} \propto |\langle \psi_i | \vec{\epsilon}(t)\cdot \hat{\mu}|\psi_f \rangle |^2
\end{align}\]</div>
<p>If the light is polarized in the <span class="math notranslate nohighlight">\(x\)</span> direction, then <span class="math notranslate nohighlight">\(\epsilon_y = \epsilon_z = 0,\)</span> and this probability simplifies to</p>
<div class="math notranslate nohighlight">
\[\begin{align}
P_{i\to f} \propto |\epsilon_x|^2 |\langle \psi_i | \hat{\mu}_x |\psi_f \rangle |^2
\end{align}\]</div>
<p>The quantity, <span class="math notranslate nohighlight">\(\langle \psi_i | \hat{\mu}_x |\psi_f \rangle,\)</span> is referred to as a “transition dipole” matrix element. The dependence of the transition probability on this quantity is related to the fact that, in order for the system to interact with an external electric field, it must exhibit a change in its dipole moment, at least transitorily. Note that the transition probability is also proportional to <span class="math notranslate nohighlight">\(|\epsilon_x|^2\)</span>, which, itself, is proportional to the intensity of the light. Hence, the transition probability increases with increased intensity.</p>
</section>
<section id="fermi-s-golden-rule-for-molecular-vibrations">
<h4>Fermi’s Golden Rule for Molecular Vibrations<a class="headerlink" href="#fermi-s-golden-rule-for-molecular-vibrations" title="Link to this heading">#</a></h4>
<p>Consider a vibrational mode in a molecular system that is modeled as a harmonic oscillator. For simplicity, let consider only a diatomic molecule. As discussed in the next section, vibrations in such a molecule can be described by the one-dimensional QHO model. Given the solutions to the Schrödinger equation derived above, we can use Fermi’s Golden Rule to examine light-mediated transitions between vibrational states, <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(v^\prime\)</span>. Assuming that the frequency-matching condition is met by the external perturbation, we have</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P_{v \to v^\prime} \propto | \langle \psi_{v^\prime}| \hat{\mu}_x | \psi_v \rangle|^2 
\end{align}\]</div>
<p>The dipole operator is proportional to the displacement coordinate, <span class="math notranslate nohighlight">\(x\)</span>, so we really only need to consider</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P_{v \to v^\prime} \propto | \langle \psi_{v^\prime}| x | \psi_v \rangle|^2 
\end{align}\]</div>
<p>Now, recall that the QHO wave functions have the form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\psi_v(x) = N_v e^{-\alpha x^2/2} H_v(\alpha^{1/2} x)
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
N_v = (2^v v!)^{-1/2} \left ( \frac{\alpha}{\pi}\right )^{1/4}
\end{align}\]</div>
<p>Given states of these form, what are the selection rules? In other words, for what <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(v^\prime\)</span> is the integral <span class="math notranslate nohighlight">\(\langle \psi_{v^\prime}| x | \psi_v \rangle,\)</span> and, thus, <span class="math notranslate nohighlight">\(P_{v\to v^\prime}\)</span>, nonzero? We can answer that question relatively easily with the following two properties:</p>
<ol class="arabic simple">
<li><p><strong>Orthonormality</strong>: Normalized QHO eigenfunctions form an orthonormal set:
$<span class="math notranslate nohighlight">\( \begin{align}
\langle \psi_{v^\prime} (x) | \psi_{v}(x) \rangle = \delta_{vv^\prime}
\end{align}\)</span>$</p></li>
<li><p><strong>Recursion Relations</strong>: Hermite polynomials satisfy the following recursion relations:
$<span class="math notranslate nohighlight">\( \begin{align}
z H_n(z) = nH_{n-1}(z) + \frac{1}{2}H_{n+1}(z)
\end{align}\)</span>$</p></li>
</ol>
<p>Consider the matrix element</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\langle \psi_{v^\prime} | x | \psi_v \rangle = N_{v^\prime} N_v \int_{-\infty}^\infty e^{-\alpha x^2} H_{v^\prime}(\alpha^{1/2}x) x H_v(\alpha^{1/2}x) dx
\end{align}\]</div>
<p>We use a change of variables such that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
z &amp;= \alpha^{1/2} x \\
x &amp;= \alpha^{-1/2} z \\
dx &amp;= \alpha^{-1/2} dz
\end{align}\end{split}\]</div>
<p>to give</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\langle \psi_{v^\prime} | x | \psi_v \rangle = N_{v^\prime} N_v \frac{1}{\alpha} \int_{-\infty}^\infty e^{-z^2} H_{v^\prime}(z) z H_v(z) dz
\end{align}\]</div>
<p>Now, the recursion relations for the Hermite polynomials say</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
z H_v(z) = v H_{v-1}(z) + \frac{1}{2} H_{v+1}(z)
\end{align}\]</div>
<p>As such, we split the matrix element into two terms</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\langle \psi_{v^\prime} | x | \psi_v \rangle = N_{v^\prime} N_v \frac{1}{\alpha} \left [ v \int_{-\infty}^\infty e^{-z^2} H_{v^\prime}(z) H_{v-1}(z) dz + \frac{1}{2} \int_{-\infty}^\infty e^{-z^2} H_{v^\prime}(z) H_{v+1}(z) dz \right ] 
\end{align}\]</div>
<p>These integrals are proportional to overlaps between QHO wave functions, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{-\infty}^\infty e^{-z^2} H_{v^\prime}(z) H_{v-1}(z) dz \propto \langle \psi_{v^\prime}|\psi_{v-1}\rangle = \delta_{v^\prime(v-1)}
\end{align}\]</div>
<p>and
$<span class="math notranslate nohighlight">\(\begin{align}
\int_{-\infty}^\infty e^{-z^2} H_{v^\prime}(z) H_{v+1}(z) dz \propto \langle \psi_{v^\prime}|\psi_{v-1}\rangle = \delta_{v^\prime(v+1)}
\end{align}\)</span>$</p>
<p>which implies that</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
P_{v \to v^\prime} \propto | A \delta_{v^\prime(v-1)} + B \delta_{v^\prime(v+1)} |^2 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are constants. In order for <span class="math notranslate nohighlight">\(P_{v \to v^\prime}\)</span> to be nonzero, we must have either</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
v^\prime = v - 1 
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
v^\prime = v + 1
\end{align}\]</div>
<p>In order words, the change in the vibrational quantum number <span class="math notranslate nohighlight">\(\Delta v = v^\prime - v\)</span> must be</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta v = \pm 1
\end{align}\]</div>
<p>This analysis indicates that, for a QHO, the only allowed transitions are between adjacent energy levels.</p>
<p>Now, we note that we can arrive at part of the selection rule story by considering only the symmetry of the wave functions. Recall that QHO wave functions can have either even or odd symmetry, based on the symmetry of the Hermite polynomials. For even <span class="math notranslate nohighlight">\(v\)</span>, the wave functions are even in the displacement coordinate. For odd <span class="math notranslate nohighlight">\(v\)</span>, the wave functions have odd symmetry. The matrix element that determines whether a vibrational transition is allowed or forbidden is <span class="math notranslate nohighlight">\(\langle \psi_{v^\prime} | x | \psi_v \rangle\)</span>. This integral will only be non-zero if the products of the symmetries of <span class="math notranslate nohighlight">\(\psi_{v^\prime},\)</span> <span class="math notranslate nohighlight">\(\psi_{v},\)</span> and the operator, <span class="math notranslate nohighlight">\(x,\)</span> is even. Because <span class="math notranslate nohighlight">\(x\)</span> is odd, the products of the symmetries of <span class="math notranslate nohighlight">\(\psi_{v^\prime}\)</span> and <span class="math notranslate nohighlight">\(\psi_{v}\)</span> must be odd. This condition is consistent with but weaker than the condition derived above.</p>
<p>Before moving on, we note that, in addition to the <span class="math notranslate nohighlight">\(\Delta v = \pm 1\)</span> selection rule, there are other, more physical rules that apply to different types of vibrational spectroscopy. For IR spectroscopy, transitions will only be observed for vibrational modes that result in a change in the dipole moment of the molecule (called “IR active” modes). We can rationalize this rule by recognizing that the molecule interacts with an electric field through its dipole moment. If the dipole moment does not change with the vibration, then an oscillating electric field cannot couple to that particular vibrational mode. For Raman spectroscopy, the selection rule is different. “Raman-active” vibrational modes result in a change in the polarizability of the molecule.</p>
</section>
</section>
</section>
<section id="connections-to-computational-chemistry">
<h2>Connections to Computational Chemistry<a class="headerlink" href="#connections-to-computational-chemistry" title="Link to this heading">#</a></h2>
<section id="harmonic-frequency-analysis">
<h3>Harmonic Frequency Analysis<a class="headerlink" href="#harmonic-frequency-analysis" title="Link to this heading">#</a></h3>
<p>Many quantum chemistry packages support vibrational analyses on molecular systems that yield both vibrational energies and the normal modes, which are the independent vibrational modes for the molecule. Linear and non-linear molecules possess <span class="math notranslate nohighlight">\(3N-5\)</span> and <span class="math notranslate nohighlight">\(3N-6\)</span> vibrational degrees of freedom, respectively, where <span class="math notranslate nohighlight">\(N\)</span> is the number of atoms. Each of the normal modes can be treated as an independent quantum harmonic oscillator, the energy of which is the same as that derived above. As such, the total vibrational energy is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
E_\text{vib} = \sum_i h \nu_i ( v_i + 1/2 ) = \sum_i \hbar \omega (v_i + 1/2)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_i\)</span> is the frequency for the <span class="math notranslate nohighlight">\(i\)</span>th normal mode. At zero kelvin, only the <span class="math notranslate nohighlight">\(v_i=0\)</span> state is populated for each of these modes, so the total zero-point energy is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
E_\text{ZPE} = \frac{1}{2} \sum_i h \nu_i = \frac{1}{2} \sum_i \hbar \omega_i
\end{align}\]</div>
<p>The harmonic vibrational frequencies can be determined using the method of <a class="reference external" href="https://en.wikipedia.org/wiki/GF_method">F and G matrices</a>, for example. Let us consider the simplest case, a heteronuclear diatomic molecule, <span class="math notranslate nohighlight">\(CO\)</span>. As discussed above, one can calculate the potential energy curve as a function of the C-O distance using a quantum chemistry method such as coupled cluster theory. The potential near the equilibrium geometry can then be approximated with a harmonic one, where the force constant is defined by the second derivative of the calculated potential. Here is the same Python code used above to visualize the calculated and harmonic potentials.</p>
<p>Now, we can write down a Hamiltonian for the nuclei that experience this potential:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\hat{H} = -\frac{\hbar^2}{2 m_1}\frac{d^2}{dx_1^2} -\frac{\hbar^2}{2 m_2}\frac{d^2}{dx_2^2} + \frac{1}{2}k (x_2 - x_1 - x_e)^2
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span> represent the masses of hydrogen atoms 1 and 2, respectively, and <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> represent the respective coordinates. This Hamiltonian depends on the coordinates of two particles, but through a coordinate transformation, it can be re-expressed as a sum of Hamiltonians, one representing the translational motion of the entire molecule and the other representing internal motion. We are concerned only with the internal (vibrational) motion, and the relevant Hamiltonian is</p>
<div class="math notranslate nohighlight">
\[ \begin{align}
\hat{H} = -\frac{\hbar^2}{2 \mu}\frac{d^2}{dx^2} + \frac{1}{2}k (x - x_e)^2
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(x = x_2 - x_1\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> is the reduced mass</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mu = \frac{m_1 m_2}{m_1 + m_2}
\end{align}\]</div>
<p>This Hamiltonian resembles the QHO Hamiltonian for an effective particle of mass, <span class="math notranslate nohighlight">\(\mu\)</span>. As such, we can apply the QHO model directly to this Hamiltonian, and the vibrational frequency should be</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nu = \frac{1}{2\pi} \left ( \frac{k}{\mu} \right )^{1/2}
\end{align}\]</div>
<p>We can determine <span class="math notranslate nohighlight">\(\nu\)</span> using the value for <span class="math notranslate nohighlight">\(k\)</span> extracted from the HF potential energy curve we computed earlier.</p>
</section>
</section>
<section id="important-points-about-units">
<h2>Important Points about Units<a class="headerlink" href="#important-points-about-units" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We have computed our <span class="math notranslate nohighlight">\(k\)</span> value in atomic units</p></li>
<li><p>We typically report atomic masses in atomic mass units, which are not the same as atomic units</p></li>
<li><p>We will want to convert our reduced mass to atomic units so that our frequency can be in a common unit system</p></li>
<li><p>We should report our fundamental frequency in a unit system that aligns with spectroscopic conventions, which for vibrational spectroscopy is the wavenumber <span class="math notranslate nohighlight">\(\bar{\nu}\)</span> in <span class="math notranslate nohighlight">\({\rm cm}^{-1}\)</span></p></li>
</ul>
<p>Let’s think through how we can perform the necessary unit conversion.</p>
<p><strong>Atomic Mass Unit</strong> Is defined such that <span class="math notranslate nohighlight">\(1 \: {\rm AMU} = \frac{m_{\rm ^{12}C}}{12}\)</span>, where <span class="math notranslate nohighlight">\(m_{{\rm ^{12}C}}\)</span> is the mass of carbon 12.</p>
<p><strong>Atomic Unit of Mass</strong> Is defined such that <span class="math notranslate nohighlight">\(1 \: {\rm a.u.} = m_{\rm e}\)</span>, where <span class="math notranslate nohighlight">\(m_{\rm e}\)</span> is the mass of an electron.</p>
<p>Let’s think through how we can perform the necessary unit conversion.</p>
<p><strong>Atomic Mass Unit</strong> is defined such that<br />
$<span class="math notranslate nohighlight">\(1 \: \text{AMU} = \frac{m_{\rm ^{12}C}}{12},\)</span><span class="math notranslate nohighlight">\(  
where \)</span> m_{\rm ^{12}C} $ is the mass of a carbon-12 atom.</p>
<p><strong>Atomic Unit of Mass</strong> is defined such that<br />
$<span class="math notranslate nohighlight">\(1 \: \text{a.u.} = m_{\rm e},\)</span><span class="math notranslate nohighlight">\(  
where \)</span> m_{\rm e} $ is the mass of an electron.</p>
<hr class="docutils" />
<section id="unit-conversion-question-1">
<h3>Unit Conversion Question 1<a class="headerlink" href="#unit-conversion-question-1" title="Link to this heading">#</a></h3>
<p>How many atomic units of mass (a.u.) are there in one atomic mass unit (AMU)?<br />
In other words, convert <span class="math notranslate nohighlight">\( 1 \: \text{AMU} \)</span> to atomic units of mass.</p>
<details>
<summary><strong>💡 Click to reveal the worked solution</strong></summary>
<p>We are asked to convert from AMU to atomic units of mass (electron masses).</p>
<p>We start by noting the following values:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( 1 \: \text{AMU} = 1.66053906660 \times 10^{-27} \: \text{kg} \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( 1 \: \text{a.u.} = m_{\rm e} = 9.1093837015 \times 10^{-31} \: \text{kg} \)</span></p></li>
</ul>
<p>Now compute the ratio:</p>
<div class="math notranslate nohighlight">
\[
\frac{1 \: \text{AMU}}{1 \: \text{a.u.}} = \frac{1.66053906660 \times 10^{-27} \: \text{kg}}{9.1093837015 \times 10^{-31} \: \text{kg}} \approx 1822.888
\]</div>
<p>So,
$<span class="math notranslate nohighlight">\(
1 \: \text{AMU} \approx 1822.888 \: \text{a.u.}
\)</span>$</p>
</details>
<br>
<br>
Now if we compute the frequency using $k$ and $\mu$ both in atomic units, we will have a frequency in inverse atomic units of time.
<p><strong>Atomic Unit of Time</strong> is defined such that<br />
$<span class="math notranslate nohighlight">\(1 \: \text{a.u.} = 2.418884326509 \times 10^{-17} \: \text{s}\)</span>$</p>
<p>So the atomic unit of frequency is the inverse:</p>
<div class="math notranslate nohighlight">
\[
1 \: \text{a.u. of frequency} = \frac{1}{2.418884326509 \times 10^{-17} \: \text{s}} \approx 4.134137333649 \times 10^{16} \: \text{Hz}
\]</div>
<p>Thus, if we take our values of <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> in atomic units, we can compute the frequency in inverse seconds as</p>
<div class="math notranslate nohighlight">
\[ \nu \; \; (\text{in \; s}^{-1}) = \frac{1}{2 \pi} \sqrt{\frac{k}{\mu}} \times 4.134137333649 \times 10^{16} \]</div>
</section>
</section>
<section id="spectroscopic-units">
<h2>Spectroscopic units<a class="headerlink" href="#spectroscopic-units" title="Link to this heading">#</a></h2>
<p>Very commonly, vibrational spectra are reported using wavenumbers in inverse centimeters (<span class="math notranslate nohighlight">\(\bar{\nu} \; \text{in} \; \text{cm}^{-1}\)</span>) rather than frequency in Hertz (<span class="math notranslate nohighlight">\(\nu \; \text{in} \; \text{s}^-1\)</span>).  We can perform one
final manipulation from our frequency in seconds to get to wavenumbers, which is to divide by the speed of light in <span class="math notranslate nohighlight">\(\frac{\text{cm}}{\text{s}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \bar{\nu} = \frac{\nu}{c} \]</div>
<section id="question">
<h3>❓ Question<a class="headerlink" href="#question" title="Link to this heading">#</a></h3>
<p>What is the single <strong>conversion factor</strong> that allows you to convert a vibrational frequency expressed in atomic units of frequency (i.e., <span class="math notranslate nohighlight">\( \nu_{\text{a.u.}} \)</span>) directly into wavenumbers (in <span class="math notranslate nohighlight">\(\text{cm}^{-1} \)</span>)?</p>
<p>That is, find the value of the constant <span class="math notranslate nohighlight">\( \alpha \)</span> such that:</p>
<div class="math notranslate nohighlight">
\[
\bar{\nu} \; (\text{in} \; \text{cm}^{-1}) = \alpha \times \nu_{\text{a.u.}}
\]</div>
<details>
<summary><strong>💡 Click to reveal the worked solution</strong></summary>
<p>We begin by converting from atomic units of frequency to frequency in Hz (s<span class="math notranslate nohighlight">\(^{-1}\)</span>), and then to wavenumbers (cm<span class="math notranslate nohighlight">\(^{-1}\)</span>).</p>
<hr class="docutils" />
<p><strong>Step 1: Convert atomic units of frequency to Hz</strong></p>
<p>The atomic unit of time is:</p>
<div class="math notranslate nohighlight">
\[
1 \: \text{a.u.} = 2.418884326509 \times 10^{-17} \: \text{s}
\]</div>
<p>So the atomic unit of frequency is the inverse:</p>
<div class="math notranslate nohighlight">
\[
1 \: \text{a.u. of frequency} = \frac{1}{2.418884326509 \times 10^{-17} \: \text{s}} \approx 4.134137333649 \times 10^{16} \: \text{Hz}
\]</div>
<hr class="docutils" />
<p><strong>Step 2: Convert Hz to cm<span class="math notranslate nohighlight">\(^{-1}\)</span></strong></p>
<p>The speed of light is:</p>
<div class="math notranslate nohighlight">
\[
c = 2.99792458 \times 10^{10} \: \text{cm/s}
\]</div>
<p>So:</p>
<div class="math notranslate nohighlight">
\[
1 \: \text{Hz} = \frac{1}{2.99792458 \times 10^{10}} \: \text{cm}^{-1} \approx 3.335640951981 \times 10^{-11} \: \text{cm}^{-1}
\]</div>
<hr class="docutils" />
<p><strong>Step 3: Multiply the two conversions</strong></p>
<div class="math notranslate nohighlight">
\[
\alpha = \left(4.134137333649 \times 10^{16}\right) \times \left(3.335640951981 \times 10^{-11}\right)
\]</div>
<div class="math notranslate nohighlight">
\[
\alpha \approx 1378999.77 \: \text{cm}^{-1}
\]</div>
<hr class="docutils" />
<p>✅ <strong>Final Answer:</strong></p>
<div class="math notranslate nohighlight">
\[
\boxed{1 \: \text{a.u. of frequency} \approx 1378999.77 \: \text{cm}^{-1}}
\]</div>
<p>So you can use this constant to convert vibrational frequencies in atomic units directly into wavenumbers.</p>
</details>
<br>
<br>
**In the following markdown cell, we will assign these conversion constants for subsequent use in determining the fundamental of CO in wavenumbers.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># conversion from AMU to atomic units</span>
<span class="n">amu_to_au</span> <span class="o">=</span> <span class="mf">1822.888</span>

<span class="c1"># conversion from atomic units of frequency to wavenumbers in inverse centimeters</span>
<span class="n">au_to_inv_cm</span> <span class="o">=</span> <span class="mf">1378999.77</span>
</pre></div>
</div>
</div>
</div>
<p>In the next cell, we will set up the calculation of the fundamental frequency from our HF scan of the C-O stretch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># equilbirum bond length</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">hf_potential</span><span class="p">)</span>
<span class="n">x_e_au</span> <span class="o">=</span> <span class="n">x_au</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="c1"># k = d^2 V(x) / dx^2</span>
<span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">hf_potential</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">dx_au</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># define reduced mass of carbon monoxide first in AMU</span>
<span class="n">m_C</span> <span class="o">=</span> <span class="mf">12.0</span> <span class="c1"># mass of ^12C in AMU</span>
<span class="n">m_O</span> <span class="o">=</span> <span class="mf">15.99491461956</span> <span class="c1"># mass of ^16O in AMU</span>

<span class="c1"># reduced mass</span>
<span class="n">mu_AMU</span> <span class="o">=</span> <span class="p">(</span><span class="n">m_C</span> <span class="o">*</span> <span class="n">m_O</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m_C</span> <span class="o">+</span> <span class="n">m_O</span><span class="p">)</span>

<span class="c1"># convesion from AMU to atomic units of mass</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">mu_AMU</span> <span class="o">*</span> <span class="n">amu_to_au</span>

<span class="c1"># compute the frequency in atomic units</span>
<span class="n">freq_au</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">k</span> <span class="o">/</span> <span class="n">mu</span> <span class="p">)</span>

<span class="c1"># convert to wavenumbers</span>
<span class="n">au_to_wn</span> <span class="o">=</span> <span class="mf">1378999.77</span>
<span class="n">nu_bar</span> <span class="o">=</span> <span class="n">freq_au</span> <span class="o">*</span> <span class="n">au_to_wn</span>

<span class="c1"># harmonic potential</span>
<span class="n">harmonic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_au</span><span class="o">-</span><span class="n">x_e_au</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_au</span><span class="p">,</span> <span class="n">hf_potential</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CCSD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_au</span><span class="p">,</span> <span class="n">harmonic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;harmonic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">x_au</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_au</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;potential&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;C-O distance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let us check this result against a frequency calculation carried out using PySCF. When performing frequency analysis with a quantum chemistry package such as PySCF, we must be sure that the analysis is done at the equilibrium geometry for the molecule.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyscf.geomopt.geometric_solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyscf.hessian</span><span class="w"> </span><span class="kn">import</span> <span class="n">thermo</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyscf.hessian</span><span class="w"> </span><span class="kn">import</span> <span class="n">rhf</span> <span class="k">as</span> <span class="n">rhf_hessian</span>

<span class="c1"># Guess geometry of CO</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;C 0 0 0; O 0 0 1.2&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;cc-pvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="c1"># optimize geometry and print the result</span>
<span class="n">mol_eq</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">maxsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol_eq</span><span class="o">.</span><span class="n">tostring</span><span class="p">())</span>

<span class="c1"># prepare frequency calculation</span>
<span class="n">mf_eq</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_eq</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">hess</span> <span class="o">=</span> <span class="n">rhf_hessian</span><span class="o">.</span><span class="n">Hessian</span><span class="p">(</span><span class="n">mf_eq</span><span class="p">)</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="c1"># perform vibrational analysis on the Hessian</span>
<span class="n">freq_info</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span> <span class="n">hess</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now the frequency information from PySCF is stored in the dictionary <code class="docutils literal notranslate"><span class="pre">freq_info</span></code>, and we can access the fundamental frequency in wavenumbers
by using the key <code class="docutils literal notranslate"><span class="pre">'freq_wavenumber'</span></code>.  For most molecular systems, there will be more than one vibrational frequency, so this dictionary element is actually as list.<br />
For CO, we only have one frequency, so we will only be interested in element 0 of that list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pySCF_nu_bar</span> <span class="o">=</span> <span class="n">freq_info</span><span class="p">[</span><span class="s1">&#39;freq_wavenumber&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s1">&#39;PySCF Fundamental: </span><span class="si">{</span><span class="n">pySCF_nu_bar</span><span class="si">:</span><span class="s1">12.4f</span><span class="si">}</span><span class="s1"> cm^-1&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s1">&#39;Our Fundamental:   </span><span class="si">{</span><span class="n">nu_bar</span><span class="si">:</span><span class="s1">12.4f</span><span class="si">}</span><span class="s1"> cm^-1&#39;</span><span class="p">)</span>

<span class="n">Error</span> <span class="o">=</span> <span class="n">nu_bar</span> <span class="o">-</span> <span class="n">pySCF_nu_bar</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">F</span><span class="s1">&#39;Difference is:     </span><span class="si">{</span><span class="n">Error</span><span class="si">:</span><span class="s1">12.4f</span><span class="si">}</span><span class="s1"> cm^-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Our calculated value for <span class="math notranslate nohighlight">\(\nu\)</span> agrees reasonably well with that extracted from Psi4. The small differences could stem from two sources. First, we have evaluated the second derivative of the potential numerically, whereas Psi4 has evaluated the second derivative analytically. Second, we only estimated the equilibrium position from a potential energy scan with a resolution of only 0.05 Å, whereas Psi4 determined the equilibrium position from a geometry optimization with a much tighter resolution. Nonetheless, the two values agree quite well.</p>
</section>
<section id="transition-state-optimization">
<h3>Transition State Optimization<a class="headerlink" href="#transition-state-optimization" title="Link to this heading">#</a></h3>
<p>In addition to frequency information, vibrational analysis can be used to confirm whether a stationary point that has been identified via a geometry optimization is a minimum in all of the coordinates, a transition state, or some other high-order saddle point. Each of these cases can be differentiated by the number of <strong>imaginary</strong> frequencies that result from the vibrational analysis. Recall that the harmonic frequency is related to the square root of the second derivative of the potential along one of the normal modes. If the potential is a minimum along this coordinate, then the second derivative is positive, and the frequency is real (because the square root of a positive number is real-valued). If the potential is a maximum along this coordinate, then the second derivative is negative, and the frequency is imaginary (because the square root of a negative number is imaginary). Hence, if all of the frequencies obtained from the vibrational analysis are real, then the molecule is at a minimum all of coordinates. If there exists one and only one imaginary frequency, then the molecule is at a transition state. If there are multiple imaginary fruequencies, then the molecule is at some high-order saddle point that is not a transition state.</p>
<p>Consider the following simple isomerization reaction:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{HCN} \longleftrightarrow \text{HNC} \nonumber
\end{align}\]</div>
<p>The transition state for this reaction should be found at an H-C-N bond angle of roughly 70<span class="math notranslate nohighlight">\(\degree\)</span>. The following code will identify this transition state and perform a frequency analysis on the optimized structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set molecule</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">h</span>
<span class="s2">c 1 1.2</span>
<span class="s2">n 2 1.2 1 70.0</span>
<span class="s2">symmetry c1</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>   

<span class="c1"># set some options for psi4. </span>
<span class="c1"># don&#39;t forget to specify the transition state search</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span><span class="s1">&#39;basis&#39;</span><span class="p">:</span> <span class="s1">&#39;cc-pvdz&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;guess_mix&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="s1">&#39;uhf&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;opt_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ts&#39;</span><span class="p">})</span>

<span class="c1"># tell psi4 not to print any output to the screen</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">be_quiet</span><span class="p">()</span>

<span class="c1"># optimize geometry</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;scf&#39;</span><span class="p">)</span>

<span class="c1"># calculate harmonic frequencies</span>
<span class="n">en</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">frequency</span><span class="p">(</span><span class="s1">&#39;scf&#39;</span><span class="p">,</span> <span class="n">return_wfn</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># extract frequencies from the wave function</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wfn</span><span class="o">.</span><span class="n">frequencies</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The harmonic frequency for mode </span><span class="si">%i</span><span class="s1"> is </span><span class="si">%8.1f</span><span class="s1"> cm^-1&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that, when the frequencies are extracted from Psi4, the imaginary frequency actually appears as a negative number. This convention is used in other quantum chemistry packages as well. Since there is one and only one imaginary/negative frequency, we can conclude that the geometry optimization has identified a transition state.</p>
</section>
</section>
<section id="additional-considerations">
<h2>Additional Considerations<a class="headerlink" href="#additional-considerations" title="Link to this heading">#</a></h2>
<section id="boltzmann-distribution">
<h3>Boltzmann Distribution<a class="headerlink" href="#boltzmann-distribution" title="Link to this heading">#</a></h3>
<p>The probability that a vibrational state is populated at temperature, <span class="math notranslate nohighlight">\(T\)</span>, is governed by the <a class="reference external" href="https://en.wikipedia.org/wiki/Boltzmann_distribution">Boltzmann distribution</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_i = \frac{e^{-E_i/kT}}{\sum_j e^{-E_j/kT}}
\end{align}\]</div>
<p>Where <span class="math notranslate nohighlight">\(E_i\)</span> is the energy of the state, <span class="math notranslate nohighlight">\(k\)</span> is the Boltzmann constant, and the term in the denominator is the canonical partition function. The relative populations of two states is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\rho_i}{\rho_j} = e^{-(E_i-E_j)/kT}
\end{align}\]</div>
<p>Obviously, the relative populations depend on the temperature. The populations also depend on how closely-spaced the energy levels are. Recall that <span class="math notranslate nohighlight">\(\nu = \frac{1}{2\pi}\left ( \frac{k}{\mu} \right )\)</span>. As such, if <span class="math notranslate nohighlight">\(\mu\)</span> is small (e.g., H<span class="math notranslate nohighlight">\(_2\)</span>, HCl), then the spacing between levels will be large, and, at room temperature, the <span class="math notranslate nohighlight">\(v=0\)</span> state will be the most populated. On the other hand, if <span class="math notranslate nohighlight">\(\mu\)</span> is large (e.g., I<span class="math notranslate nohighlight">\(_2\)</span>), the spacing between levels is much smaller, and other vibrational states may become thermally accessible.</p>
<p>At low temperatures, the principal absorption band in a vibrational spectrum will correspond to the <span class="math notranslate nohighlight">\(v=0 \to v=1\)</span> transition. Depending on the temperature, the spectrum may also include <strong>hot bands</strong> corresponding to transitions from higher-energy vibrational states (e.g., <span class="math notranslate nohighlight">\(v=1 \to v=2\)</span>, etc.).</p>
</section>
<section id="real-molecular-vibrations">
<h3>“Real” Molecular Vibrations<a class="headerlink" href="#real-molecular-vibrations" title="Link to this heading">#</a></h3>
<p>The harmonic oscillator is a powerful model that is widely used for molecular vibrations among many other phenomena; however, it does not
capture several important features of real molecular vibrations.  Here we list some of the more important features of real molecular vibrations that the harmonic oscillator model misses.</p>
<ol class="arabic">
<li><p><strong>Overtones and Selection Rule Violations</strong></p>
<p>In addition to transitions that obey the selection rule, <span class="math notranslate nohighlight">\(\Delta v = \pm 1,\)</span> a vibrational spectrum may also include <strong>overtones</strong>, which correspond to transitions that violate this rule (e.g., <span class="math notranslate nohighlight">\(v=0 \to v=2\)</span> for the first overtone, <span class="math notranslate nohighlight">\(v=0 \to v=3\)</span> for the second overtone, etc.). Why are such features observed, if, mathematically, the selection rule suggests that these transitions should not occur? The reason is that the actual potential energy curve corresponding to a vibrational mode is not harmonic. Real molecular potentials are <strong>anharmonic</strong> - they deviate from the parabolic shape of the harmonic potential, typically becoming “softer” (less steep) at larger displacements. As such, the selection rules derived for the harmonic oscillator are not strict.</p>
</li>
<li><p><strong>Energy Level Spacing</strong></p>
<p>The energy levels of a quantum harmonic oscillator are evenly spaced. On the other hand, vibrational energy levels in a real molecule become more closely spaced as the vibrational quantum number increases. This decreasing spacing occurs because real molecular potentials deviate from the parabolic harmonic form, becoming increasingly flat at larger displacements. Hence, the QHO model is better suited to the description of low-energy vibrational states than high-energy ones.</p>
</li>
<li><p><strong>Hot Band Transitions</strong></p>
<p>Given that energy levels become more closely spaced as the vibrational quantum number increases, transitions like <span class="math notranslate nohighlight">\(v = 0 \to v = 1\)</span> will be associated with a larger frequency than transitions like <span class="math notranslate nohighlight">\(v = 1 \to v = 2\)</span> in real molecules (they would be identical in the harmonic oscillator model). Hence, in real molecules we observe distinct <strong>hot band</strong> transitions that correspond to transitions between <span class="math notranslate nohighlight">\(v \to v'\)</span> where <span class="math notranslate nohighlight">\(v &gt; 0\)</span> and <span class="math notranslate nohighlight">\(v' = v + 1\)</span>. In this nomenclature, the <span class="math notranslate nohighlight">\(v = 1 \to v = 2\)</span> transition is called the first hot band, the <span class="math notranslate nohighlight">\(v = 2 \to v = 3\)</span> transition is called the second hot band, and so on. Hot bands become more prominent at higher temperatures when higher vibrational states are thermally populated, which is why they’re called “hot” bands.</p>
</li>
<li><p><strong>Dissociation and Bound States</strong></p>
<p>The QHO model predicts that there are infinitely many <strong>bound</strong> vibrational states, with quantized energies. In a real molecular system, however, the vibrational energy levels <strong>converge</strong> toward the dissociation limit for the molecule. Beyond this point, there exists a continuum of <strong>unbound</strong> states. This convergence occurs because the anharmonic potential becomes increasingly flat as the bond stretches toward the breaking point. A different way of saying this is that real molecules can dissociate after the atoms stretch beyond the point of bond breaking, but the harmonic oscillator does not dissociate.</p>
</li>
</ol>
<p><strong>Mathematical Description of Anharmonicity</strong>
In the next section, we will the Morse oscillator model, which is one particular anharmonic oscillator model that has an analytical solution.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="morse-oscillator-model">
<h1>Morse Oscillator model<a class="headerlink" href="#morse-oscillator-model" title="Link to this heading">#</a></h1>
<p>The Morse oscillator model will lead to all of the features mentioned above (overtones, energy levels that become more closely spaced, distinct hot bands, dissociation).  After introducing the model, we will compare the potentials to the harmonic potential and the {\it ab initio} potential for CO, and we will compare the estimates of the fundamental transition (<span class="math notranslate nohighlight">\(v=0 \rightarrow v=1\)</span>) for CO as obtained by the harmonic and Morse oscillator models.</p>
<p>Within the Morse model, the vibrational Hamiltonian can be written as
\begin{equation}
\hat{H}<em>{vib} = -\frac{\hbar^2}{2\mu} \frac{d^2}{dr^2} + V</em>{Morse}(r), \tag{1}
\end{equation}
where
\begin{equation}
V_{Morse}(r) = D_e \left(1 - e^{-\beta(r-r_{eq})} \right)^2. \tag{2}
\end{equation}</p>
<p>The Morse parameters for <span class="math notranslate nohighlight">\({\rm CO}\)</span> are as follows: <span class="math notranslate nohighlight">\(D_e = 11.225 \: {\rm eV}\)</span>, <span class="math notranslate nohighlight">\(r_{eq} = 1.1283 \: {\rm Ang.}\)</span>, <span class="math notranslate nohighlight">\(\beta = 2.5944 \: {\rm Ang.}^{-1}\)</span>,
and <span class="math notranslate nohighlight">\(\mu = 6.8606 \: {\rm amu}\)</span>.</p>
<p>The exact energy eigenvalues for Equation (1) can be written as
\begin{equation}
E_n = \hbar \omega \left( \left(n+ \frac{1}{2} \right) - \chi_e \left(n+ \frac{1}{2} \right)^2 \right) \tag{3}
\end{equation}
where
\begin{equation}
\omega = \sqrt{\frac{2D_e \beta^2}{\mu}} \tag{4}
\end{equation}
and
\begin{equation}
\chi_e = \frac{\hbar \omega}{4 D_e}. \tag{5}
\end{equation}</p>
<p>We can see these as subsequent corrections to the harmonic oscillator model, or alternatively, we can view them as approximations to the Morse model.</p>
<p>We will use the Morse potential as a model for the “exact” interatomic potential, and we will approximate this potential by different orders of a Taylor expansion: including up to quadratic (which is the harmonic oscillator approximation), cubic, and quartic terms.  The harmonic and Morse potentials are exactly solvable, and the eigenfunctions and eigenvalues of the vibrational Hamiltonian with cubic and quartic potentials can be approximated using perturbation theory.  Therefore, we will
compare the fundamental  transition computed exactly for harmonic and Morse potentials, and approximately at 2nd order of perturbation theory for cubic and quartic potentials to see the impact of various levels of potential truncation and approximation.</p>
<p>Within the Morse model, the vibrational Hamiltonian can be written as
\begin{equation}
\hat{H}<em>{vib} = -\frac{\hbar^2}{2\mu} \frac{d^2}{dr^2} + V</em>{Morse}(r), \tag{1}
\end{equation}
where
\begin{equation}
V_{Morse}(r) = D_e \left(1 - e^{-\beta(r-r_{eq})} \right)^2. \tag{2}
\end{equation}</p>
<p>The Morse parameters for <span class="math notranslate nohighlight">\({\rm CO}\)</span> are as follows: <span class="math notranslate nohighlight">\(D_e = 11.225 \: {\rm eV}\)</span>, <span class="math notranslate nohighlight">\(r_{eq} = 1.1283 \: {\rm Ang.}\)</span>, <span class="math notranslate nohighlight">\(\beta = 2.5944 \: {\rm Ang.}^{-1}\)</span>,
and <span class="math notranslate nohighlight">\(\mu = 6.8606 \: {\rm amu}\)</span>.</p>
<p>The exact energy eigenvalues for Equation (1) can be written as
\begin{equation}
E_n = \hbar \omega \left( \left(n+ \frac{1}{2} \right) - \chi_e \left(n+ \frac{1}{2} \right)^2 \right) \tag{3}
\end{equation}
where
\begin{equation}
\omega = \sqrt{\frac{2D_e \beta^2}{\mu}} \tag{4}
\end{equation}
and
\begin{equation}
\chi_e = \frac{\hbar \omega}{4 D_e}. \tag{5}
\end{equation}</p>
<p>The Morse potential can be approximated by a Taylor expansion as follows:
\begin{equation}
V_T(r) = \sum_{n=0}^{\infty} \frac{ f^{(n)}(r_{eq})}{n!} \left(r-r_{eq} \right)^n, \tag{6}
\end{equation}
where <span class="math notranslate nohighlight">\(f^{(n)}(r_{eq})\)</span> is the <span class="math notranslate nohighlight">\(n^{th}\)</span>-order derivative of the Morse potential evaluated at the equilibrium bondlength, e.g. <span class="math notranslate nohighlight">\(f^{(1)}(r_{eq}) = \frac{d}{dr}V_{Morse}(r_{eq}).\)</span></p>
<p>We will define the Harmonic approximation to the potential as
\begin{equation}
V_H(r) =  \frac{ f^{‘’}(r_{eq})}{2} \left(r-r_{eq} \right)^2 = \frac{1}{2} k \left(r-r_{eq} \right)^2 \tag{7}
\end{equation}
the cubic approximation to the potential as
\begin{equation}
V_C(r) =  V_H(r) + \frac{ f^{‘’’}(r_{eq})}{6} \left(r-r_{eq} \right)^3 = V_H(r) + \frac{1}{6} g \left(r-r_{eq} \right)^3,   \tag{8}
\end{equation}
and the quartic approximation as
\begin{equation}
V_Q(r) =  V_C(r) + \frac{ f^{‘’’’}(r_{eq})}{24} \left(r-r_{eq} \right)^4 =  V_C(r) + \frac{1}{24}h(r-r_{eq})^4.  \tag{9}
\end{equation}</p>
<p>Because we are using the Morse model as the “exact” interatomic potential in this notebook, we can compute these derivatives at <span class="math notranslate nohighlight">\(r_{eq}\)</span> analytically:
\begin{align}
k = 2 D_e \beta^2 \
g = -6 D_e \beta^3 \tag{10} \
h = 14 D_e \beta^4.
\end{align}
However, in general we do not have an analytical form for the interatomic potential, so we must rely on numerical derivatives of the potential evaluated at the <span class="math notranslate nohighlight">\(r_{eq}\)</span>.  In the context of interatomic potentials computed by quantum chemistry methods (e.g. CCSD(T)), one must first identify the equilibrium geometry, and then compute derivatives by taking a number of single point calculations along all displacement coordinates to compute differences among.  We will write the explicit expression for the second derivative using centered finite differences along the one displacement coordinate relevant for our <span class="math notranslate nohighlight">\({\rm CO}\)</span> molecule:
\begin{equation}
k=\frac{V_{Morse}(r_{eq}+\Delta r)-2V_{Morse}(r_{eq})+V_{Morse}(r_{eq}-\Delta r)}{\Delta r^2}+\mathcal O (\Delta r^2) \tag{11}
\end{equation}
where <span class="math notranslate nohighlight">\(\Delta r\)</span> represents a small displacement along the coordinate <span class="math notranslate nohighlight">\(r\)</span>.  Higher-order derivatives can also be computed, but will require larger numbers of displacements and therefore more energy evaluations by your quantum chemistry method.  Expressions for higher-order derivatives along a single coordinate can be found <a class="reference external" href="https://sameradeeb.srv.ualberta.ca/introduction-to-numerical-analysis/numerical-differentiation/#centred-finite-difference9">here</a>. Note that the number of displacement coordinates <span class="math notranslate nohighlight">\(N\)</span> grows linearly with the number of atoms, and that the number of displacements required to form the <span class="math notranslate nohighlight">\(n^{{\rm th}}\)</span>-order approximation to the potential grows as <span class="math notranslate nohighlight">\(N^n\)</span>.</p>
<section id="perturbation-theory">
<h2>Perturbation Theory<a class="headerlink" href="#perturbation-theory" title="Link to this heading">#</a></h2>
<p>We can compute the exact vibrational transition energies for the Morse oscillator and the Harmonic oscillator using Equation (3), where the Harmonic oscillator transition energies come from Equation (3) with <span class="math notranslate nohighlight">\(\chi_e = 0\)</span>.  However, the transition energies when the potential is approximated as <span class="math notranslate nohighlight">\(V_C(r)\)</span> or <span class="math notranslate nohighlight">\(V_Q(r)\)</span> must be approximated.  We will illustrate the use of Perturbation Theory approximate these transition energies.</p>
<p>Here we will consider the Hamiltonian
\begin{equation}
\hat{H}<em>{vib} = -\frac{\hbar^2}{2\mu} \frac{d^2}{dr^2} + V</em>{H}(r) + V’(r) = \hat{H}_0 + V’(r) \tag{12},
\end{equation}
where <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> is exactly solved by the Harmonic oscillator energy eigenfunctions and eigenvalues (<span class="math notranslate nohighlight">\(\psi^{(0)}_n(r)\)</span>, <span class="math notranslate nohighlight">\(E^{(0)}_n\)</span>), and <span class="math notranslate nohighlight">\(V'(r)\)</span> is the perturbation which will take the form of either
<span class="math notranslate nohighlight">\(V'(r) = \frac{1}{6}g(r-r_{eq})^3\)</span> or <span class="math notranslate nohighlight">\(V'(r) = \frac{1}{6}g(r-r_{eq})^3 + \frac{1}{24}h(r-r_{eq})^4\)</span> in the cubic and quartic approximations, respectively.</p>
<p>We can calculate the energy of state <span class="math notranslate nohighlight">\(n\)</span> at 2nd order of perturbation theory as follows:
\begin{equation}
E_n = E_n^{(0)} +  \langle \psi_n^{(0)} | V’(r) | \psi_n^{(0)} \rangle + \sum_{k \neq n} \frac{|\langle \psi_k^{(0)} | V’(r) | \psi_n^{(0)}|^2}{E_n^{(0)}-E_k^{(0)}}. \tag{13}
\end{equation}</p>
<p>Recall that for the zeroth-order functions have the form
\begin{align}
\psi_n^{(0)}(r) &amp;= \sqrt{\frac{1}{2^n n!}} \cdot \left(\frac{\alpha}{\pi} \right)^{1/4} \cdot H_n \left(\sqrt{\alpha} r \right) \cdot {\rm exp}\left(\frac{-\alpha }{2} r^2 \right) \
\alpha &amp;= \frac{\mu \omega}{\hbar} \
\omega &amp;= \sqrt{\frac{k}{\mu}}
\end{align}</p>
</section>
<section id="approach">
<h2>Approach<a class="headerlink" href="#approach" title="Link to this heading">#</a></h2>
<p>We will compute the fundamental transition (<span class="math notranslate nohighlight">\(E_1 - E_0\)</span>) using the following approaches:</p>
<ol class="arabic simple">
<li><p>Harmonic approximation: <span class="math notranslate nohighlight">\(E_1 - E_0 = \hbar \omega\)</span></p></li>
<li><p>Exact solution for Morse Hamiltonian: <span class="math notranslate nohighlight">\(E_1 - E_0 = \hbar \omega (1 - 2\chi_e)\)</span></p></li>
<li><p>Evaluation of Eq. (13) for <span class="math notranslate nohighlight">\(n=0\)</span> and <span class="math notranslate nohighlight">\(n=1\)</span> utilizing the cubic contribution for <span class="math notranslate nohighlight">\(V'(r)\)</span></p></li>
<li><p>Evaluation of Eq. (13) for <span class="math notranslate nohighlight">\(n=0\)</span> and <span class="math notranslate nohighlight">\(n=1\)</span> utilizing the cubic and quartic contribution for <span class="math notranslate nohighlight">\(V'(r)\)</span></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/lecture_notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="translation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 3: Translational Motion</p>
      </div>
    </a>
    <a class="right-next"
       href="rotation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 5: Angular Momentum, and Rotational Motion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Chapter 4: Vibrational Motion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-harmonic-potential">The Harmonic Potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-classical-harmonic-oscillator">One-Dimensional Classical Harmonic Oscillator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-quantum-harmonic-oscillator">One-Dimensional Quantum Harmonic Oscillator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#power-series-solution-to-the-schrodinger-equation">Power Series Solution to the Schrödinger Equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-boundary-conditions">Applying Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-energy-eigenvalue-expression">Final Energy Eigenvalue Expression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qho-wave-functions">QHO Wave Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tunneling-and-the-correspondence-principle">Tunneling and the Correspondence Principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selection-rules">Selection Rules</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fermi-s-golden-rule">Fermi’s Golden Rule</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fermi-s-golden-rule-for-molecular-vibrations">Fermi’s Golden Rule for Molecular Vibrations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connections-to-computational-chemistry">Connections to Computational Chemistry</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic-frequency-analysis">Harmonic Frequency Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#important-points-about-units">Important Points about Units</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-conversion-question-1">Unit Conversion Question 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectroscopic-units">Spectroscopic units</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question">❓ Question</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-state-optimization">Transition State Optimization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-considerations">Additional Considerations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boltzmann-distribution">Boltzmann Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#real-molecular-vibrations">“Real” Molecular Vibrations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#morse-oscillator-model">Morse Oscillator model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perturbation-theory">Perturbation Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach">Approach</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jay Foley
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>