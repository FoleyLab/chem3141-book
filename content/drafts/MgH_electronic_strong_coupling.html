
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Polaritonic chemistry for a simple diatomic molecule strongly interacting with light &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/drafts/MgH_electronic_strong_coupling';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    5. Hydrogen Atom
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture Notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/qm_postulates_two_level.html">Chapter 1: Introduction to Quantum Phenomena</a></li>




<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/qm_postulates.html">Chapter 2: The Postulates Revisited</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/translation.html">Chapter 3: Translational Motion</a></li>


<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/vibration.html">Chapter 4: Vibrational Motion</a></li>

<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/rotation.html">Chapter 5: Angular Momentum, and Rotational Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/hydrogen.html">Chapter 6: The Hydrogen Atom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/variation.html">Chapter 7: The Variation Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/perturbation.html">Chapter 8: Perturbation Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture_notes/SphHarm_visualize.html">Visualizing Spherical harmonics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Problem Sets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../problem_sets/ps_1.html">Problem Set 1</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Sets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../computational_sets/note05.html">Additional Notes on Spin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computational_sets/Spin_one_half.html">Computational Set 1: Introduction to Spin 1/2</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../resources/formula_sheet.html">Useful Formulae</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note01.html">Hydrogenlike atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note03.html">Atomic orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/note05.html">Additional Notes on Spin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/spin_background.html">Spin</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/FoleyLab/chem3141-book/blob/main/content/drafts/MgH_electronic_strong_coupling.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FoleyLab/chem3141-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FoleyLab/chem3141-book/issues/new?title=Issue%20on%20page%20%2Fcontent/drafts/MgH_electronic_strong_coupling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/drafts/MgH_electronic_strong_coupling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Polaritonic chemistry for a simple diatomic molecule strongly interacting with light</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supplementary-learning-objective">Supplementary learning objective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-molecular-polariton">What is a molecular polariton?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-system">Model system</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#procedure">Procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tdscf-excitations-method-and-dictionary">The tdscf_excitations method and dictionary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-rabi-model-hamiltonian">Building the Rabi model Hamiltonian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-fitting-a-spline">Step 1: Fitting a spline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-building-the-rabi-hamiltonian">Step 2: Building the Rabi Hamiltonian</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation">Derivation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-dirac-bra-ket-notation">Review of Dirac Bra-Ket notation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-rules-for-the-projection-operators-for-electronic-states">Review of rules for the projection operators for electronic states</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-combine-these-rules-to-evaluate-the-following">Question 1: Combine these rules to evaluate the following:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-combine-the-molecular-and-photonic-creation-and-annihilation-operator-rules-to-derive-elements-of-the-hamiltonian-matrix">Question 2: Combine the molecular and photonic creation and annihilation operator rules to derive elements of the Hamiltonian matrix</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;MgH+ Polaritonic Potential Energy Surfaces&quot;&quot;&quot;</span>

<span class="n">__authors__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ruby Manderna, Lane Tolley, Figen Suchanek, Jonathan J. Foley, &quot;</span><span class="p">]</span>
<span class="n">__email__</span>   <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rmandern@uncc.edu, ptolley1@uncc.edu, suchanekf@wpunj.edu, jfoley19@uncc.edu, &quot;</span><span class="p">]</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ruby Manderna, Lane Tolley, Figen Suchanek, Jonathan J. Foley&quot;</span><span class="p">]</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;(c) 2008-2020, The Psi4Education Developers&quot;</span>
<span class="n">__license__</span>   <span class="o">=</span> <span class="s2">&quot;BSD-3-Clause&quot;</span>
<span class="n">__date__</span>      <span class="o">=</span> <span class="s2">&quot;2021-02-11&quot;</span>


<span class="c1">### Import libraries to be used throughout</span>
<span class="c1"># basic psi4 library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psi4</span>
<span class="c1"># pyplot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1"># numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="c1"># scipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterpolatedUnivariateSpline</span>
<span class="c1"># linear algebra package from numpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>
<span class="c1"># time-dependent scf library from psi4 for computing excited states and transition dipole moments</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">psi4.driver.procrouting.response.scf_response</span><span class="w"> </span><span class="kn">import</span> <span class="n">tdscf_excitations</span>
<span class="c1">#from matplotlib import pyplot as plt</span>


<span class="n">_expected_lambda</span> <span class="o">=</span> <span class="mf">309.9604960590</span>
<span class="n">_expected_V</span> <span class="o">=</span> <span class="mf">853.9819621540001</span>
<span class="n">_expected_Eg_val</span> <span class="o">=</span> <span class="o">-</span><span class="mf">200.33018284449852</span>
<span class="n">_expected_Ee_val</span> <span class="o">=</span> <span class="o">-</span><span class="mf">200.18141088127473</span>
<span class="n">_expected_tdm_val</span> <span class="o">=</span> <span class="mf">2.1837588170011095</span>
<span class="n">_expected_deltaE_eV</span> <span class="o">=</span> <span class="mf">4.04823389128266</span>

<span class="n">_expected_H_Rabi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">2.00330183e+02</span><span class="p">,</span>  <span class="mf">0.00000000e+00</span><span class="p">,</span>  <span class="mf">0.00000000e+00</span><span class="p">],</span>
                            <span class="p">[</span> <span class="mf">0.00000000e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.00181411e+02</span><span class="p">,</span>  <span class="mf">6.55127645e-03</span><span class="p">],</span>
                            <span class="p">[</span> <span class="mf">0.00000000e+00</span><span class="p">,</span>  <span class="mf">6.55127645e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.00181411e+02</span><span class="p">]])</span>




<span class="n">n_geoms</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">_expected_rs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_geoms</span><span class="p">):</span>
    <span class="n">_expected_rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.1</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span>
    
<span class="n">_expected_Eg_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">200.25367486</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.30835506</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.34317863</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.36433935</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.37609145</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.38129671</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.38191454</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.37932951</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.37454644</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.36830617</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.36115804</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.35350922</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.34566042</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.33783194</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.33018284</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.32282542</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.31583611</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.30926385</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.30313622</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.29746454</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.29224756</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.28747484</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.28312913</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.27918888</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.27562959</span><span class="p">])</span>

<span class="n">_expected_Ee_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">200.01466921</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.07666894</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.11946658</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.14880628</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.16864693</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.18166725</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.18969265</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.19402683</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.19564857</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.19531169</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.19361608</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.19103812</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.18795606</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.18466878</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.18141086</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.17835946</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.1756464</span><span class="p">,</span>  <span class="o">-</span><span class="mf">200.17336483</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.17157804</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.17032261</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">200.16961004</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.16943208</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.16976269</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.17056035</span><span class="p">,</span> <span class="o">-</span><span class="mf">200.17177513</span><span class="p">])</span>

<span class="n">_expected_tdm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.35621453</span><span class="p">,</span> <span class="mf">1.3765366</span><span class="p">,</span>  <span class="mf">1.41027036</span><span class="p">,</span> <span class="mf">1.45492843</span><span class="p">,</span> <span class="mf">1.50865744</span><span class="p">,</span> <span class="mf">1.56955814</span><span class="p">,</span>
 <span class="mf">1.63570115</span><span class="p">,</span> <span class="mf">1.70523104</span><span class="p">,</span> <span class="mf">1.7765825</span><span class="p">,</span>  <span class="mf">1.84846023</span><span class="p">,</span> <span class="mf">1.91980311</span><span class="p">,</span> <span class="mf">1.98972481</span><span class="p">,</span>
 <span class="mf">2.05748777</span><span class="p">,</span> <span class="mf">2.12237872</span><span class="p">,</span> <span class="mf">2.18375882</span><span class="p">,</span> <span class="mf">2.24092718</span><span class="p">,</span> <span class="mf">2.29313572</span><span class="p">,</span> <span class="mf">2.33957417</span><span class="p">,</span>
 <span class="mf">2.37942975</span><span class="p">,</span> <span class="mf">2.41195173</span><span class="p">,</span> <span class="mf">2.43656045</span><span class="p">,</span> <span class="mf">2.45296981</span><span class="p">,</span> <span class="mf">2.46122806</span><span class="p">,</span> <span class="mf">2.46173081</span><span class="p">,</span>
 <span class="mf">2.45518776</span><span class="p">])</span>

<span class="n">psi4</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">set_output_file</span><span class="p">(</span><span class="s1">&#39;output.dat&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="polaritonic-chemistry-for-a-simple-diatomic-molecule-strongly-interacting-with-light">
<h1>Polaritonic chemistry for a simple diatomic molecule strongly interacting with light<a class="headerlink" href="#polaritonic-chemistry-for-a-simple-diatomic-molecule-strongly-interacting-with-light" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Students will be able to define a molecular polariton</p></li>
<li><p>Students will be able to explain how forming molecular polaritons can modify chemical structure and reactivity</p></li>
<li><p>Students will be able to use quantum chemistry calculations to parameterize a Rabi model Hamiltonian for a molecular polariton</p></li>
<li><p>Students will be able to construct polaritonic potential energy surfaces using the Rabi model</p></li>
<li><p>Students will be able to estimate a qualitative relationship between the coupling strength and splitting between polaritonic potential energy surfaces</p></li>
</ul>
</section>
<section id="supplementary-learning-objective">
<h2>Supplementary learning objective<a class="headerlink" href="#supplementary-learning-objective" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Students will be able to apply the rules of 2nd quantized operators to derive the Rabi Hamiltonian matrix</p></li>
</ul>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<p>Nanostructured materials can be designed to strongly confine light down to nanoscale dimensions, which
greatly enhances the energy density of light and increases its interaction with molecular excitations.
When molecules through their excitations <em>strongly</em> interact with light, new quantum states, called polariton states, emerge that have
properties of light and of matter.</p>
<p>Consider the image below that shows the MgH+ molecule strongly
interacting with a nanoconfined photon trapped between two parallel mirrors (aka a cavity). This cavity
confines a photon with electric field <span class="math notranslate nohighlight">\(\vec{E}\)</span> aligned with the transition dipole moment <span class="math notranslate nohighlight">\(\vec{\mu}_{i\rightarrow f}\)</span>  connecting the ground to first singlet excited state of MgH+.  When the energy of the trapped photon (<span class="math notranslate nohighlight">\(\hbar \omega\)</span>) matches this excitation energy in a particular region of the MgH+ potential energy surface, energy can be
rapidly exchanged between the molecular excitation and the cavity.  We can think of this exchange as cylcing between  the molecule absorbing the trapped photon and becoming excited, and relaxing back to the ground-state and emitting the a photon which becomes trapped in the cavity.  When this cycling is rapid, as is the case when the interaction
is strong, the cycling of energy makes it impossible to distinguish between the quantum state of the excited molecule and the quantum state of the photon localized in the cavity.  Rather, we think of this situation as a hybrid state that is part light part matter, and we call this state a polariton.  One fascinating feature of molecular polaritons
is that their potential energy surfaces may be dramatically different than the potential energy surfaces of their
molecular constituents.  Consequently, new and different chemical reactivity may be realized by putting molecules in cavities!  This notebook will explore the reshaping of the potential energy surfaces of the simple diatomic
MgH+ by placing it in a cavity.</p>
<img src="data/MgH_polariton.png" width=300 height=300 />
<section id="what-is-a-molecular-polariton">
<h3>What is a molecular polariton?<a class="headerlink" href="#what-is-a-molecular-polariton" title="Link to this heading">#</a></h3>
<p>A <em>molecular polariton</em> can be understood as quantum state that mixes the quantum states of a photon and the quantum states of a molecule.  The two criteria for forming a molecular polariton are that</p>
<ol class="arabic simple">
<li><p>The photon energy should match the transition energy between molecular quantum states</p></li>
<li><p>The energy scale of the interaction between the photon and the molecular transition should be large compared to dissipation energy scales in the individual molecular and photonic systems</p></li>
</ol>
<p><strong>Question 1</strong> Let’s consider the first criteria for electronic transitions in the MgH+ system.  The the relevant electronic transition (ground to first singlet excited state) energy is on the order of 4 eV.  What photon wavelength can be used to form a molecular polariton with this electronic transition assuming a transition energy of 4 eV?</p>
<p><em>Answer goes here!</em></p>
<p><em>Hint:</em> <span class="math notranslate nohighlight">\( E = \hbar \omega \)</span> and <span class="math notranslate nohighlight">\( \lambda_p = \frac{2\pi c}{\omega} \)</span> and for the conversion between atomic units of length and nanometers, <span class="math notranslate nohighlight">\(1 \; {\rm nm} = 18.8972 \: {\rm a.u.}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transition_energy</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="c1"># g -&gt; e transition energy in eV</span>

<span class="n">hbar_eV_s</span> <span class="o">=</span> <span class="mf">6.582119569e-16</span> <span class="c1"># -&gt; hbar in eV * s</span>

<span class="n">c_SI</span> <span class="o">=</span> <span class="mi">299792458</span> <span class="c1"># -&gt; speed of light in m / s</span>

<span class="n">m_to_nm</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="c1"># -&gt; conversion between meters and nanometers</span>

<span class="c1"># ==&gt; Write code to compute wavelength in meters here &lt;==</span>
<span class="n">lambda_m</span> <span class="o">=</span> <span class="n">hbar_eV_s</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">c_SI</span> <span class="o">/</span> <span class="n">transition_energy</span>

<span class="c1"># ==&gt; Write code to convert wavelength from meters to nanometers here... store in variable lambda_nm &lt;==</span>
<span class="n">lambda_nm</span> <span class="o">=</span> <span class="n">lambda_m</span> <span class="o">*</span> <span class="n">m_to_nm</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The photon wavelength is </span><span class="si">{</span><span class="n">lambda_nm</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> nm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The photon wavelength is 309.960 nm
</pre></div>
</div>
</div>
</div>
<p>Let’s consider the second criteria that the interaction energy scale must be large compared to the dissipation energy scales of the individual molecular and photonic system. Specifically, we have the criteria
$<span class="math notranslate nohighlight">\( 4g &gt; \gamma \tag{1}\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(g\)</span> represents the interaction energy rate between the molecular transition and the photon and <span class="math notranslate nohighlight">\(\gamma\)</span> represents the dissipation rate of the molecular excitation and the photon.  Usually the dissipation rate of the photon is much faster than the dissipation of the molecular excitation, so <span class="math notranslate nohighlight">\(\gamma\)</span> can be approximated as the inverse of the lifetime of the occupation of the photon in the cavity.</p>
<p>We can define <span class="math notranslate nohighlight">\(g\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[ g = {\bf A} \cdot \mu_{ge}, \tag{2}\]</div>
<p>where <span class="math notranslate nohighlight">\({\bf A}\)</span> is related to the electric field of the photon and
has a magnitude defined as
$<span class="math notranslate nohighlight">\( A = \sqrt{\frac{\omega}{2 \epsilon_0 V}}, \tag{3}\)</span><span class="math notranslate nohighlight">\(
\)</span>\mu_{eg}<span class="math notranslate nohighlight">\( is the transition dipole moment associated with the electronic transition, \)</span>\omega<span class="math notranslate nohighlight">\( is the
frequency of the photon, \)</span>\epsilon_0<span class="math notranslate nohighlight">\( is the permittivity of vacuum, and
\)</span>V<span class="math notranslate nohighlight">\( represents the volume of the cavity that confines the photon (and molecule).  Here we can
see that for a given value of the transition dipole moment, increasing the confinement of the photon by decreasing \)</span>V<span class="math notranslate nohighlight">\( increases the interaction energy scale by increasing the fundamental coupling strength \)</span>A$.</p>
<p><strong>Question 2</strong>
If we can assume that (in atomic units) <span class="math notranslate nohighlight">\(\mu_{ge} = 1\)</span>, <span class="math notranslate nohighlight">\(\omega = 0.1469\)</span>, and <span class="math notranslate nohighlight">\(\gamma = 0.0016\)</span>, what is the value of <span class="math notranslate nohighlight">\(A\)</span> required to satisfy <span class="math notranslate nohighlight">\( 4g = \gamma \)</span>?  Store this value in the variable <code class="docutils literal notranslate"><span class="pre">A_au</span></code>.</p>
<p><strong>Note</strong> Although both <span class="math notranslate nohighlight">\({\bf A}\)</span> and <span class="math notranslate nohighlight">\(\mu_{eq}\)</span> are technically vector quantities, in this excercise we are considering only the component along the <span class="math notranslate nohighlight">\(z\)</span> axis, so we will treat them as scalars from here on out!</p>
<p><em>Answer goes here!</em></p>
<p><em>Note</em> In atomic units, <span class="math notranslate nohighlight">\(\frac{1}{\epsilon_0} = 4 \pi\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_ge_au</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># -&gt; transition dipole moment in atomic units </span>

<span class="n">gamma_au</span> <span class="o">=</span> <span class="mf">0.0016</span> <span class="c1"># -&gt; photon dissipation rate in atomic units</span>

<span class="n">omega_au</span> <span class="o">=</span> <span class="mf">0.1469</span> <span class="c1"># -&gt; photon frequency in atomic units</span>

<span class="n">au_to_nm</span> <span class="o">=</span> <span class="mf">0.0529</span> <span class="c1"># -&gt; conversion factor for atomic units of length to nanometers</span>

<span class="c1"># ==&gt; Write code to compute A_au (in atomic units) here &lt;== </span>
<span class="n">A_au</span> <span class="o">=</span> <span class="n">gamma_au</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">mu_ge_au</span><span class="p">)</span>


<span class="c1"># ==&gt; Pre-written: Convert A to volume in atomic units to volume in nm^3 &lt;==</span>
<span class="n">V_au</span> <span class="o">=</span> <span class="n">omega_au</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">A_au</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">V_nm</span> <span class="o">=</span> <span class="n">V_au</span> <span class="o">*</span> <span class="n">au_to_nm</span> <span class="o">**</span> <span class="mi">3</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The magnitude of A is </span><span class="si">{</span><span class="n">A_au</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1"> atomic units&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The cavity volume is </span><span class="si">{</span><span class="n">V_nm</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> nm^3&#39;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">V_nm</span><span class="p">,</span> <span class="n">_expected_V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The magnitude of A is 4.000e-04 atomic units
The cavity volume is 853.982 nm^3
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="model-system">
<h2>Model system<a class="headerlink" href="#model-system" title="Link to this heading">#</a></h2>
<p>We will consider the diatomic cation MgH+ in a cavity chosen such that it can trap a photon with a
frequency of approximately <span class="math notranslate nohighlight">\(\hbar \omega = 4.0\)</span> eV.
We will compute the singlet ground state and first singlet excited state potential energy surfaces along the
Mg-H+ stretch coordinate <span class="math notranslate nohighlight">\(R\)</span> using density functional theory (DFT) and time-dependent density functional theory (TDDFT), respectively.  DFT provides an efficient method for computing the ground-state energy of a quantum mechanical system using the electron density (rather than the wavefunction) as the primary variable, and TDDFT provides an efficient method for estimating the energies and properties of excited-states starting from the DFT ground state.    We denote the ground
state ket as <span class="math notranslate nohighlight">\(|g\rangle\)</span> with an associated energy eigenvalue <span class="math notranslate nohighlight">\(E_g(R)\)</span>, and the excited-state <span class="math notranslate nohighlight">\(|e\rangle\)</span>
with associated energy eigenvalue <span class="math notranslate nohighlight">\(E_e(R)\)</span> where <span class="math notranslate nohighlight">\(R\)</span> is the bondlength.  The transition dipole
moment between <span class="math notranslate nohighlight">\(|g\rangle\)</span> and <span class="math notranslate nohighlight">\(|e\rangle\)</span> will also be computed using TDDFT, yielding <span class="math notranslate nohighlight">\(\mu_{ge}(R)\)</span>.
While
the transition dipole moment and the electric field are vector quantities, in this case <span class="math notranslate nohighlight">\(\mu_{ge}(R)\)</span> is oriented along the internuclear coordinate (<span class="math notranslate nohighlight">\(R\)</span>), and so for simplicity we consider an electric field oriented soley along
<span class="math notranslate nohighlight">\(R\)</span> as well and treat both quantities as scalars.</p>
<p>We will consider two quantum states for the photon - no photon in the cavity, denoted by <span class="math notranslate nohighlight">\(|0\rangle\)</span>, and 1 photon in the cavity <span class="math notranslate nohighlight">\(|1\rangle\)</span>.  The photon has an energy of <span class="math notranslate nohighlight">\(\hbar \omega\)</span>. At the same time, we will allow for the molecule to be in its electronic ground state <span class="math notranslate nohighlight">\(|g\rangle\)</span> or its first electronic excited state <span class="math notranslate nohighlight">\(|e\rangle\)</span>.<br />
This leads to the following basis states for the composite system:</p>
<p><span class="math notranslate nohighlight">\(|g,0\rangle \rightarrow\)</span> The molecule is in the ground state and there is no photon in the cavity.</p>
<p><span class="math notranslate nohighlight">\(|g,1\rangle \rightarrow\)</span> The molecule is in the ground state and there is one photon in the cavity.</p>
<p><span class="math notranslate nohighlight">\(|e,0\rangle \rightarrow\)</span> The molecule is in its first electronic excited state and there is no photon in the cavity.</p>
<p>We will neglect the <span class="math notranslate nohighlight">\(|e,1\rangle\)</span> state for simplicity, and if desired, it can be shown that its inclusion does not impact the results.</p>
<p>In this 3-state basis, we will model this system with a generalized Rabi Hamiltonian that can be written as:
\begin{equation}
{\bf H} =
\begin{pmatrix}
E_g(R)  &amp; 0 &amp; 0 \
0 &amp; E_g(R) + \hbar \omega &amp;   A \cdot \mu_{ge}(R) \
0 &amp;  A \cdot \mu_{ge}(R) &amp; E_e(R)
\end{pmatrix}. \tag{4}
\end{equation}
where <span class="math notranslate nohighlight">\(E_g(R)\)</span> denotes the ground-state potential energy surface, i.e. the energy of state <span class="math notranslate nohighlight">\(|g\rangle\)</span> at bondlength <span class="math notranslate nohighlight">\(R\)</span>, <span class="math notranslate nohighlight">\(E_e(R)\)</span> denotes the potential energy surface of the first excited state (energy of state <span class="math notranslate nohighlight">\(|e\rangle\)</span> at bondlength <span class="math notranslate nohighlight">\(R\)</span>), and <span class="math notranslate nohighlight">\(\mu_{ge}(R)\)</span> denotes the transition dipole moment between state <span class="math notranslate nohighlight">\(|g\rangle\)</span> and <span class="math notranslate nohighlight">\(|e\rangle\)</span>.  Applying second quantized operators to derive this Hamiltonian matrix is supplementary learning outcome; interested students are directed to <a class="reference internal" href="#Derivation"><span class="xref myst">Derivation</span></a> cell for the derivation.</p>
<p>We can see that the molecular and photonic basis states interact with each other (i.e. the Hamiltonian in this basis is not diagonal).  We can diagonalize this matrix to yield the <em>polaritonic</em> states.  We will
use the following nomenclature for these eigenpairs that define these polaritonic states:</p>
<p><span class="math notranslate nohighlight">\(E_g|\psi_g\rangle \rightarrow\)</span> The ground-state energy and eigenstate of the interacting system, which is approximately equal to <span class="math notranslate nohighlight">\(E_g\)</span> and <span class="math notranslate nohighlight">\(|g,0\rangle\)</span> from before.  This corresponds to the lowest eigenvalue of the Rabi Hamiltonian.</p>
<p><span class="math notranslate nohighlight">\(E_{LP}|\psi_{LP}\rangle \rightarrow\)</span> The lower-polariton energy and eigenstate.  The lower-polariton eigenstate is a linear
combination of the <span class="math notranslate nohighlight">\(|g,1\rangle\)</span> and <span class="math notranslate nohighlight">\(|e,0\rangle\)</span> states.  This corresponds to the second-lowest eigenvalue of the Rabi Hamiltonian.</p>
<p><span class="math notranslate nohighlight">\(E_{UP}|\psi_{UP}\rangle \rightarrow\)</span> The upper-polariton energy and eigenstate.  The upper-polariton eigenstate is also a linear
combination of the <span class="math notranslate nohighlight">\(|g,1\rangle\)</span> and <span class="math notranslate nohighlight">\(|e,0\rangle\)</span> states.  This corresponds to the third-lowest eigenvalue of the Rabi Hamiltonian (or highest eigenvalue in the case we are using only the 3 basis states defined above).</p>
<section id="procedure">
<h3>Procedure<a class="headerlink" href="#procedure" title="Link to this heading">#</a></h3>
<p>We will build and diagonalize this matrix across a range of bondlength values (<span class="math notranslate nohighlight">\(R\)</span>), and the
resulting eigenvalues will comprise the polaritonic potential energy surfaces.  The resulting
eigenvectors will comprise the polaritonic energy eigenstates.  We will utilize the <code class="docutils literal notranslate"><span class="pre">psi4</span></code> package to compute
<span class="math notranslate nohighlight">\(E_g(R)\)</span>, <span class="math notranslate nohighlight">\(E_e(R)\)</span>, and <span class="math notranslate nohighlight">\(\mu_{ge}(R)\)</span> to be used in the model Hamiltonian above.</p>
<p>We will import psi4 to have access to the DFT engine for computation of ground-state properties, and the scf_response library of psi4 to have access to TDDFT methods for obtaining excited-state properties.  We will also import numpy and scipy libraries to help with constructing and diagonalizing the Rabi Hamiltonian.</p>
<p>To compute <span class="math notranslate nohighlight">\(E_g(R)\)</span>, <span class="math notranslate nohighlight">\(E_e(R)\)</span>, and <span class="math notranslate nohighlight">\(\mu_{ge}(R)\)</span>, we will use DFT/TDDFT at the B3LYP/cc-pVDZ level for 25 different geometries from <span class="math notranslate nohighlight">\(R = 1.1\)</span> to <span class="math notranslate nohighlight">\(R = 3.5\)</span> Angstroms.</p>
<p>The scan of different <span class="math notranslate nohighlight">\(R\)</span> values uses similar syntax as has been demonstrated in other Psi4Education labs, see for example the lab on the <a class="reference external" href="https://github.com/Psi4Education/psi4education/blob/master/labs/spectroscopic_constants/spectroscopic_constants_student.ipynb">calculation of spectroscopic constants</a>.</p>
<p>Extracting the excitation energy and the transition dipole moment requires that we run the <code class="docutils literal notranslate"><span class="pre">tdscf_excitations</span></code> method from the psi4 package, which we have explicitly imported.  This method returns a dictionary containing different information about the excited-state energies and properties.</p>
</section>
<section id="the-tdscf-excitations-method-and-dictionary">
<h3>The tdscf_excitations method and dictionary<a class="headerlink" href="#the-tdscf-excitations-method-and-dictionary" title="Link to this heading">#</a></h3>
<p>The syntax for computing singlet excited-state properties with the tdscf_excitations method is as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">res</span> <span class="pre">=</span> <span class="pre">tdscf_excitations(wfn,</span> <span class="pre">states=n,</span> <span class="pre">triplets='None')</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">wfn</span></code> is the wavefunction object that can be obtained from a prior ground-state calculation, <code class="docutils literal notranslate"><span class="pre">states=n</span></code> specifies the number <code class="docutils literal notranslate"><span class="pre">n</span></code> of excited-states you wish to compute, <code class="docutils literal notranslate"><span class="pre">triplets='None'</span></code> specifies that only singlet exited states will be obtained, and <code class="docutils literal notranslate"><span class="pre">res</span></code> is the name specified for the nested dictionary that the method returns to store the excited-state information.</p>
<p>Dictionaries are used to store data values in key:value pairs, and nested dictionaries have multiple dictionaries inside a dictionary.  This construction is useful for the excited-state calculations because there are many excited states, each having properties that can be specified by the same key.</p>
<p>We are interested in two keys for our calculation.
The key <code class="docutils literal notranslate"><span class="pre">&quot;EXCITATION</span> <span class="pre">ENERGY&quot;</span></code> can be used to access the excitation energy from the ground state to a given excited state obtained from the calculation, and the key <code class="docutils literal notranslate"><span class="pre">&quot;ELECTRIC</span> <span class="pre">DIPOLE</span> <span class="pre">TRANSITION</span> <span class="pre">MOMENT</span> <span class="pre">(LEN)&quot;</span></code> can be used to access the transition dipole moments associated with the computed states (ground-to-excited state only).  Because we are interested in these properties only for the first excited state, we will access them as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">res[0][&quot;EXCITATION</span> <span class="pre">ENERGY&quot;]</span></code>: <span class="math notranslate nohighlight">\(E_e(R) - E_g(R)\)</span></p>
<p><code class="docutils literal notranslate"><span class="pre">res[0][&quot;ELECTRIC</span> <span class="pre">DIPOLE</span> <span class="pre">TRANSITION</span> <span class="pre">MOMENT</span> <span class="pre">(LEN)&quot;]</span></code>: <span class="math notranslate nohighlight">\(\mu_{ge}(R)\)</span>.</p>
<p>Information about the second excited-state would be obtained from keys associated with <code class="docutils literal notranslate"><span class="pre">res[1]['KEY']</span></code>, etc.</p>
<p>To see all of the keys of the nested dictionary called <code class="docutils literal notranslate"><span class="pre">res</span></code>, you can type <code class="docutils literal notranslate"><span class="pre">res[0].keys()</span></code>.   For a more general discussion of nested dictionaries, see <a class="reference external" href="https://www.programiz.com/python-programming/nested-dictionary">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set basis</span>
<span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span>
    <span class="s1">&#39;basis&#39;</span><span class="p">:</span><span class="s1">&#39;cc-pVDZ&#39;</span>
<span class="p">})</span>

<span class="c1"># set the number of electronic states... this is the ground state + n_states more</span>
<span class="c1"># we will get 1 excited-state</span>
<span class="n">n_states</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># set the number of bond lengths to compute the stretch along</span>
<span class="n">n_geoms</span> <span class="o">=</span> <span class="mi">25</span>

<span class="c1"># initialize geometry list</span>
<span class="n">geoms</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># initialize energy list... note</span>
<span class="c1"># there will be the ground state energy + n_states excited state energies</span>
<span class="n">Es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_geoms</span><span class="p">))</span>

<span class="c1"># initialize z-component of transition dipole list</span>
<span class="n">mu_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_geoms</span><span class="p">))</span>

<span class="c1"># generate bond lengths</span>
<span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_geoms</span><span class="p">):</span>
    <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.1</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># loop over bond lengths</span>
<span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rs</span><span class="p">:</span>
    <span class="c1"># generate the MgH+ molecule using a z-matrix and set the Mg-H+ bond length</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Mg</span>
<span class="s2">    H 1 &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    symmetry c1</span>
<span class="s2">    1 1</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="c1"># save the geometry</span>
    <span class="n">geoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">to_array</span><span class="p">())</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_options</span><span class="p">({</span>
    <span class="s1">&#39;save_jk&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">})</span>  
   
    <span class="c1"># calculate and save the ground-state energy and wavefunction</span>
    <span class="n">e</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="s2">&quot;b3lyp/cc-pVDZ&quot;</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="n">mol</span><span class="p">)</span>
    
    <span class="c1"># calculate the excited-state energies and save them to a dictionary called &#39;res&#39;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">tdscf_excitations</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">n_states</span><span class="p">,</span> <span class="n">triplets</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span><span class="p">)</span>
    
    <span class="c1"># parse the excitation energies from the &#39;res&#39; dictionary </span>
    <span class="n">delta_e</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;EXCITATION ENERGY&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
    
    <span class="c1"># parse the transition dipole moment from the &#39;res&#39; dictionary</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;ELECTRIC DIPOLE TRANSITION MOMENT (LEN)&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
    <span class="n">Es</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
    
    <span class="c1"># store the results to the respective arrays</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_states</span><span class="p">):</span>
        <span class="n">Es</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">delta_e</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="c1"># we only want the z-component which is index 2</span>
        <span class="n">mu_z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

    
    <span class="c1"># increment the counter!</span>
    <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take slices of information for Eg, Ee, and mu_eg only</span>
<span class="n">Eg_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Es</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">Ee_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Es</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
<span class="n">tdm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mu_z</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>


<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Eg_array</span><span class="p">,</span> <span class="n">_expected_Eg_array</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Ee_array</span><span class="p">,</span> <span class="n">_expected_Ee_array</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">tdm_array</span><span class="p">,</span> <span class="n">_expected_tdm_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AssertionError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Eg_array</span><span class="p">,</span> <span class="n">_expected_Eg_array</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Ee_array</span><span class="p">,</span> <span class="n">_expected_Ee_array</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">tdm_array</span><span class="p">,</span> <span class="n">_expected_tdm_array</span><span class="p">)</span>

<span class="ne">AssertionError</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will print all of the keys associated with the `res` dictionary.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s plot the ground- and excited-state potential energy surfaces for MgH+ just computed above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span><span class="n">Eg_array</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ground state&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span><span class="n">Ee_array</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Excited state&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bondlength (Angstroms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (Hartrees)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DFT/TDDFT Potential Energy Surfaces&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="building-the-rabi-model-hamiltonian">
<h2>Building the Rabi model Hamiltonian<a class="headerlink" href="#building-the-rabi-model-hamiltonian" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Fit each surface to a spline</p></li>
<li><p>Define functions that build the Rabi Hamiltonian and extract the eigenstates from them.  For reasons of convenience with the plotting widget, we will create two almost identical functions that extract the lower-polariton and upper-polariton roots separately.</p></li>
<li><p>(Separate notebook) Define a widget that allows the display of polaritonic potential energy surfaces with variable values of the coupling strength <span class="math notranslate nohighlight">\(g\)</span>.</p></li>
</ol>
<section id="step-1-fitting-a-spline">
<h3>Step 1: Fitting a spline<a class="headerlink" href="#step-1-fitting-a-spline" title="Link to this heading">#</a></h3>
<p>We will fit a cubic spline to the data obtained for the ground- and excited-state potential energy surfaces (<span class="math notranslate nohighlight">\(E_g(R)\)</span> and <span class="math notranslate nohighlight">\(E_e(R)\)</span>) obtained from the TDDFT calculations.  A cubic spline is a simple model function of the form <span class="math notranslate nohighlight">\(f(R) = a + bR + cR^2 + dR^3\)</span> that allows estimation of the potential energy curves at arbitrary values of <span class="math notranslate nohighlight">\(R\)</span> within the finite range scanned by the <em>ab initio</em> calculations.  We will do the same for the transition dipole moment, <span class="math notranslate nohighlight">\(\mu_{ge}(R)\)</span>.</p>
<p>The syntax for generating a cubic spline is as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">spline</span> <span class="pre">=</span> <span class="pre">InterpolatedUnivariateSpline(x_values,</span> <span class="pre">y_values,</span> <span class="pre">k=3)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">x_values</span></code> is a list or numpy array containing the independent variable data, <code class="docutils literal notranslate"><span class="pre">y_values</span></code> is a list or numpy array containing the corresponding dependent variable data, <code class="docutils literal notranslate"><span class="pre">k=3</span></code> indicates a cubic spline, and <code class="docutils literal notranslate"><span class="pre">spline</span></code> is the spline object returned by the <code class="docutils literal notranslate"><span class="pre">InterpolatedUnivariateSpline</span></code> method.</p>
<p>Recall that the independent variable data are the bondlengths <span class="math notranslate nohighlight">\(R\)</span> stored in the numpy array <code class="docutils literal notranslate"><span class="pre">rs</span></code>, and the dependent variable data are the ground- and excited-state potential energy surface data stored in the <code class="docutils literal notranslate"><span class="pre">Es</span></code> array.  The transition dipole moment data is stored in the array <code class="docutils literal notranslate"><span class="pre">mu_z</span></code>.</p>
<p><em>Note on units</em> The bondlength data is stored in Angstroms, whereas the energies and transition dipole moments are all stored in atomic units.</p>
<p><strong>Question 3</strong>  Fit a spline called <code class="docutils literal notranslate"><span class="pre">Eg_spline</span></code> to the ground-state potential energy surface data, a spline called <code class="docutils literal notranslate"><span class="pre">Ee_spline</span></code> to the excited-state potential energy surface data, and a spline called <code class="docutils literal notranslate"><span class="pre">mu_spline</span></code> to the transition dipole moment data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit all surfaces to a spline</span>
<span class="c1"># ==&gt; Code to fit splines goes here! &lt;== #</span>
<span class="n">Eg_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">Eg_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Ee_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">Ee_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mu_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">tdm_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once the splines have been defined, they can be evaluated at a particular value(s) of <span class="math notranslate nohighlight">\(R\)</span> using the following syntax <code class="docutils literal notranslate"><span class="pre">spline(R)</span></code>.  Note if you pass the spline a numpy array of <span class="math notranslate nohighlight">\(R\)</span> values, it will return a numpy array of
dependent variable values evaluated at each value of the <span class="math notranslate nohighlight">\(R\)</span> array.</p>
<p>In the following blocks, add code to evaluate <code class="docutils literal notranslate"><span class="pre">Eg_spline</span></code>, <code class="docutils literal notranslate"><span class="pre">Ee_spline</span></code> and <code class="docutils literal notranslate"><span class="pre">mu_spline</span></code> at <code class="docutils literal notranslate"><span class="pre">R_val</span> <span class="pre">=</span> <span class="pre">2.5</span></code> Anstroms; store the values to variables named <code class="docutils literal notranslate"><span class="pre">Eg_val</span></code>, <code class="docutils literal notranslate"><span class="pre">Ee_val</span></code>, and <code class="docutils literal notranslate"><span class="pre">tdm_val</span></code> respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; Code to evaluate Eg_spline, Ee_spline, and mu_spline at R_val = 2.5 Angstroms goes here! &lt;== #</span>
<span class="n">R_val</span> <span class="o">=</span> <span class="mf">2.5</span>

<span class="n">Eg_val</span> <span class="o">=</span> <span class="n">Eg_spline</span><span class="p">(</span><span class="n">R_val</span><span class="p">)</span>

<span class="n">Ee_val</span> <span class="o">=</span> <span class="n">Ee_spline</span><span class="p">(</span><span class="n">R_val</span><span class="p">)</span>

<span class="n">tdm_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">mu_spline</span><span class="p">(</span><span class="n">R_val</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Question 4</strong> What is the transition energy in (expressed in atomic units and in electron volts) between the ground and first excited state at <span class="math notranslate nohighlight">\(R = 2.5\)</span> Angstroms?</p>
<p><em>Answer in atomic units goes here!</em></p>
<p><em>Answer in electron volts goes here!</em></p>
<p><em>Hint</em> The conversion factor between atomic units of energy and electron volts is <span class="math notranslate nohighlight">\(27.211 \frac{{\rm eV}}{{\rm atomic \: unit}}\)</span>.  Store the transition energy in a variable called <code class="docutils literal notranslate"><span class="pre">transition_energy_eV</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># conversion factor for au -&gt; eV</span>
<span class="n">au_to_eV</span> <span class="o">=</span> <span class="mf">27.211</span>

<span class="c1"># ==&gt; Code to compute transition energy in atomic units and convert to eV goes here! &lt;== #</span>
<span class="n">transition_energy_au</span> <span class="o">=</span> <span class="n">Ee_val</span> <span class="o">-</span> <span class="n">Eg_val</span>
<span class="n">transition_energy_eV</span> <span class="o">=</span> <span class="n">transition_energy_au</span> <span class="o">*</span> <span class="n">au_to_eV</span>
<span class="nb">print</span><span class="p">(</span><span class="n">transition_energy_au</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">transition_energy_eV</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Checking your results:</strong> The next cell will check the values you obtained from your splines.  We will use an <code class="docutils literal notranslate"><span class="pre">assert</span></code> statement to compare your computed values to the expected values. The <code class="docutils literal notranslate"><span class="pre">assert</span></code> statement will pass if the comparison returns true, and will fail if the comparison returns false.</p>
<p><strong>If one or more <code class="docutils literal notranslate"><span class="pre">assert</span></code> statements fail, you should go back and check your code in the last few blocks!</strong></p>
<p>The comparison is performed by the numpy function <code class="docutils literal notranslate"><span class="pre">isclose()</span></code>.  For more information about the <code class="docutils literal notranslate"><span class="pre">isclose()</span></code> function, see <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.isclose.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">Eg_val</span><span class="p">,</span> <span class="n">_expected_Eg_val</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">Ee_val</span><span class="p">,</span> <span class="n">_expected_Ee_val</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">tdm_val</span><span class="p">,</span> <span class="n">_expected_tdm_val</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">transition_energy_eV</span><span class="p">,</span> <span class="n">_expected_deltaE_eV</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-building-the-rabi-hamiltonian">
<h3>Step 2: Building the Rabi Hamiltonian<a class="headerlink" href="#step-2-building-the-rabi-hamiltonian" title="Link to this heading">#</a></h3>
<p>Next we will define a function that will build and return the Rabi Hamiltonian (Eq. (4)).  We will pass
5 arguments to this function:</p>
<p><code class="docutils literal notranslate"><span class="pre">A_value</span></code> : Electric field strength <span class="math notranslate nohighlight">\(A\)</span> as defined in Eq. (3)</p>
<p><code class="docutils literal notranslate"><span class="pre">omega_value</span></code> : Photon frequency <span class="math notranslate nohighlight">\(\omega\)</span> that appears in the diagonals of Eq. (4)</p>
<p><code class="docutils literal notranslate"><span class="pre">r_value</span></code> : An <span class="math notranslate nohighlight">\(R\)</span> value at which the Rabi Hamiltoninan will be evaluated</p>
<p><code class="docutils literal notranslate"><span class="pre">g_spline</span></code> : A spline fit to the ground state potential energy surface as a function of <span class="math notranslate nohighlight">\(R\)</span></p>
<p><code class="docutils literal notranslate"><span class="pre">e_spline</span></code> : A spline fit to the excited state potential energy surface as a function of <span class="math notranslate nohighlight">\(R\)</span></p>
<p><code class="docutils literal notranslate"><span class="pre">tdm_spline</span></code> : A spline fit to the transition dipole moment surface as a function of <span class="math notranslate nohighlight">\(R\)</span></p>
<p>A template for this function follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Rabi_Hamiltonian</span><span class="p">(</span><span class="n">lambda_value</span><span class="p">,</span> <span class="n">omega_value</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">g_spline</span><span class="p">,</span> <span class="n">e_spline</span><span class="p">,</span> <span class="n">tdm_spline</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to compute the Rabi Hamiltonian</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    A_value : float</span>
<span class="sd">        electric field strength</span>
<span class="sd">        </span>
<span class="sd">    omega_value : float</span>
<span class="sd">        photon energy</span>
<span class="sd">        </span>
<span class="sd">    r_value : float</span>
<span class="sd">        value of the bondlength</span>
<span class="sd">        </span>
<span class="sd">    g_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the ground-state potential energy surface</span>
<span class="sd">        </span>
<span class="sd">    e_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the excited-state potential energy surface</span>
<span class="sd">        </span>
<span class="sd">    tdm_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the transition dipole moment surface</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H : numpy array</span>
<span class="sd">        3x3 Rabi Hamiltonian matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># create 3x3 numpy array to store the Rabi Hamiltonian</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> 
    
    <span class="c1"># ==&gt; Code to compute elements of the Rabi Hamiltonian &lt;== #</span>
    
    <span class="c1"># return the Hamiltonian</span>
    <span class="k">return</span> <span class="n">H</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Rabi_Hamiltonian</span><span class="p">(</span><span class="n">A_value</span><span class="p">,</span> <span class="n">omega_value</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">g_spline</span><span class="p">,</span> <span class="n">e_spline</span><span class="p">,</span> <span class="n">tdm_spline</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to compute the Rabi Hamiltonian</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    A_value : float</span>
<span class="sd">        electric field strength</span>
<span class="sd">        </span>
<span class="sd">    omega_value : float</span>
<span class="sd">        photon energy</span>
<span class="sd">        </span>
<span class="sd">    r_value : float</span>
<span class="sd">        value of the bondlength</span>
<span class="sd">        </span>
<span class="sd">    g_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the ground-state potential energy surface</span>
<span class="sd">        </span>
<span class="sd">    e_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the excited-state potential energy surface</span>
<span class="sd">        </span>
<span class="sd">    tdm_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the transition dipole moment surface</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H : numpy array</span>
<span class="sd">        3x3 Rabi Hamiltonian matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># initialize 3x3 Hamiltonian matrix</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    
    <span class="c1"># diagonal entries</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">g_spline</span><span class="p">(</span><span class="n">r_value</span><span class="p">)</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">g_spline</span><span class="p">(</span><span class="n">r_value</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega_value</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_spline</span><span class="p">(</span><span class="n">r_value</span><span class="p">)</span>
    
    <span class="c1"># off-diagonal entries</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">A_value</span> <span class="o">*</span> <span class="n">tdm_spline</span><span class="p">(</span><span class="n">r_value</span><span class="p">)</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A_value</span> <span class="o">*</span> <span class="n">tdm_spline</span><span class="p">(</span><span class="n">r_value</span><span class="p">)</span>
    
    <span class="c1"># return the matrix</span>
    <span class="k">return</span> <span class="n">H</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Question 5</strong> Evaluate the Rabi Hamiltonian with <span class="math notranslate nohighlight">\(A = 0.003\)</span> atomic units, <span class="math notranslate nohighlight">\(R = 2.5\)</span> Angstroms,
and <span class="math notranslate nohighlight">\(\omega\)</span> defined such that it matches the transition energy at this bondlength.  Store the resulting
matrix to a variable named <code class="docutils literal notranslate"><span class="pre">H_Rabi</span></code>.</p>
<p><em>Hint:</em> Your <span class="math notranslate nohighlight">\(\omega\)</span> value should be in atomic units.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_value</span> <span class="o">=</span> <span class="mf">0.003</span>

<span class="n">H_Rabi</span> <span class="o">=</span> <span class="n">Rabi_Hamiltonian</span><span class="p">(</span><span class="n">A_value</span><span class="p">,</span> <span class="n">transition_energy_au</span><span class="p">,</span> <span class="n">R_val</span><span class="p">,</span> <span class="n">Eg_spline</span><span class="p">,</span> <span class="n">Ee_spline</span><span class="p">,</span> <span class="n">mu_spline</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Checking your results:</strong> The next cell will check the Hamiltonian computed in the last block.</p>
<p><strong>If this <code class="docutils literal notranslate"><span class="pre">assert</span></code> statements fail, you should go back and check the code in your Rabi_Hamiltonian function and the values of the arguments you passed to this function!</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">H_Rabi</span><span class="p">,</span> <span class="n">_expected_H_Rabi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 3: Compute and plot polariton potential energy surfaces</strong></p>
<p>We will compute and plot the polaritonic potential energy surfaces for <span class="math notranslate nohighlight">\(A = 0.003\)</span> atomic units.  This will help us to vizualize the so-called Rabi splitting that occurs between
the surfaces at a particular value of the bondlength <span class="math notranslate nohighlight">\(R_{deg}\)</span>, where we define <span class="math notranslate nohighlight">\(R_{deg}\)</span> as the bondlength
at which the following is satisfied for a particular value of the photon energy <span class="math notranslate nohighlight">\(\omega_0\)</span>:</p>
<p>$<span class="math notranslate nohighlight">\( E_g(R_{deg}) + \hbar \omega_0 = E_e(R_{deg}) \tag{5}\)</span>$.</p>
<p>If we set <span class="math notranslate nohighlight">\(\omega_0\)</span> to be equal to the transition energy at <span class="math notranslate nohighlight">\(R = 2.5\)</span> Angstroms as before, then we have
<span class="math notranslate nohighlight">\(R_{deg} = 2.5\)</span> Angstroms by definition. As we worked out in an earlier cell, this value of <span class="math notranslate nohighlight">\(\omega_0\)</span> would
correspond to approximately <span class="math notranslate nohighlight">\(0.1487\)</span> atomic units or <span class="math notranslate nohighlight">\(4.048\)</span> eV.  We will use this value for <span class="math notranslate nohighlight">\(\omega\)</span> for the rest of this notebook.</p>
<p>We already have a function that will build the Rabi Hamiltonian as a function of the fundamental coupling strength, the photon energy, and the bondlength value.  The next step is to build a function that will build and diagonalize
this matrix for a range of bondlengths to return the so-called lower- and upper-poloriton potential energy surfaces (<span class="math notranslate nohighlight">\(E_{LP}(R)\)</span> and <span class="math notranslate nohighlight">\(E_{UP}(R)\)</span>).  We will use the <code class="docutils literal notranslate"><span class="pre">eigh</span></code> function of numpy’s linear algebra package (given the alias <code class="docutils literal notranslate"><span class="pre">LA</span></code> in our import statement at the top of the notebook) to diagonalize the Hamiltonian and store the eigenvalues.  The syntax follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">vals,</span> <span class="pre">vecs</span> <span class="pre">=</span> <span class="pre">LA.eigh(matrix)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">vals</span></code> are the eigenvalues, <code class="docutils literal notranslate"><span class="pre">vecs</span></code> are the eigenvectors, and <code class="docutils literal notranslate"><span class="pre">matrix</span></code> is the Hermitian matrix.</p>
<p>The following function <code class="docutils literal notranslate"><span class="pre">polariton_surfaces</span></code> will compute and return <span class="math notranslate nohighlight">\(E_{LP}(R)\)</span> and <span class="math notranslate nohighlight">\(E_{UP}(R)\)</span> in this way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">polariton_surfaces</span><span class="p">(</span><span class="n">A_value</span><span class="p">,</span> <span class="n">omega_value</span><span class="p">,</span> <span class="n">r_values</span><span class="p">,</span> <span class="n">g_spline</span><span class="p">,</span> <span class="n">e_spline</span><span class="p">,</span> <span class="n">tdm_spline</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to compute the lower- and upper-polariton potential energy surfaces</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    A_value : float</span>
<span class="sd">        electric field strength</span>
<span class="sd">        </span>
<span class="sd">    omega_value : float</span>
<span class="sd">        photon energy</span>
<span class="sd">        </span>
<span class="sd">    r_value : float</span>
<span class="sd">        value of the bondlength</span>
<span class="sd">        </span>
<span class="sd">    g_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the ground-state potential energy surface</span>
<span class="sd">        </span>
<span class="sd">    e_splien : scipy spline object</span>
<span class="sd">        spline that is fit to the excited-state potential energy surface</span>
<span class="sd">        </span>
<span class="sd">    tdm_spline : scipy spline object</span>
<span class="sd">        spline that is fit to the transition dipole moment surface</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    E_LP_of_R : numpy array</span>
<span class="sd">        lower-polariton potential energy surface defined at each value of r_values</span>
<span class="sd">        </span>
<span class="sd">    E_UP_of_R : numpy array</span>
<span class="sd">        upper-polariton potential energy surface defined at each value of r_values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># initialize lp and up surfaces</span>
    <span class="n">lp_surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r_values</span><span class="p">)</span>
    <span class="n">up_surface</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r_values</span><span class="p">)</span>
    
    <span class="c1"># loop through r values, build Rabi Hamiltonian, diagonalize, and store!</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_values</span><span class="p">)):</span>
        
        <span class="c1"># if there is no coupling, then we don&#39;t need to diagonalize anything</span>
        <span class="k">if</span> <span class="n">A_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lp_surface</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g_spline</span><span class="p">(</span><span class="n">r_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">omega_value</span>
            <span class="n">up_surface</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_spline</span><span class="p">(</span><span class="n">r_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="c1"># otherwise build Hamiltonian and diagonalize</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Build the Rabi Hamiltonian</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">Rabi_Hamiltonian</span><span class="p">(</span><span class="n">A_value</span><span class="p">,</span> <span class="n">omega_value</span><span class="p">,</span> <span class="n">r_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">g_spline</span><span class="p">,</span> <span class="n">e_spline</span><span class="p">,</span> <span class="n">tdm_spline</span><span class="p">)</span>
            
            <span class="c1"># diagonalize</span>
            <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
            
            <span class="c1"># store lp and up values</span>
            <span class="n">lp_surface</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">up_surface</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># return the surfaces</span>
    <span class="k">return</span> <span class="n">lp_surface</span><span class="p">,</span> <span class="n">up_surface</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run this cell to compute the polariton PES</span>
<span class="n">lp_surface</span><span class="p">,</span> <span class="n">up_surface</span> <span class="o">=</span> <span class="n">polariton_surfaces</span><span class="p">(</span><span class="n">A_value</span><span class="p">,</span> <span class="n">transition_energy_au</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">Eg_spline</span><span class="p">,</span> <span class="n">Ee_spline</span><span class="p">,</span> <span class="n">mu_spline</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">Eg_spline</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span><span class="o">+</span><span class="n">transition_energy_au</span><span class="p">,</span> <span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eg + $\hbar \omega$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">Ee_spline</span><span class="p">(</span><span class="n">rs</span><span class="p">),</span> <span class="s2">&quot;b--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ee&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">lp_surface</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;lower polariton&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">up_surface</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;upper polariton&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a id=’Derivation’></a></p>
</section>
</section>
<section id="derivation">
<h2>Derivation<a class="headerlink" href="#derivation" title="Link to this heading">#</a></h2>
<p>We will consider two quantum states for the photon - no photon in the cavity, denoted by <span class="math notranslate nohighlight">\(|0\rangle\)</span> with associated energy eigenvalue <span class="math notranslate nohighlight">\(0\)</span>
and one photon in the cavity, denoted by <span class="math notranslate nohighlight">\(|1\rangle\)</span> with associated energy eigenvalue <span class="math notranslate nohighlight">\(\hbar \omega\)</span>.  Note that essentially shifts the photon Hamiltonian by the zero-point energy <span class="math notranslate nohighlight">\(\hbar \frac{\omega}{2}\)</span>.
We will model this system with a generalized Rabi Hamiltonian that can be written as:</p>
<div class="math notranslate nohighlight">
\[ \hat{H} = E_g(R) |g\rangle \langle g| + E_e(R) |g\rangle \langle g| + 
\hbar \omega \hat{b} \hat{b}^{\dagger}  + \hbar {\bf A} \cdot \mu_{ge}(R) \left(\hat{b} + \hat{b}^{\dagger} \right) \left(|g\rangle \langle e| +  |e\rangle \langle g|\right). \]</div>
<p>The polaritonic potential energy surfaces may be obtained by building a Hamiltonian matrix in the following basis and diagonalizing as a function of the bond length <span class="math notranslate nohighlight">\(R\)</span>: <span class="math notranslate nohighlight">\( |\phi\rangle \in \{|g,0\rangle , |g,1\rangle , |e,0\rangle, |e,1\rangle \}. \)</span></p>
<section id="review-of-dirac-bra-ket-notation">
<h3>Review of Dirac Bra-Ket notation<a class="headerlink" href="#review-of-dirac-bra-ket-notation" title="Link to this heading">#</a></h3>
<p>We have used Dirac’s bra-ket notation for both the electronic and the photonic states.  In this notation,
<span class="math notranslate nohighlight">\(|n\rangle = \psi_n\)</span> is known as the <em>ket</em> for state <span class="math notranslate nohighlight">\(n\)</span>,
and <span class="math notranslate nohighlight">\(\langle m| = \psi_m^*\)</span> is known as the <em>bra</em> for state <span class="math notranslate nohighlight">\(m\)</span>.  This applies
to both electronic and photonic states, where we are specifically
using the notation <span class="math notranslate nohighlight">\(|g\rangle\)</span> to denote the ground electronic ket, <span class="math notranslate nohighlight">\(|e\rangle\)</span> to denote
the first-excited electronic ket, <span class="math notranslate nohighlight">\(|0\rangle\)</span> to denote the 0-photon ket, and <span class="math notranslate nohighlight">\(|1\rangle\)</span> to
denote the 1-photon ket.</p>
<p>An important rule in this notation is the
following:</p>
<div class="math notranslate nohighlight">
\[ \langle n | m \rangle = \int \psi^*_n \psi_m d\tau = \delta_{nm} \]</div>
<p>where the Kronicker delta function <span class="math notranslate nohighlight">\(\delta_{nm}\)</span> is equal to 1 if <span class="math notranslate nohighlight">\(n = m\)</span> and 0 otherwise.
We can use this rule to compute different terms in the Hamiltonian matrix.</p>
</section>
<section id="review-of-rules-for-the-projection-operators-for-electronic-states">
<h3>Review of rules for the projection operators for electronic states<a class="headerlink" href="#review-of-rules-for-the-projection-operators-for-electronic-states" title="Link to this heading">#</a></h3>
<p>The projection operators for molecular electronic states are denoted
<span class="math notranslate nohighlight">\(|n\rangle \langle m|\)</span> where again <span class="math notranslate nohighlight">\(|n\rangle = \psi_n\)</span> is known as the <em>ket</em> for electronic state <span class="math notranslate nohighlight">\(n\)</span>,
and <span class="math notranslate nohighlight">\(\langle m |= \psi_m^*\)</span> is known as the <em>bra</em> for electronic state <span class="math notranslate nohighlight">\(m\)</span>.
In this notebook, we will restrict the electronic states to the ground state (denoted <span class="math notranslate nohighlight">\(|g\rangle\)</span>)
and the first excited state (denoted <span class="math notranslate nohighlight">\(|e\rangle\)</span>).<br />
Let us examine the contribution that arises from the <span class="math notranslate nohighlight">\(E_g(R) |g\rangle \langle g|\)</span>
term in the Hamiltonian between the basis state <span class="math notranslate nohighlight">\(|g,0\rangle = |g\rangle |0\rangle\)</span>
on the bra and the ket:</p>
<p>\begin{align}
&amp; \langle g|\langle0| \left( E_g(R) |g\rangle \langle g|\right)| g\rangle  |0\rangle \
= &amp; \langle 0|0\rangle \langle g | \left( E_g(R) |g\rangle \langle g|\right)| g\rangle \
=&amp; 1 \cdot \langle g | E_g(R) |g\rangle \cdot 1 \
&amp;= E_g(R)  \langle g | g \rangle \
&amp;= E_g(R)
\end{align}
where we have used the fact that the projection operator <span class="math notranslate nohighlight">\(|g\rangle \langle g|\)</span>
only acts on the electronic states, so we were able to factor out our photonic bra
and kets <span class="math notranslate nohighlight">\(\langle 0 | 0 \rangle = 1\)</span>, and then we were also able
to bring the ground-state energy eigenvalue <span class="math notranslate nohighlight">\(E_g(R)\)</span> outside the integral in the second-to-last step just leaving <span class="math notranslate nohighlight">\(E_g(R) \langle g | g \rangle = E_g(R)\)</span>.</p>
<section id="question-1-combine-these-rules-to-evaluate-the-following">
<h4>Question 1: Combine these rules to evaluate the following:<a class="headerlink" href="#question-1-combine-these-rules-to-evaluate-the-following" title="Link to this heading">#</a></h4>
<p>\begin{align}
\langle g| \left(E_g(R) |g\rangle \langle g|\right)|e\rangle \
\langle e| \left(E_g(R) |g\rangle \langle g|\right)|e\rangle\
\langle g| \left(E_e(R) |e\rangle \langle e|\right)|e\rangle \
\langle e| \left(E_e(R) |e\rangle \langle e|\right)|e\rangle \
\langle e| \left({\bf A} \cdot \mu_{eg} |e\rangle \langle g|\right)|e\rangle \
\langle e| \left({\bf A} \cdot \mu_{eg} |e\rangle \langle g|\right)|g\rangle
\end{align}</p>
<p>The photonic raising operators generally obey <span class="math notranslate nohighlight">\(\hat{b}^{\dagger}|n\rangle = \sqrt{n+1}|n+1\rangle\)</span>,
where <span class="math notranslate nohighlight">\(n\)</span> denotes the number of photons that occupy the cavity.<br />
For the basis states in question, we have the following:
\begin{align}
\hat{b}^{\dagger}|0\rangle = |1\rangle \
\hat{b}^{\dagger}|1\rangle = \sqrt{2}|2\rangle
\end{align}
where <span class="math notranslate nohighlight">\(|\rangle\)</span> denotes a fermionic Fock vacuum state.</p>
<p>The photonic lowering operators generally obey <span class="math notranslate nohighlight">\(\hat{b}|n\rangle = \sqrt{n}|n-1\rangle\)</span>, so for the
basis states in question, we have:
\begin{align}
\hat{b}|1\rangle = |0\rangle \
\hat{b}|0\rangle = 0.
\end{align}</p>
</section>
<section id="question-2-combine-the-molecular-and-photonic-creation-and-annihilation-operator-rules-to-derive-elements-of-the-hamiltonian-matrix">
<h4>Question 2: Combine the molecular and photonic creation and annihilation operator rules to derive elements of the Hamiltonian matrix<a class="headerlink" href="#question-2-combine-the-molecular-and-photonic-creation-and-annihilation-operator-rules-to-derive-elements-of-the-hamiltonian-matrix" title="Link to this heading">#</a></h4>
<p>This matrix as a function of the bond-length <span class="math notranslate nohighlight">\(R\)</span> is as follows:
\begin{equation}
{\bf H}(R)
\mbox{=}
\begin{array}{c|cccc}
&amp; |g,0\rangle &amp; |g,1\rangle &amp; |e,0\rangle \
\hline
\langle g,0| &amp; E_g(R)   &amp;     0   &amp; 0  \
\langle g,1| &amp; 0        &amp;   E_g(R) +  \hbar \omega  &amp; \hbar {\bf A} \cdot \mu_{eg} (R) \
\langle e,0| &amp; 0        &amp;    \hbar {\bf A} \cdot \mu_{eg}  &amp; E_e(R)+\hbar \omega\
\end{array}
\end{equation}</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/drafts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supplementary-learning-objective">Supplementary learning objective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-molecular-polariton">What is a molecular polariton?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-system">Model system</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#procedure">Procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tdscf-excitations-method-and-dictionary">The tdscf_excitations method and dictionary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-the-rabi-model-hamiltonian">Building the Rabi model Hamiltonian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-fitting-a-spline">Step 1: Fitting a spline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-building-the-rabi-hamiltonian">Step 2: Building the Rabi Hamiltonian</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation">Derivation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-dirac-bra-ket-notation">Review of Dirac Bra-Ket notation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-rules-for-the-projection-operators-for-electronic-states">Review of rules for the projection operators for electronic states</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-combine-these-rules-to-evaluate-the-following">Question 1: Combine these rules to evaluate the following:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-combine-the-molecular-and-photonic-creation-and-annihilation-operator-rules-to-derive-elements-of-the-hamiltonian-matrix">Question 2: Combine the molecular and photonic creation and annihilation operator rules to derive elements of the Hamiltonian matrix</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jay Foley
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>